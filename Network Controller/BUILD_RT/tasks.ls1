AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE     1


MACRO ASSEMBLER AX51 V3.07c
OBJECT MODULE PLACED IN .\tasks.OBJ
ASSEMBLER INVOKED BY: d:\Keil_4_9.06\C51\BIN\AX51.EXE .\tasks.src PR(.\tasks.ls1) EP DEBUG MOD_CONT

LOC    OBJ             LINE     SOURCE

                          1     ; .\tasks.SRC generated from: ..\src\FreeRtossource\tasks.c
                          2     ; COMPILER INVOKED BY:
                          3     ;        d:\Keil_4_9.06\C51\BIN\C51.EXE ..\src\FreeRtossource\tasks.c LARGE OMF2 ROM(D16
                               M) BROWSE INTVECTOR(0X6020) INCDIR(..\SRC\cpu\;..\SRC\ethernet\;..\SRC\swdma\;..\SRC\msti
                               mer\;..\SRC\uart\;..\SRC\main\;..\SRC\tcpip\;..\SRC\hsur\;..\SRC\debug\;..\SRC\dhcp\;..\S
                               RC\dns\;..\SRC\adapter\;..\SRC\pppoe\;..\SRC\management;..\SRC\i2c\;..\SRC\flash\;..\SRC\
                               buffer\;..\SRC\onewire\;..\SRC\http\;..\SRC\web\;..\SRC\AX110xx_SNTP_v100;..\Src\FreeRTOS
                               Source\portable\Keil\AX11000\;..\Src\FreeRTOSSource\include\;..\Src\schedule\) DEFINE(KEI
                               L_AX11000) VARBANKING DEBUG PRINT(.\tasks.lst) SRC(.\tasks.SRC)
                          4     
                          5     $mod_cont 
                          6     $nomod51 
                          7     
                          8     NAME    TASKS
                          9     
 0098.3                  10     TB08    BIT     098H.3
 00C0.3                  11     TB18    BIT     0C0H.3
 0080                    12     P0      DATA    080H
 0098.7                  13     SM00    BIT     098H.7
 0090                    14     P1      DATA    090H
 00C0.7                  15     SM10    BIT     0C0H.7
 0098.6                  16     SM01    BIT     098H.6
 00A0                    17     P2      DATA    0A0H
 00C0.6                  18     SM11    BIT     0C0H.6
 0098.5                  19     SM02    BIT     098H.5
 00B0                    20     P3      DATA    0B0H
 00D0.6                  21     AC      BIT     0D0H.6
 00C0.5                  22     SM12    BIT     0C0H.5
 00B0.4                  23     T0      BIT     0B0H.4
 00CF                    24     SPIDR   DATA    0CFH
 00B0.5                  25     T1      BIT     0B0H.5
 00A8.7                  26     EA      BIT     0A8H.7
 00D6                    27     OWCIR   DATA    0D6H
 00C5                    28     CH      DATA    0C5H
 0083                    29     DPH0    DATA    083H
 00A8                    30     IE      DATA    0A8H
 0085                    31     DPH1    DATA    085H
 00C4                    32     CL      DATA    0C4H
 0080.0                  33     P0_0    BIT     080H.0
 0090.0                  34     P1_0    BIT     090H.0
 0080.1                  35     P0_1    BIT     080H.1
 00B9                    36     CCAPH0  DATA    0B9H
 0082                    37     DPL0    DATA    082H
 00A0.0                  38     P2_0    BIT     0A0H.0
 0090.1                  39     P1_1    BIT     090H.1
 0080.2                  40     P0_2    BIT     080H.2
 00BA                    41     CCAPH1  DATA    0BAH
 0084                    42     DPL1    DATA    084H
 00B0.0                  43     P3_0    BIT     0B0H.0
 00A0.1                  44     P2_1    BIT     0A0H.1
 0090.2                  45     P1_2    BIT     090H.2
 0080.3                  46     P0_3    BIT     080H.3
 00E2                    47     UR2_DLH DATA    0E2H
 00BB                    48     CCAPH2  DATA    0BBH
 00A7                    49     XMRHR   DATA    0A7H
 00B0.1                  50     P3_1    BIT     0B0H.1
 00A0.2                  51     P2_2    BIT     0A0H.2
 0090.3                  52     P1_3    BIT     090H.3
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE     2

 0080.4                  53     P0_4    BIT     080H.4
 00BC                    54     CCAPH3  DATA    0BCH
 00B0.2                  55     P3_2    BIT     0B0H.2
 00A0.3                  56     P2_3    BIT     0A0H.3
 0090.4                  57     P1_4    BIT     090H.4
 0080.5                  58     P0_5    BIT     080H.5
 00EB                    59     TA      DATA    0EBH
 00BD                    60     CCAPH4  DATA    0BDH
 00B1                    61     CCAPL0  DATA    0B1H
 00C8.6                  62     EXF2    BIT     0C8H.6
 00B0.7                  63     RD      BIT     0B0H.7
 00B0.3                  64     P3_3    BIT     0B0H.3
 00A0.4                  65     P2_4    BIT     0A0H.4
 0098.4                  66     REN0    BIT     098H.4
 0090.5                  67     P1_5    BIT     090H.5
 0080.6                  68     P0_6    BIT     080H.6
 00E3                    69     UR2_FCR DATA    0E3H
 00D1                    70     CCAPM0  DATA    0D1H
 00C9                    71     T2IF    DATA    0C9H
 00B2                    72     CCAPL1  DATA    0B2H
 00C0.4                  73     REN1    BIT     0C0H.4
 00B0.4                  74     P3_4    BIT     0B0H.4
 00A0.5                  75     P2_5    BIT     0A0H.5
 0090.6                  76     P1_6    BIT     090H.6
 0080.7                  77     P0_7    BIT     080H.7
 00E1                    78     UR2_DLL DATA    0E1H
 00D2                    79     CCAPM1  DATA    0D2H
 00B3                    80     CCAPL2  DATA    0B3H
 00A6                    81     XMRLR   DATA    0A6H
 00B0.5                  82     P3_5    BIT     0B0H.5
 00A0.6                  83     P2_6    BIT     0A0H.6
 0090.7                  84     P1_7    BIT     090H.7
 00D3                    85     CCAPM2  DATA    0D3H
 00B4                    86     CCAPL3  DATA    0B4H
 00A5                    87     XMWHR   DATA    0A5H
 00B0.6                  88     P3_6    BIT     0B0H.6
 00A0.7                  89     P2_7    BIT     0A0H.7
 00D4                    90     CCAPM3  DATA    0D4H
 00B8                    91     IP      DATA    0B8H
 00B5                    92     CCAPL4  DATA    0B5H
 00B0.7                  93     P3_7    BIT     0B0H.7
 00D5                    94     CCAPM4  DATA    0D5H
 009A                    95     DBAR    DATA    09AH
 00E2                    96     UR2_IER DATA    0E2H
 00D0.7                  97     CY      BIT     0D0H.7
 00B0.2                  98     INT0    BIT     0B0H.2
 00E4                    99     UR2_LCR DATA    0E4H
 00A4                   100     XMWLR   DATA    0A4H
 00B0.3                 101     INT1    BIT     0B0H.3
 00E5                   102     UR2_MCR DATA    0E5H
 0093                   103     DPX0    DATA    093H
 0096                   104     I2CCIR  DATA    096H
 0095                   105     DPX1    DATA    095H
 00E3                   106     UR2_IIR DATA    0E3H
 00E1                   107     UR2_RBR DATA    0E1H
 009D                   108     ACON    DATA    09DH
 009B                   109     DCIR    DATA    09BH
 0081                   110     SP      DATA    081H
 00C3                   111     CCON    DATA    0C3H
 00C2                   112     CMOD    DATA    0C2H
 00D0.2                 113     OV      BIT     0D0H.2
 00B0.6                 114     WR      BIT     0B0H.6
 00E1                   115     UR2_THR DATA    0E1H
 00E8.5                 116     EWDI    BIT     0E8H.5
 00D8.3                 117     WDIF    BIT     0D8H.3
 00CB                   118     RLDH    DATA    0CBH
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE     3

 00BE                   119     EPCR    DATA    0BEH
 00AA                   120     LDHR    DATA    0AAH
 00E6                   121     UR2_LSR DATA    0E6H
 00BF                   122     EPDR    DATA    0BFH
 00B6                   123     MCIR    DATA    0B6H
 00C8.5                 124     RCLK    BIT     0C8H.5
 00E7                   125     UR2_MSR DATA    0E7H
 00C8.4                 126     TCLK    BIT     0C8H.4
 00CA                   127     RLDL    DATA    0CAH
 00A9                   128     LDLR    DATA    0A9H
 0087                   129     PCON    DATA    087H
 00DE                   130     CANCIR  DATA    0DEH
 00AE                   131     TCIR    DATA    0AEH
 00F8.5                 132     PWDI    BIT     0F8H.5
 00A2                   133     LSCR    DATA    0A2H
 0089                   134     TMOD    DATA    089H
 0088                   135     TCON    DATA    088H
 00D7                   136     OWDR    DATA    0D7H
 0088.1                 137     IE0     BIT     088H.1
 0088.3                 138     IE1     BIT     088H.3
 00EA                   139     MXAX    DATA    0EAH
 00A1                   140     LMSR    DATA    0A1H
 00F9                   141     MD0     DATA    0F9H
 00F0                   142     B       DATA    0F0H
 00FA                   143     MD1     DATA    0FAH
 00A1                   144     LSAIER  DATA    0A1H
 00FB                   145     MD2     DATA    0FBH
 00D8.2                 146     WTRF    BIT     0D8H.2
 00FC                   147     MD3     DATA    0FCH
 009E                   148     PISSR1  DATA    09EH
 00FD                   149     MD4     DATA    0FDH
 00A3                   150     LSSR    DATA    0A3H
 009F                   151     PISSR2  DATA    09FH
 00FE                   152     MD5     DATA    0FEH
 00E0                   153     ACC     DATA    0E0H
 00A8.4                 154     ES0     BIT     0A8H.4
 00C8.1                 155     CT2     BIT     0C8H.1
 00A8.6                 156     ES1     BIT     0A8H.6
 00A8.1                 157     ET0     BIT     0A8H.1
 00A8.3                 158     ET1     BIT     0A8H.3
 0088.5                 159     TF0     BIT     088H.5
 00A8.5                 160     ET2     BIT     0A8H.5
 0098.0                 161     RI0     BIT     098H.0
 0088.7                 162     TF1     BIT     088H.7
 00C8.7                 163     TF2     BIT     0C8H.7
 00C0.0                 164     RI1     BIT     0C0H.0
 00CE                   165     SPICIR  DATA    0CEH
 008C                   166     TH0     DATA    08CH
 00A8.0                 167     EX0     BIT     0A8H.0
 0098.1                 168     TI0     BIT     098H.1
 0088.0                 169     IT0     BIT     088H.0
 008D                   170     TH1     DATA    08DH
 00C0.1                 171     TI1     BIT     0C0H.1
 00A8.2                 172     EX1     BIT     0A8H.2
 0088.2                 173     IT1     BIT     088H.2
 00CD                   174     TH2     DATA    0CDH
 00D0.0                 175     P       BIT     0D0H.0
 008A                   176     TL0     DATA    08AH
 008F                   177     CSREPR  DATA    08FH
 008B                   178     TL1     DATA    08BH
 00CC                   179     TL2     DATA    0CCH
 00B8.4                 180     PS0     BIT     0B8H.4
 00E8                   181     EIE     DATA    0E8H
 0092                   182     WTST    DATA    092H
 00B8.6                 183     PS1     BIT     0B8H.6
 00B8.1                 184     PT0     BIT     0B8H.1
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE     4

 0091                   185     EIF     DATA    091H
 00D0.3                 186     RS0     BIT     0D0H.3
 00B8.3                 187     PT1     BIT     0B8H.3
 0097                   188     I2CDR   DATA    097H
 00D0.4                 189     RS1     BIT     0D0H.4
 00B8.5                 190     PT2     BIT     0B8H.5
 0088.4                 191     TR0     BIT     088H.4
 0088.6                 192     TR1     BIT     088H.6
 00C8.2                 193     TR2     BIT     0C8H.2
 00B8.0                 194     PX0     BIT     0B8H.0
 00B8.2                 195     PX1     BIT     0B8H.2
 009C                   196     DDR     DATA    09CH
 0083                   197     DPH     DATA    083H
 00F8                   198     EIP     DATA    0F8H
 0082                   199     DPL     DATA    082H
 00A2                   200     LCR     DATA    0A2H
 0099                   201     SBUF0   DATA    099H
 00C1                   202     SBUF1   DATA    0C1H
 00E8.0                 203     EINT2   BIT     0E8H.0
 00C8.3                 204     EXEN2   BIT     0C8H.3
 00B7                   205     MDR     DATA    0B7H
 00E8.1                 206     EINT3   BIT     0E8H.1
 00C8.0                 207     CPRL2   BIT     0C8H.0
 0098                   208     SCON0   DATA    098H
 00E8.2                 209     EINT4   BIT     0E8H.2
 00C0                   210     SCON1   DATA    0C0H
 0094                   211     SDSTSR  DATA    094H
 00E8.3                 212     EINT5   BIT     0E8H.3
 00E9                   213     STATUS  DATA    0E9H
 00E8.4                 214     EINT6   BIT     0E8H.4
 00C8                   215     T2CON   DATA    0C8H
 0086                   216     DPS     DATA    086H
 00DF                   217     CANDR   DATA    0DFH
 00AF                   218     TDR     DATA    0AFH
 00A5                   219     LDAHR   DATA    0A5H
 0093                   220     DPX     DATA    093H
 00AD                   221     DMAHR   DATA    0ADH
 00F8.0                 222     PINT2   BIT     0F8H.0
 00B0.0                 223     RXD     BIT     0B0H.0
 00F8.1                 224     PINT3   BIT     0F8H.1
 008E                   225     CKCON   DATA    08EH
 00F8.2                 226     PINT4   BIT     0F8H.2
 00D8.1                 227     EWT     BIT     0D8H.1
 00B0.1                 228     TXD     BIT     0B0H.1
 00A4                   229     LDALR   DATA    0A4H
 00F8.3                 230     PINT5   BIT     0F8H.3
 00AB                   231     DMALR   DATA    0ABH
 00A3                   232     LSR     DATA    0A3H
 00F8.4                 233     PINT6   BIT     0F8H.4
 00AC                   234     DMAMR   DATA    0ACH
 00FF                   235     ARCON   DATA    0FFH
 00D0.5                 236     F0      BIT     0D0H.5
 00D0.1                 237     F1      BIT     0D0H.1
 00A6                   238     LDCSR   DATA    0A6H
 00D0                   239     PSW     DATA    0D0H
 0098.2                 240     RB08    BIT     098H.2
 00D8                   241     WDCON   DATA    0D8H
 00D8.0                 242     RWT     BIT     0D8H.0
 00C0.2                 243     RB18    BIT     0C0H.2
------                  244     ?PR?_?sTaskCreate?TASKS                  SEGMENT ECODE INSEG 
------                  245     ?XD?TASKS            SEGMENT XDATA 
------                  246     ?PR?_?vTaskDelayUntil?TASKS              SEGMENT ECODE INSEG 
------                  247     ?PR?_?vTaskDelay?TASKS                   SEGMENT ECODE INSEG 
------                  248     ?PR?_?vTaskSuspend?TASKS                 SEGMENT ECODE INSEG 
------                  249     ?PR?_?vTaskResume?TASKS                  SEGMENT ECODE INSEG 
------                  250     ?PR?_?vTaskStartScheduler?TASKS          SEGMENT ECODE INSEG 
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE     5

------                  251     ?PR?_?vTaskEndScheduler?TASKS            SEGMENT ECODE INSEG 
------                  252     ?PR?_?vTaskSuspendAll?TASKS              SEGMENT ECODE INSEG 
------                  253     ?PR?_?cTaskResumeAll?TASKS               SEGMENT ECODE INSEG 
------                  254     ?PR?_?xTaskGetTickCount?TASKS            SEGMENT ECODE INSEG 
------                  255     ?PR?_?usTaskGetNumberOfTasks?TASKS       SEGMENT ECODE INSEG 
------                  256     ?PR?_?vTaskIncrementTick?TASKS           SEGMENT ECODE INSEG 
------                  257     ?PR?_?vTaskSwitchContext?TASKS           SEGMENT ECODE INSEG 
------                  258     ?PR?_?vTaskPlaceOnEventList?TASKS        SEGMENT ECODE INSEG 
------                  259     ?PR?_?cTaskRemoveFromEventList?TASKS     SEGMENT ECODE INSEG 
------                  260     ?PR?_?prvIdleTask?TASKS                  SEGMENT ECODE INSEG 
------                  261     ?PR?_?prvInitialiseTCBVariables?TASKS    SEGMENT ECODE INSEG 
------                  262     ?PR?_?prvInitialiseTaskLists?TASKS       SEGMENT ECODE INSEG 
------                  263     ?PR?_?prvCheckTasksWaitingTermination?TASKS SEGMENT ECODE INSEG 
------                  264     ?PR?_?prvAllocateTCBAndStack?TASKS       SEGMENT ECODE INSEG 
------                  265     ?PR?_?prvGetCurrentTCB_XBP?TASKS         SEGMENT ECODE INSEG 
------                  266     ?PR?_?prvSetCurrentTCB_XBP?TASKS         SEGMENT ECODE INSEG 
------                  267     ?CO?TASKS            SEGMENT CODE 
------                  268     ?C_INITSEG           SEGMENT CODE 
                        269             EXTRN   CODE (_?vListRemove)
                        270             EXTRN   DATA (C_XBP)
                        271             EXTRN   CODE (_?vListInsert)
                        272             EXTRN   CODE (_strncpy)
                        273             EXTRN   XDATA (?_strncpy?BYTE)
                        274             EXTRN   CODE (_?vPortYield)
                        275             EXTRN   CODE (_strlen)
                        276             EXTRN   CODE (_?pxPortInitialiseStack)
                        277             EXTRN   CODE (_?vPortFree)
                        278             EXTRN   CODE (_?vListInsertEnd)
                        279             EXTRN   CODE (_?vListInitialise)
                        280             EXTRN   CODE (_?vListInitialiseItem)
                        281             EXTRN   CODE (_?sPortStartScheduler)
                        282             EXTRN   CODE (_?vPortEndScheduler)
                        283             EXTRN   IDATA (STACK_START)
                        284             EXTRN   CODE (_?pvPortMalloc)
                        285             EXTRN   CODE (?C?ADDXBP)
                        286             EXTRN   CODE (?C?XBPOFF)
                        287             EXTRN   DATA (?C_XBP)
                        288             EXTRN   NUMBER (?C?XDATASEG)
                        289             EXTRN   CODE (?C?ILDPTR)
                        290             EXTRN   CODE (?C?LSTXDATA)
                        291             EXTRN   CODE (?C?PLDPTR)
                        292             EXTRN   CODE (?C?PSTPTR)
                        293             EXTRN   CODE (?C?CLDPTR)
                        294             EXTRN   CODE (?C?CSTPTR)
                        295             EXTRN   CODE (?C?LSTPTR)
                        296             EXTRN   CODE (?C?LLDPTR)
                        297             EXTRN   CODE (?C?ULCMP)
                        298             EXTRN   CODE (?C?ISTPTR)
                        299             EXTRN   CODE (?C?STRCPY)
                        300             EXTRN   CODE (?C?MEMSET)
                        301             EXTRN   NUMBER (?C?XDATAMTYPE)
                        302             PUBLIC  pxCurrentTCB
                        303             PUBLIC  xTickCount
                        304             PUBLIC  pxReadyTasksLists
                        305             PUBLIC  _?prvSetCurrentTCB_XBP
                        306             PUBLIC  _?prvGetCurrentTCB_XBP
                        307             PUBLIC  _?cTaskRemoveFromEventList
                        308             PUBLIC  _?vTaskPlaceOnEventList
                        309             PUBLIC  _?vTaskSwitchContext
                        310             PUBLIC  _?vTaskIncrementTick
                        311             PUBLIC  _?usTaskGetNumberOfTasks
                        312             PUBLIC  _?xTaskGetTickCount
                        313             PUBLIC  _?cTaskResumeAll
                        314             PUBLIC  _?vTaskSuspendAll
                        315             PUBLIC  _?vTaskEndScheduler
                        316             PUBLIC  _?vTaskStartScheduler
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE     6

                        317             PUBLIC  _?vTaskResume
                        318             PUBLIC  _?vTaskSuspend
                        319             PUBLIC  _?vTaskDelay
                        320             PUBLIC  _?vTaskDelayUntil
                        321             PUBLIC  _?sTaskCreate
                        322     
------                  323             RSEG  ?XD?TASKS
000000                  324        ucTaskNumber:   DS   1
000001                  325     pxReadyTasksLists:   DS   240
0000F1                  326     usCurrentNumberOfTasks:   DS   2
0000F3                  327     ucTopUsedPriority:   DS   1
0000F4                  328          xTickCount:   DS   4
0000F8                  329     xDelayedTaskList1:   DS   24
000110                  330     xDelayedTaskList2:   DS   24
000128                  331     sUsingPreemption:   DS   2
00012A                  332        pxCurrentTCB:   DS   3
00012D                  333     ucSchedulerSuspended:   DS   1
00012E                  334     pxOverflowDelayedTaskList:   DS   3
000131                  335       ucMissedTicks:   DS   1
000132                  336     xPendingReadyList:   DS   24
00014A                  337     pxDelayedTaskList:   DS   3
00014D                  338     xSuspendedTaskList:   DS   24
000165                  339     cSchedulerRunning:   DS   1
000166                  340     ucTopReadyPriority:   DS   1
                        341     
------                  342             RSEG  ?CO?TASKS
000000                  343     ?SC_0:
000000 49444C45         344             DB  'I' ,'D' ,'L' ,'E' ,000H
000004 00                       
                        345     
                        346     
------                  347             RSEG ?C_INITSEG
                        348     
------                  349             RSEG  ?C_INITSEG
000000 43               350             DB      043H
000001 0000       F     351             DW      pxCurrentTCB
000003 000000           352             DB      000H,000H,000H  ; ptr3
                        353     
000006 42               354             DB      042H
000007 0000       F     355             DW      sUsingPreemption
000009 0000             356             DW      00000H
                        357     
00000B 42               358             DB      042H
00000C 0000       F     359             DW      usCurrentNumberOfTasks
00000E 0000             360             DW      00000H
                        361     
000010 44               362             DB      044H
000011 0000       F     363             DW      xTickCount
000013 00000000         364             DB      000H,000H,000H,000H     ; long
                        365     
000017 41               366             DB      041H
000018 0000       F     367             DW      ucTopUsedPriority
00001A 00               368             DB      000H
                        369     
00001B 41               370             DB      041H
00001C 0000       F     371             DW      ucTopReadyPriority
00001E 00               372             DB      000H
                        373     
00001F 41               374             DB      041H
000020 0000       F     375             DW      cSchedulerRunning
000022 00               376             DB      000H
                        377     
000023 41               378             DB      041H
000024 0000       F     379             DW      ucSchedulerSuspended
000026 00               380             DB      000H
                        381     
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE     7

000027 41               382             DB      041H
000028 0000       F     383             DW      ucMissedTicks
00002A 00               384             DB      000H
                        385     
00002B 41               386             DB      041H
00002C 0000       F     387             DW      ucTaskNumber
00002E 00               388             DB      000H
                        389     
                        390     ; /*
                        391     ;       FreeRTOS V2.6.0 - Copyright (C) 2003 - 2005 Richard Barry.
                        392     ; 
                        393     ;       This file is part of the FreeRTOS distribution.
                        394     ; 
                        395     ;       FreeRTOS is free software; you can redistribute it and/or modify
                        396     ;       it under the terms of the GNU General Public License as published by
                        397     ;       the Free Software Foundation; either version 2 of the License, or
                        398     ;       (at your option) any later version.
                        399     ; 
                        400     ;       FreeRTOS is distributed in the hope that it will be useful,
                        401     ;       but WITHOUT ANY WARRANTY; without even the implied warranty of
                        402     ;       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
                        403     ;       GNU General Public License for more details.
                        404     ; 
                        405     ;       You should have received a copy of the GNU General Public License
                        406     ;       along with FreeRTOS; if not, write to the Free Software
                        407     ;       Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
                        408     ; 
                        409     ;       A special exception to the GPL can be applied should you wish to distribute
                        410     ;       a combined work that includes FreeRTOS, without being obliged to provide
                        411     ;       the source code for any proprietary components.  See the licensing section 
                        412     ;       of http://www.FreeRTOS.org for full details of how and when the exception
                        413     ;       can be applied.
                        414     ; 
                        415     ;       ***************************************************************************
                        416     ;       See http://www.FreeRTOS.org for documentation, latest information, license 
                        417     ;       and contact details.  Please ensure to read the configuration and relevant 
                        418     ;       port sections of the online documentation.
                        419     ;       ***************************************************************************
                        420     ; */
                        421     ; 
                        422     ; /*
                        423     ; Changes from V1.00:
                        424     ;       
                        425     ;       + Call to portRESTORE_CONTEXT has been removed.  The first context
                        426     ;         switch is now performed within sPortStartScheduler().
                        427     ; 
                        428     ; Changes from V1.01:
                        429     ; 
                        430     ;       + More use of 8bit data types.
                        431     ;       + Function name prefixes changed where the data type returned has changed.
                        432     ;       + USE_TRACE_FACILITY is no longer defined by default.
                        433     ; 
                        434     ; Changes from V1.2.0
                        435     ; 
                        436     ;       + Introduced ucTopReadyPriority.  This tracks the highest priority ready
                        437     ;         queue that contains a valid TCB and thus makes the context switch 
                        438     ;         slightly faster.
                        439     ; 
                        440     ;       + prvAddTaskToReadyQueue() has been made a macro.
                        441     ; 
                        442     ; Changes from V1.2.6
                        443     ; 
                        444     ;       + Added conditional compilation directives.
                        445     ;       + Extended API.
                        446     ;       + Rearranged function order.
                        447     ;       + Creating a task now causes a context switch if the task being created
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE     8

                        448     ;         has a higher priority than the calling task - assuming the kernel is
                        449     ;         running.
                        450     ;       + vTaskDelete() now only causes a context switch if the calling task is
                        451     ;         the task being deleted.
                        452     ; 
                        453     ; Changes from V2.0.0
                        454     ; 
                        455     ;       + Allow the type of the tick count to be 16 or 32 bits.
                        456     ;       + Introduce xPendingReadyList feature to allow the time interrupts have to
                        457     ;         be disabled to be minimised.
                        458     ;       + Remove the #if( INCLUDE_vTaskSuspendAll ) statements.  vTaskSuspendAll()
                        459     ;         is now always included as it is used by the scheduler itself.
                        460     ; 
                        461     ; Changes from V2.1.0
                        462     ; 
                        463     ;       + Bug fix - pxCurrentTCB is now initialised before the call to 
                        464     ;         prvInitialiseTaskLists().  Previously pxCurrentTCB could be accessed 
                        465     ;         while null.
                        466     ; 
                        467     ; Changed from V2.1.1
                        468     ; 
                        469     ;       + Change to where lStackSize is declared within sTaskCreate() to prevent
                        470     ;         compiler warnings with 8051 port.
                        471     ; 
                        472     ; Changes from V2.2.0
                        473     ; 
                        474     ;       + Explicit use of 'signed' qualifier on portCHAR types added.
                        475     ;       + Changed odd calculation of initial pxTopOfStack value when 
                        476     ;         portSTACK_GROWTH < 0.
                        477     ;       + Removed pcVersionNumber definition.
                        478     ; 
                        479     ; Changes from V2.5.3
                        480     ; 
                        481     ;       + cTaskResumeAll() modified to ensure it can be called prior to the task
                        482     ;         lists being initialised.
                        483     ; 
                        484     ; Changes from V2.5.5
                        485     ; 
                        486     ;       + Added API function vTaskDelayUntil().
                        487     ;       + Added INCLUDE_vTaskDelay conditional compilation.
                        488     ; */
                        489     ; 
                        490     ; #include <stdio.h>
                        491     ; #include <stdlib.h>
                        492     ; #include <string.h>
                        493     ; 
                        494     ; #include "projdefs.h"
                        495     ; #include "portable.h"
                        496     ; #include "task.h"
                        497     ; #include "errors.h"
                        498     ; extern INT8U xdata * data C_XBP;
                        499     ; /*
                        500     ;  * Macro to define the amount of stack available to the idle task.
                        501     ;  */
                        502     ; #define tskIDLE_STACK_SIZE    portMINIMAL_STACK_SIZE
                        503     ; 
                        504     ; /*
                        505     ;  * Task control block.  A task control block (TCB) is allocated to each task,
                        506     ;  * and stores the context of the task.
                        507     ;  */
                        508     ; typedef struct tskTaskControlBlock
                        509     ; {
                        510     ;       portSTACK_TYPE          *pxTopOfStack;                                          
                               /*< Points to the location of the last item placed on the tasks stack.  THIS MUST BE THE FIRST MEMBER OF THE STRUCT. */
                        511     ;       portSTACK_TYPE          *pxStack;                                               
                                       /*< Points to the start of the stack. */
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE     9

                        512     ;       unsigned portSHORT      usStackDepth;                                           
                               /*< Total depth of the stack (when empty).  This is defined as the number of variables th
                               e stack can hold, not the number of bytes. */
                        513     ;       signed portCHAR         pcTaskName[ tskMAX_TASK_NAME_LEN ];     /*< Descriptive 
                               name given to the task when created.  Facilitates debugging only. */
                        514     ;       unsigned portCHAR       ucPriority;                                             
                                       /*< The priority of the task where 0 is the lowest priority. */
                        515     ; 
                        516     ;       xListItem                       xGenericListItem;                               
                                       /*< List item used to place the TCB in ready and blocked queues. */
                        517     ;       xListItem                       xEventListItem;                                 
                                       /*< List item used to place the TCB in event lists. */
                        518     ; 
                        519     ;       unsigned portCHAR       ucTCBNumber;                                            
                               /*< This is used for tracing the scheduler only. */
                        520     ; } tskTCB;
                        521     ; 
                        522     ; /*lint -e956 */
                        523     ; 
                        524     ; volatile tskTCB * volatile pxCurrentTCB = NULL;                                       
                        525     ; 
                        526     ; /* Lists for ready and blocked tasks. --------------------*/
                        527     ; 
                        528     ;  volatile xList pxReadyTasksLists[ portMAX_PRIORITIES ];      /*< Prioratised ready ta
                               sks. */
                        529     ; static volatile xList xDelayedTaskList1;                                              
                               /*< Delayed tasks. */
                        530     ; static volatile xList xDelayedTaskList2;                                              
                               /*< Delayed tasks (two lists are used - one for delays that have overflowed the current tick count. */
                        531     ; static volatile xList *pxDelayedTaskList;                                             
                               /*< Points to the delayed task list currently being used. */
                        532     ; static volatile xList *pxOverflowDelayedTaskList;                             /*< Poin
                               ts to the delayed task list currently being used to hold tasks that have overflowed the current tick count. */
                        533     ; static volatile xList xPendingReadyList;                                              
                               /*< Tasks that have been readied while the scheduler was suspended.  They will be moved t
                               o the ready queue when the scheduler is resumed. */
                        534     ; 
                        535     ; #if( INCLUDE_vTaskDelete == 1 )
                        536     ; 
                        537     ;       static volatile xList xTasksWaitingTermination;                         /*< Task
                               s that have been deleted - but the their memory not yet freed. */
                        538     ; 
                        539     ; #endif
                        540     ; 
                        541     ; #if( INCLUDE_vTaskSuspend == 1 )
                        542     ; 
                        543     ;       static volatile xList xSuspendedTaskList;                                       
                               /*< Tasks that are currently suspended. */
                        544     ; 
                        545     ; #endif
                        546     ; 
                        547     ; /* File private variables. --------------------------------*/
                        548     ; static portSHORT sUsingPreemption = pdFALSE;
                        549     ; static unsigned portSHORT usCurrentNumberOfTasks = ( unsigned portSHORT ) 0;          
                                   
                        550     ; volatile portTickType xTickCount = ( portTickType ) 0;                                
                               /* Modified by tick ISR. */
                        551     ; static unsigned portCHAR ucTopUsedPriority = tskIDLE_PRIORITY;
                        552     ; static volatile unsigned portCHAR ucTopReadyPriority = tskIDLE_PRIORITY;
                        553     ; static signed portCHAR cSchedulerRunning = pdFALSE;
                        554     ; static volatile unsigned portCHAR ucSchedulerSuspended = pdFALSE;
                        555     ; static volatile unsigned portCHAR ucMissedTicks = ( unsigned portCHAR ) 0;
                        556     ; 
                        557     ; /* Debugging and trace facilities private variables and macros. ------------*/
                        558     ; 
                        559     ; /*
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    10

                        560     ;  * The value used to fill the stack of a task when the task is created.  This
                        561     ;  * is used purely for checking the high water mark for tasks.
                        562     ;  */
                        563     ; #define tskSTACK_FILL_BYTE    ( 0xa5 )
                        564     ; 
                        565     ; /*
                        566     ;  * Macros used by vListTask to indicate which state a task is in.
                        567     ;  */
                        568     ; #define tskBLOCKED_CHAR               ( ( signed portCHAR ) 'B' )
                        569     ; #define tskREADY_CHAR         ( ( signed portCHAR ) 'R' )
                        570     ; #define tskDELETED_CHAR               ( ( signed portCHAR ) 'D' )
                        571     ; #define tskSUSPENDED_CHAR     ( ( signed portCHAR ) 'S' )
                        572     ; 
                        573     ; /* 
                        574     ;  * Macros and private variables used by the trace facility.
                        575     ;  */
                        576     ; #if( USE_TRACE_FACILITY == 1 )
                        577     ; 
                        578     ;       #define tskSIZE_OF_EACH_TRACE_LINE                      ( sizeof( unsigned portL
                               ONG ) + sizeof( unsigned portCHAR ) )
                        579     ;       static volatile signed portCHAR * volatile pcTraceBuffer;
                        580     ;       static signed portCHAR *pcTraceBufferStart;
                        581     ;       static signed portCHAR *pcTraceBufferEnd;
                        582     ;       static signed portCHAR cTracing = ( signed portCHAR ) pdFALSE;
                        583     ; 
                        584     ; #endif
                        585     ; 
                        586     ; /*
                        587     ;  * Macro that writes a trace of scheduler activity to a buffer.  This trace
                        588     ;  * shows which task is running when and is very useful as a debugging tool.
                        589     ;  * As this macro is called each context switch it is a good idea to undefine
                        590     ;  * it if not using the facility.
                        591     ;  */
                        592     ; #if( USE_TRACE_FACILITY == 1 )
                        593     ; 
                        594     ;       #define vWriteTraceToBuffer()                                                   
                                                                                       \
                        595     ;       {                                                                               
                                                                                                                       \
                        596     ;               if( cTracing )                                                          
                                                                                                       \
                        597     ;               {                                                                       
                                                                                                                       \
                        598     ;                       static unsigned portCHAR ucPreviousTask = 255;                  
                                                                       \
                        599     ;                                                                                       
                                                                                                                       \
                        600     ;                       if( ucPreviousTask != pxCurrentTCB->ucTCBNumber )               
                                                                       \
                        601     ;                       {                                                               
                                                                                                                       \
                        602     ;                               if( ( pcTraceBuffer + tskSIZE_OF_EACH_TRACE_LINE ) < pcT
                               raceBufferEnd ) \
                        603     ;                               {                                                       
                                                                                                                       \
                        604     ;                                       ucPreviousTask = pxCurrentTCB->ucTCBNumber;     
                                                                               \
                        605     ;                                       *( unsigned portLONG * ) pcTraceBuffer = ( unsig
                               ned portLONG ) xTickCount;      \
                        606     ;                                       pcTraceBuffer += sizeof( unsigned portLONG );   
                                                                       \
                        607     ;                                       *( unsigned portCHAR * ) pcTraceBuffer = ucPrevi
                               ousTask;                        \
                        608     ;                                       pcTraceBuffer += sizeof( unsigned portCHAR );   
                                                                       \
                        609     ;                               }                                                       
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    11

                                                                                                                       \
                        610     ;                               else                                                    
                                                                                                               \
                        611     ;                               {                                                       
                                                                                                                       \
                        612     ;                                       cTracing = ( signed portCHAR ) pdFALSE;         
                                                                               \
                        613     ;                               }                                                       
                                                                                                                       \
                        614     ;                       }                                                               
                                                                                                                       \
                        615     ;               }                                                                       
                                                                                                                       \
                        616     ;       }
                        617     ; 
                        618     ; #else
                        619     ; 
                        620     ;       #define vWriteTraceToBuffer()
                        621     ; 
                        622     ; #endif
                        623     ; 
                        624     ; 
                        625     ; /*
                        626     ;  * Place the task represented by pxTCB into the appropriate ready queue for
                        627     ;  * the task.  It is inserted at the end of the list.  One quirk of this is
                        628     ;  * that if the task being inserted is at the same priority as the currently
                        629     ;  * executing task, then it will only be rescheduled after the currently 
                        630     ;  * executing task has been rescheduled.
                        631     ;  */
                        632     ; #define prvAddTaskToReadyQueue( pxTCB )                                               
                                                                                                                                       \
                        633     ; {                                                                                     
                                                                                                                        
                                                                              \
                        634     ;       listSET_LIST_ITEM_VALUE( &( pxTCB->xGenericListItem ), 0 );                     
                                                                                                               \
                        635     ;       if( pxTCB->ucPriority > ucTopReadyPriority )                                    
                                                                                                                       \
                        636     ;       {                                                                               
                                                                                                                        
                                                                              \
                        637     ;               ucTopReadyPriority = pxTCB->ucPriority;                                 
                                                                                                                               \
                        638     ;       }                                                                               
                                                                                                                        
                                                                              \
                        639     ;       vListInsertEnd( ( xList * ) &( pxReadyTasksLists[ pxTCB->ucPriority ] ), &( pxTC
                               B->xGenericListItem ) );        \
                        640     ; }     
                        641     ; 
                        642     ; 
                        643     ; /*
                        644     ;  * Macro that looks at the list of tasks that are currently delayed to see if 
                        645     ;  * any require waking.
                        646     ;  *
                        647     ;  * Tasks are stored in the queue in the order of their wake time - meaning
                        648     ;  * once one tasks has been found whose timer has not expired we need not look
                        649     ;  * any further down the list.
                        650     ;  */
                        651     ; #define prvCheckDelayedTasks()                                                        
                                                                                                               \
                        652     ; {                                                                                     
                                                                                                                                       \
                        653     ; register tskTCB *pxTCB;                                                               
                                                                                                                       \
                        654     ;                                                                                       
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    12

                                                                                                                                       \
                        655     ;       while( ( pxTCB = ( tskTCB * ) listGET_OWNER_OF_HEAD_ENTRY( pxDelayedTaskList ) )
                                != NULL )      \
                        656     ;       {                                                                               
                                                                                                                                       \
                        657     ;               if( xTickCount < listGET_LIST_ITEM_VALUE( &( pxTCB->xGenericListItem ) )
                                )                              \
                        658     ;               {                                                                       
                                                                                                                                       \
                        659     ;                       break;                                                          
                                                                                                                               \
                        660     ;               }                                                                       
                                                                                                                                       \
                        661     ;               vListRemove( &( pxTCB->xGenericListItem ) );                            
                                                                                       \
                        662     ;               /* Is the task waiting on an event also? */                             
                                                                                               \
                        663     ;               if( pxTCB->xEventListItem.pvContainer )                                 
                                                                                               \
                        664     ;               {                                                                       
                                                                                                                                       \
                        665     ;                       vListRemove( &( pxTCB->xEventListItem ) );                      
                                                                                               \
                        666     ;               }                                                                       
                                                                                                                                       \
                        667     ;               prvAddTaskToReadyQueue( pxTCB );                                        
                                                                                                       \
                        668     ;       }                                                                               
                                                                                                                                       \
                        669     ; }                                                                                     
                                                                                                                               
                        670     ; 
                        671     ; /*
                        672     ;  * Several functions take an xTaskHandle parameter that can optionally be NULL,
                        673     ;  * where NULL is used to indicate that the handle of the currently executing 
                        674     ;  * task should be used in place of the parameter.  This macro simply checks to 
                        675     ;  * see if the parameter is NULL and returns a pointer to the appropriate TCB.
                        676     ;  */
                        677     ; #define prvGetTCBFromHandle( pxHandle ) ( ( pxHandle == NULL ) ? ( tskTCB * ) pxCurren
                               tTCB : ( tskTCB * ) pxHandle )
                        678     ; 
                        679     ; 
                        680     ; /* File private functions. --------------------------------*/
                        681     ; 
                        682     ; /*
                        683     ;  * Utility to ready a TCB for a given task.  Mainly just copies the parameters
                        684     ;  * into the TCB structure.
                        685     ;  */
                        686     ; static void prvInitialiseTCBVariables( tskTCB *pxTCB, unsigned portSHORT usStackDepth,
                                const signed portCHAR * const pcName, unsigned portCHAR ucPriority ) reentrant ;
                        687     ; 
                        688     ; /*
                        689     ;  * Utility to ready all the lists used by the scheduler.  This is called 
                        690     ;  * automatically upon the creation of the first task.
                        691     ;  */
                        692     ; static portSHORT prvInitialiseTaskLists( void ) reentrant;
                        693     ; 
                        694     ; /*
                        695     ;  * The idle task, which as all tasks is implemented as a never ending loop.
                        696     ;  * The idle task is automatically created and added to the ready lists upon
                        697     ;  * creation of the first user task.
                        698     ;  */
                        699     ; static void prvIdleTask( void *pvParameters ) reentrant;
                        700     ; 
                        701     ; /*
                        702     ;  * Utility to free all memory allocated by the scheduler to hold a TCB, 
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    13

                        703     ;  * including the stack pointed to by the TCB.  
                        704     ;  *
                        705     ;  * This does not free memory allocated by the task itself (i.e. memory 
                        706     ;  * allocated by calls to pvPortMalloc from within the tasks application code).
                        707     ;  */
                        708     ; #if( ( INCLUDE_vTaskDelete == 1 ) || ( INCLUDE_vTaskCleanUpResources == 1 ) )
                        709     ;       static void prvDeleteTCB( tskTCB *pxTCB )reentrant;
                        710     ; #endif
                        711     ; 
                        712     ; /*
                        713     ;  * Used only by the idle task.  This checks to see if anything has been placed
                        714     ;  * in the list of tasks waiting to be deleted.  If so the task is cleaned up
                        715     ;  * and its TCB deleted.
                        716     ;  */
                        717     ; static void prvCheckTasksWaitingTermination( void )reentrant;
                        718     ; 
                        719     ; /*
                        720     ;  * Allocates memory from the heap for a TCB and associated stack.  Checks the
                        721     ;  * allocation was successful.
                        722     ;  */
                        723     ; static tskTCB *prvAllocateTCBAndStack( unsigned portSHORT usStackDepth )reentrant;
                        724     ; 
                        725     ; /*
                        726     ;  * Called from vTaskList.  vListTasks details all the tasks currently under
                        727     ;  * control of the scheduler.  The tasks may be in one of a number of lists.
                        728     ;  * prvListTaskWithinSingleList accepts a list and details the tasks from
                        729     ;  * within just that list.
                        730     ;  *
                        731     ;  * THIS FUNCTION IS INTENDED FOR DEBUGGING ONLY, AND SHOULD NOT BE CALLED FROM
                        732     ;  * NORMAL APPLICATION CODE.
                        733     ;  */
                        734     ; #if( USE_TRACE_FACILITY == 1 )
                        735     ; 
                        736     ;       static void prvListTaskWithinSingleList( signed portCHAR *pcWriteBuffer, xList *
                               pxList, signed portCHAR cStatus )reentrant;
                        737     ; #endif
                        738     ; 
                        739     ; 
                        740     ; /*lint +e956 */
                        741     ; 
                        742     ; 
                        743     ; 
                        744     ; 
                        745     ; 
                        746     ; /*-----------------------------------------------------------
                        747     ;  * TASK CREATION API documented in task.h
                        748     ;  *----------------------------------------------------------*/
                        749     ; 
                        750     ; portSHORT sTaskCreate( pdTASK_CODE pvTaskCode, const signed portCHAR * const pcName, u
                               nsigned portSHORT usStackDepth, void *pvParameters, unsigned portCHAR ucPriority, xTaskHandle *pxCreatedTask )reentrant
                        751     
------                  752             RSEG  ?PR?_?sTaskCreate?TASKS
000000                  753     _?sTaskCreate:
                        754             USING   0
                        755                             ; SOURCE LINE # 361
000000 9000FFFD         756             MOV     DPTR,#0FFFDH
000004 12000000   E     757             LCALL   ?C?ADDXBP
000008 EB               758             MOV     A,R3
000009 F0               759             MOVX    @DPTR,A
00000A A3               760             INC     DPTR
00000B EA               761             MOV     A,R2
00000C F0               762             MOVX    @DPTR,A
00000D A3               763             INC     DPTR
00000E E9               764             MOV     A,R1
00000F F0               765             MOVX    @DPTR,A
000010 9000FFF4         766             MOV     DPTR,#0FFF4H
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    14

000014 12000000   E     767             LCALL   ?C?ADDXBP
                        768     ; {
                        769     ; portSHORT sReturn;
                        770     ; tskTCB * pxNewTCB;
                        771     ; static unsigned portCHAR ucTaskNumber = 0; /*lint !e956 Static is deliberate - this is
                                guarded before use. */
                        772     ; 
                        773     ;       /* Allocate the memory required by the TCB and stack for the new task.  
                        774     ;       checking that the allocation was successful. */
                        775     ;       pxNewTCB = prvAllocateTCBAndStack( usStackDepth );
                        776                             ; SOURCE LINE # 369
000018 90000012         777             MOV     DPTR,#012H
00001C 12000000   E     778             LCALL   ?C?XBPOFF
000020 E0               779             MOVX    A,@DPTR
000021 FE               780             MOV     R6,A
000022 A3               781             INC     DPTR
000023 E0               782             MOVX    A,@DPTR
000024 FF               783             MOV     R7,A
000025 12000000   F     784             LCALL   _?prvAllocateTCBAndStack
000029 850083     E     785             MOV     DPH,?C_XBP
00002C 850082     E     786             MOV     DPL,?C_XBP+01H
00002F A3               787             INC     DPTR
000030 A3               788             INC     DPTR
000031 759300     E     789             MOV     DPX,#?C?XDATASEG
000034 EB               790             MOV     A,R3
000035 F0               791             MOVX    @DPTR,A
000036 A3               792             INC     DPTR
000037 EA               793             MOV     A,R2
000038 F0               794             MOVX    @DPTR,A
000039 A3               795             INC     DPTR
00003A E9               796             MOV     A,R1
00003B F0               797             MOVX    @DPTR,A
                        798     ;       if( pxNewTCB != NULL )
                        799                             ; SOURCE LINE # 370
00003C 850083     E     800             MOV     DPH,?C_XBP
00003F 850082     E     801             MOV     DPL,?C_XBP+01H
000042 A3               802             INC     DPTR
000043 A3               803             INC     DPTR
000044 759300     E     804             MOV     DPX,#?C?XDATASEG
000047 E0               805             MOVX    A,@DPTR
000048 FB               806             MOV     R3,A
000049 A3               807             INC     DPTR
00004A E0               808             MOVX    A,@DPTR
00004B FA               809             MOV     R2,A
00004C A3               810             INC     DPTR
00004D E0               811             MOVX    A,@DPTR
00004E 4A               812             ORL     A,R2
00004F 4B               813             ORL     A,R3
000050 7003             814             JNZ     $ + 5H
000052 010000     F     815             AJMP    ?C0001
                        816     ;       {               
                        817                             ; SOURCE LINE # 371
                        818     ;               portSTACK_TYPE *pxTopOfStack;
                        819     ; 
                        820     ;               /* Setup the newly allocated TCB with the initial state of the task. */
                        821     ;               prvInitialiseTCBVariables( pxNewTCB, usStackDepth, pcName, ucPriority );
                        822                             ; SOURCE LINE # 375
000055 90000017         823             MOV     DPTR,#017H
000059 12000000   E     824             LCALL   ?C?XBPOFF
00005D E0               825             MOVX    A,@DPTR
00005E FF               826             MOV     R7,A
00005F 9000FFFF         827             MOV     DPTR,#0FFFFH
000063 12000000   E     828             LCALL   ?C?ADDXBP
000067 EF               829             MOV     A,R7
000068 F0               830             MOVX    @DPTR,A
000069 90000010         831             MOV     DPTR,#010H
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    15

00006D 12000000   E     832             LCALL   ?C?XBPOFF
000071 E0               833             MOVX    A,@DPTR
000072 FB               834             MOV     R3,A
000073 A3               835             INC     DPTR
000074 E0               836             MOVX    A,@DPTR
000075 FA               837             MOV     R2,A
000076 A3               838             INC     DPTR
000077 E0               839             MOVX    A,@DPTR
000078 F9               840             MOV     R1,A
000079 9000FFFD         841             MOV     DPTR,#0FFFDH
00007D 12000000   E     842             LCALL   ?C?ADDXBP
000081 EB               843             MOV     A,R3
000082 F0               844             MOVX    @DPTR,A
000083 A3               845             INC     DPTR
000084 EA               846             MOV     A,R2
000085 F0               847             MOVX    @DPTR,A
000086 A3               848             INC     DPTR
000087 E9               849             MOV     A,R1
000088 F0               850             MOVX    @DPTR,A
000089 90000016         851             MOV     DPTR,#016H
00008D 12000000   E     852             LCALL   ?C?XBPOFF
000091 E0               853             MOVX    A,@DPTR
000092 FC               854             MOV     R4,A
000093 A3               855             INC     DPTR
000094 E0               856             MOVX    A,@DPTR
000095 FD               857             MOV     R5,A
000096 90000006         858             MOV     DPTR,#06H
00009A 12000000   E     859             LCALL   ?C?XBPOFF
00009E E0               860             MOVX    A,@DPTR
00009F FB               861             MOV     R3,A
0000A0 A3               862             INC     DPTR
0000A1 E0               863             MOVX    A,@DPTR
0000A2 FA               864             MOV     R2,A
0000A3 A3               865             INC     DPTR
0000A4 E0               866             MOVX    A,@DPTR
0000A5 F9               867             MOV     R1,A
0000A6 12000000   F     868             LCALL   _?prvInitialiseTCBVariables
                        869     ; 
                        870     ;               /* Calculate the top of stack address.  This depends on whether the
                        871     ;               stack grows from high memory to low (as per the 80x86) or visa versa. 
                        872     ;               portSTACK_GROWTH is used to make the result positive or negative as
                        873     ;               required by the port. */
                        874     ;               #if portSTACK_GROWTH < 0
                        875     ;               {
                        876                             ; SOURCE LINE # 382
                        877     ;                       portLONG lStackSize; 
                        878     ; 
                        879     ;                       lStackSize = ( portLONG ) ( pxNewTCB->usStackDepth - ( unsigned 
                               portSHORT ) 1 );
                        880                             ; SOURCE LINE # 385
0000AA 850083     E     881             MOV     DPH,?C_XBP
0000AD 850082     E     882             MOV     DPL,?C_XBP+01H
0000B0 A3               883             INC     DPTR
0000B1 A3               884             INC     DPTR
0000B2 759300     E     885             MOV     DPX,#?C?XDATASEG
0000B5 E0               886             MOVX    A,@DPTR
0000B6 FB               887             MOV     R3,A
0000B7 A3               888             INC     DPTR
0000B8 E0               889             MOVX    A,@DPTR
0000B9 FA               890             MOV     R2,A
0000BA A3               891             INC     DPTR
0000BB E0               892             MOVX    A,@DPTR
0000BC 2406             893             ADD     A,#06H
0000BE F9               894             MOV     R1,A
0000BF E4               895             CLR     A
0000C0 3A               896             ADDC    A,R2
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    16

0000C1 FA               897             MOV     R2,A
0000C2 12000000   E     898             LCALL   ?C?ILDPTR
0000C6 C3               899             CLR     C
0000C7 9401             900             SUBB    A,#01H
0000C9 FF               901             MOV     R7,A
0000CA E5F0             902             MOV     A,B
0000CC 9400             903             SUBB    A,#00H
0000CE FE               904             MOV     R6,A
0000CF E4               905             CLR     A
0000D0 FC               906             MOV     R4,A
0000D1 FD               907             MOV     R5,A
0000D2 90000008         908             MOV     DPTR,#08H
0000D6 12000000   E     909             LCALL   ?C?XBPOFF
0000DA 12000000   E     910             LCALL   ?C?LSTXDATA
                        911     ;                       pxTopOfStack = pxNewTCB->pxStack + lStackSize;
                        912                             ; SOURCE LINE # 386
0000DE 850083     E     913             MOV     DPH,?C_XBP
0000E1 850082     E     914             MOV     DPL,?C_XBP+01H
0000E4 A3               915             INC     DPTR
0000E5 A3               916             INC     DPTR
0000E6 759300     E     917             MOV     DPX,#?C?XDATASEG
0000E9 E0               918             MOVX    A,@DPTR
0000EA FB               919             MOV     R3,A
0000EB A3               920             INC     DPTR
0000EC E0               921             MOVX    A,@DPTR
0000ED FA               922             MOV     R2,A
0000EE A3               923             INC     DPTR
0000EF E0               924             MOVX    A,@DPTR
0000F0 2403             925             ADD     A,#03H
0000F2 F9               926             MOV     R1,A
0000F3 E4               927             CLR     A
0000F4 3A               928             ADDC    A,R2
0000F5 FA               929             MOV     R2,A
0000F6 12000000   E     930             LCALL   ?C?PLDPTR
0000FA 90000008         931             MOV     DPTR,#08H
0000FE 12000000   E     932             LCALL   ?C?XBPOFF
000102 A3               933             INC     DPTR
000103 E0               934             MOVX    A,@DPTR
000104 FD               935             MOV     R5,A
000105 A3               936             INC     DPTR
000106 E0               937             MOVX    A,@DPTR
000107 FE               938             MOV     R6,A
000108 A3               939             INC     DPTR
000109 E0               940             MOVX    A,@DPTR
00010A 29               941             ADD     A,R1
00010B F9               942             MOV     R1,A
00010C EA               943             MOV     A,R2
00010D 3E               944             ADDC    A,R6
00010E FA               945             MOV     R2,A
00010F EB               946             MOV     A,R3
000110 3D               947             ADDC    A,R5
000111 FB               948             MOV     R3,A
000112 90000005         949             MOV     DPTR,#05H
000116 12000000   E     950             LCALL   ?C?XBPOFF
00011A EB               951             MOV     A,R3
00011B F0               952             MOVX    @DPTR,A
00011C A3               953             INC     DPTR
00011D EA               954             MOV     A,R2
00011E F0               955             MOVX    @DPTR,A
00011F A3               956             INC     DPTR
000120 E9               957             MOV     A,R1
000121 F0               958             MOVX    @DPTR,A
                        959     ;               }
                        960                             ; SOURCE LINE # 387
                        961     ;               #else
                        962     ;               {
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    17

                        963     ;                       pxTopOfStack = pxNewTCB->pxStack;       
                        964     ;               }
                        965     ;               #endif
                        966     ; 
                        967     ;               /* Initialise the TCB stack to look as if the task was already running,
                        968     ;               but had been interrupted by the scheduler.  The return address is set
                        969     ;               to the start of the task function. Once the stack has been initialised
                        970     ;               the     top of stack variable is updated. */
                        971     ;               pxNewTCB->pxTopOfStack = pxPortInitialiseStack( pxTopOfStack, pvTaskCode
                               , pvParameters );
                        972                             ; SOURCE LINE # 398
000122 90000014         973             MOV     DPTR,#014H
000126 12000000   E     974             LCALL   ?C?XBPOFF
00012A E0               975             MOVX    A,@DPTR
00012B FB               976             MOV     R3,A
00012C A3               977             INC     DPTR
00012D E0               978             MOVX    A,@DPTR
00012E FA               979             MOV     R2,A
00012F A3               980             INC     DPTR
000130 E0               981             MOVX    A,@DPTR
000131 F9               982             MOV     R1,A
000132 9000FFFD         983             MOV     DPTR,#0FFFDH
000136 12000000   E     984             LCALL   ?C?ADDXBP
00013A EB               985             MOV     A,R3
00013B F0               986             MOVX    @DPTR,A
00013C A3               987             INC     DPTR
00013D EA               988             MOV     A,R2
00013E F0               989             MOVX    @DPTR,A
00013F A3               990             INC     DPTR
000140 E9               991             MOV     A,R1
000141 F0               992             MOVX    @DPTR,A
000142 9000000F         993             MOV     DPTR,#0FH
000146 12000000   E     994             LCALL   ?C?XBPOFF
00014A E0               995             MOVX    A,@DPTR
00014B FB               996             MOV     R3,A
00014C A3               997             INC     DPTR
00014D E0               998             MOVX    A,@DPTR
00014E FA               999             MOV     R2,A
00014F A3              1000             INC     DPTR
000150 E0              1001             MOVX    A,@DPTR
000151 F9              1002             MOV     R1,A
000152 9000FFFD        1003             MOV     DPTR,#0FFFDH
000156 12000000   E    1004             LCALL   ?C?ADDXBP
00015A EB              1005             MOV     A,R3
00015B F0              1006             MOVX    @DPTR,A
00015C A3              1007             INC     DPTR
00015D EA              1008             MOV     A,R2
00015E F0              1009             MOVX    @DPTR,A
00015F A3              1010             INC     DPTR
000160 E9              1011             MOV     A,R1
000161 F0              1012             MOVX    @DPTR,A
000162 9000000B        1013             MOV     DPTR,#0BH
000166 12000000   E    1014             LCALL   ?C?XBPOFF
00016A E0              1015             MOVX    A,@DPTR
00016B FB              1016             MOV     R3,A
00016C A3              1017             INC     DPTR
00016D E0              1018             MOVX    A,@DPTR
00016E FA              1019             MOV     R2,A
00016F A3              1020             INC     DPTR
000170 E0              1021             MOVX    A,@DPTR
000171 F9              1022             MOV     R1,A
000172 12000000   E    1023             LCALL   _?pxPortInitialiseStack
000176 C003            1024             PUSH    AR3
000178 C002            1025             PUSH    AR2
00017A C001            1026             PUSH    AR1
00017C 850083     E    1027             MOV     DPH,?C_XBP
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    18

00017F 850082     E    1028             MOV     DPL,?C_XBP+01H
000182 A3              1029             INC     DPTR
000183 A3              1030             INC     DPTR
000184 759300     E    1031             MOV     DPX,#?C?XDATASEG
000187 E0              1032             MOVX    A,@DPTR
000188 FB              1033             MOV     R3,A
000189 A3              1034             INC     DPTR
00018A E0              1035             MOVX    A,@DPTR
00018B FA              1036             MOV     R2,A
00018C A3              1037             INC     DPTR
00018D E0              1038             MOVX    A,@DPTR
00018E F9              1039             MOV     R1,A
00018F 12000000   E    1040             LCALL   ?C?PSTPTR
                       1041     ; 
                       1042     ;               /* We are going to manipulate the task queues to add this task to a
                       1043     ;               ready list, so must make sure no interrupts occur. */
                       1044     ;               portENTER_CRITICAL();
000193 A2AFC2AF        1045              DB 0A2H, 0AFH, 0C2H, 0AFH, 0C0H, 0D0H;
000197 C0D0                     
                       1046     ;               {
                       1047                             ; SOURCE LINE # 403
                       1048     ;                       usCurrentNumberOfTasks++;
                       1049                             ; SOURCE LINE # 404
000199 90000000   F    1050             MOV     DPTR,#usCurrentNumberOfTasks+01H
00019D E0              1051             MOVX    A,@DPTR
00019E 04              1052             INC     A
00019F F0              1053             MOVX    @DPTR,A
0001A0 7007            1054             JNZ     ?C0106
0001A2 90000000   F    1055             MOV     DPTR,#usCurrentNumberOfTasks
0001A6 E0              1056             MOVX    A,@DPTR
0001A7 04              1057             INC     A
0001A8 F0              1058             MOVX    @DPTR,A
0001A9                 1059     ?C0106:
                       1060     ;                       if( usCurrentNumberOfTasks == ( unsigned portSHORT ) 1 )
                       1061                             ; SOURCE LINE # 405
0001A9 90000000   F    1062             MOV     DPTR,#usCurrentNumberOfTasks
0001AD E0              1063             MOVX    A,@DPTR
0001AE 7004            1064             JNZ     ?C0107
0001B0 A3              1065             INC     DPTR
0001B1 E0              1066             MOVX    A,@DPTR
0001B2 6401            1067             XRL     A,#01H
0001B4                 1068     ?C0107:
0001B4 7032            1069             JNZ     ?C0002
                       1070     ;                       {
                       1071                             ; SOURCE LINE # 406
                       1072     ;                               /* As this is the first task it must also be the current
                                task. */
                       1073     ;                               pxCurrentTCB = ( volatile tskTCB * volatile ) pxNewTCB;
                       1074                             ; SOURCE LINE # 408
0001B6 850083     E    1075             MOV     DPH,?C_XBP
0001B9 850082     E    1076             MOV     DPL,?C_XBP+01H
0001BC A3              1077             INC     DPTR
0001BD A3              1078             INC     DPTR
0001BE 759300     E    1079             MOV     DPX,#?C?XDATASEG
0001C1 E0              1080             MOVX    A,@DPTR
0001C2 F9              1081             MOV     R1,A
0001C3 A3              1082             INC     DPTR
0001C4 E0              1083             MOVX    A,@DPTR
0001C5 FA              1084             MOV     R2,A
0001C6 A3              1085             INC     DPTR
0001C7 E0              1086             MOVX    A,@DPTR
0001C8 90000000   F    1087             MOV     DPTR,#pxCurrentTCB
0001CC C9              1088             XCH     A,R1
0001CD F0              1089             MOVX    @DPTR,A
0001CE A3              1090             INC     DPTR
0001CF EA              1091             MOV     A,R2
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    19

0001D0 F0              1092             MOVX    @DPTR,A
0001D1 A3              1093             INC     DPTR
0001D2 E9              1094             MOV     A,R1
0001D3 F0              1095             MOVX    @DPTR,A
                       1096     ; 
                       1097     ;                               /* This is the first task to be created so do the prelim
                               inary
                       1098     ;                               initialisation required.  We will not recover if this ca
                               ll 
                       1099     ;                               fails, but we will report the failure. */
                       1100     ;                               sReturn = prvInitialiseTaskLists();
                       1101                             ; SOURCE LINE # 413
0001D4 12000000   F    1102             LCALL   _?prvInitialiseTaskLists
0001D8 850083     E    1103             MOV     DPH,?C_XBP
0001DB 850082     E    1104             MOV     DPL,?C_XBP+01H
0001DE 759300     E    1105             MOV     DPX,#?C?XDATASEG
0001E1 EE              1106             MOV     A,R6
0001E2 F0              1107             MOVX    @DPTR,A
0001E3 A3              1108             INC     DPTR
0001E4 EF              1109             MOV     A,R7
0001E5 F0              1110             MOVX    @DPTR,A
                       1111     ;                       }
                       1112                             ; SOURCE LINE # 414
0001E6 8058            1113             SJMP    ?C0003
0001E8                 1114     ?C0002:
                       1115     ;                       else
                       1116     ;                       {
                       1117                             ; SOURCE LINE # 416
                       1118     ;                               sReturn = pdPASS;
                       1119                             ; SOURCE LINE # 417
0001E8 850083     E    1120             MOV     DPH,?C_XBP
0001EB 850082     E    1121             MOV     DPL,?C_XBP+01H
0001EE 759300     E    1122             MOV     DPX,#?C?XDATASEG
0001F1 E4              1123             CLR     A
0001F2 F0              1124             MOVX    @DPTR,A
0001F3 A3              1125             INC     DPTR
0001F4 04              1126             INC     A
0001F5 F0              1127             MOVX    @DPTR,A
                       1128     ; 
                       1129     ;                               /* If the scheduler is not already running, make this ta
                               sk the
                       1130     ;                               current task if it is the highest priority task to be cr
                               eated
                       1131     ;                               so far. */
                       1132     ;                               if( cSchedulerRunning == pdFALSE )
                       1133                             ; SOURCE LINE # 422
0001F6 90000000   F    1134             MOV     DPTR,#cSchedulerRunning
0001FA E0              1135             MOVX    A,@DPTR
0001FB 7043            1136             JNZ     ?C0003
                       1137     ;                               {
                       1138                             ; SOURCE LINE # 423
                       1139     ;                                       if( pxCurrentTCB->ucPriority <= ucPriority )
                       1140                             ; SOURCE LINE # 424
0001FD 90000000   F    1141             MOV     DPTR,#pxCurrentTCB
000201 E0              1142             MOVX    A,@DPTR
000202 FB              1143             MOV     R3,A
000203 A3              1144             INC     DPTR
000204 E0              1145             MOVX    A,@DPTR
000205 FA              1146             MOV     R2,A
000206 A3              1147             INC     DPTR
000207 E0              1148             MOVX    A,@DPTR
000208 2418            1149             ADD     A,#018H
00020A F9              1150             MOV     R1,A
00020B E4              1151             CLR     A
00020C 3A              1152             ADDC    A,R2
00020D FA              1153             MOV     R2,A
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    20

00020E 12000000   E    1154             LCALL   ?C?CLDPTR
000212 FF              1155             MOV     R7,A
000213 90000017        1156             MOV     DPTR,#017H
000217 12000000   E    1157             LCALL   ?C?XBPOFF
00021B E0              1158             MOVX    A,@DPTR
00021C FE              1159             MOV     R6,A
00021D EF              1160             MOV     A,R7
00021E D3              1161             SETB    C
00021F 9E              1162             SUBB    A,R6
000220 501E            1163             JNC     ?C0003
                       1164     ;                                       {
                       1165                             ; SOURCE LINE # 425
                       1166     ;                                               pxCurrentTCB = ( volatile tskTCB * volat
                               ile ) pxNewTCB; 
                       1167                             ; SOURCE LINE # 426
000222 850083     E    1168             MOV     DPH,?C_XBP
000225 850082     E    1169             MOV     DPL,?C_XBP+01H
000228 A3              1170             INC     DPTR
000229 A3              1171             INC     DPTR
00022A 759300     E    1172             MOV     DPX,#?C?XDATASEG
00022D E0              1173             MOVX    A,@DPTR
00022E F9              1174             MOV     R1,A
00022F A3              1175             INC     DPTR
000230 E0              1176             MOVX    A,@DPTR
000231 FA              1177             MOV     R2,A
000232 A3              1178             INC     DPTR
000233 E0              1179             MOVX    A,@DPTR
000234 90000000   F    1180             MOV     DPTR,#pxCurrentTCB
000238 C9              1181             XCH     A,R1
000239 F0              1182             MOVX    @DPTR,A
00023A A3              1183             INC     DPTR
00023B EA              1184             MOV     A,R2
00023C F0              1185             MOVX    @DPTR,A
00023D A3              1186             INC     DPTR
00023E E9              1187             MOV     A,R1
00023F F0              1188             MOVX    @DPTR,A
                       1189     ;                                       }
                       1190                             ; SOURCE LINE # 427
                       1191     ;                               }
                       1192                             ; SOURCE LINE # 428
                       1193     ;                       }                               
                       1194                             ; SOURCE LINE # 429
000240                 1195     ?C0003:
                       1196     ; 
                       1197     ;                       /* Remember the top priority to make context switching faster.  
                               Use
                       1198     ;                       the priority in pxNewTCB as this has been capped to a valid valu
                               e. */
                       1199     ;                       if( pxNewTCB->ucPriority > ucTopUsedPriority )
                       1200                             ; SOURCE LINE # 433
000240 850083     E    1201             MOV     DPH,?C_XBP
000243 850082     E    1202             MOV     DPL,?C_XBP+01H
000246 A3              1203             INC     DPTR
000247 A3              1204             INC     DPTR
000248 759300     E    1205             MOV     DPX,#?C?XDATASEG
00024B E0              1206             MOVX    A,@DPTR
00024C FB              1207             MOV     R3,A
00024D A3              1208             INC     DPTR
00024E E0              1209             MOVX    A,@DPTR
00024F FA              1210             MOV     R2,A
000250 A3              1211             INC     DPTR
000251 E0              1212             MOVX    A,@DPTR
000252 2418            1213             ADD     A,#018H
000254 F9              1214             MOV     R1,A
000255 E4              1215             CLR     A
000256 3A              1216             ADDC    A,R2
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    21

000257 FA              1217             MOV     R2,A
000258 12000000   E    1218             LCALL   ?C?CLDPTR
00025C FF              1219             MOV     R7,A
00025D 90000000   F    1220             MOV     DPTR,#ucTopUsedPriority
000261 E0              1221             MOVX    A,@DPTR
000262 FE              1222             MOV     R6,A
000263 EF              1223             MOV     A,R7
000264 D3              1224             SETB    C
000265 9E              1225             SUBB    A,R6
000266 4002            1226             JC      ?C0006
                       1227     ;                       {
                       1228                             ; SOURCE LINE # 434
                       1229     ;                               ucTopUsedPriority = pxNewTCB->ucPriority;
                       1230                             ; SOURCE LINE # 435
000268 EF              1231             MOV     A,R7
000269 F0              1232             MOVX    @DPTR,A
                       1233     ;                       }
                       1234                             ; SOURCE LINE # 436
00026A                 1235     ?C0006:
                       1236     ; 
                       1237     ;                       /* Add a counter into the TCB for tracing only. */
                       1238     ;                       pxNewTCB->ucTCBNumber = ucTaskNumber;
                       1239                             ; SOURCE LINE # 439
00026A 90000000   F    1240             MOV     DPTR,#ucTaskNumber
00026E E0              1241             MOVX    A,@DPTR
00026F FF              1242             MOV     R7,A
000270 850083     E    1243             MOV     DPH,?C_XBP
000273 850082     E    1244             MOV     DPL,?C_XBP+01H
000276 A3              1245             INC     DPTR
000277 A3              1246             INC     DPTR
000278 759300     E    1247             MOV     DPX,#?C?XDATASEG
00027B E0              1248             MOVX    A,@DPTR
00027C FB              1249             MOV     R3,A
00027D A3              1250             INC     DPTR
00027E E0              1251             MOVX    A,@DPTR
00027F FA              1252             MOV     R2,A
000280 A3              1253             INC     DPTR
000281 E0              1254             MOVX    A,@DPTR
000282 2439            1255             ADD     A,#039H
000284 F9              1256             MOV     R1,A
000285 E4              1257             CLR     A
000286 3A              1258             ADDC    A,R2
000287 FA              1259             MOV     R2,A
000288 EF              1260             MOV     A,R7
000289 12000000   E    1261             LCALL   ?C?CSTPTR
                       1262     ;                       ucTaskNumber++;
                       1263                             ; SOURCE LINE # 440
00028D 90000000   F    1264             MOV     DPTR,#ucTaskNumber
000291 E0              1265             MOVX    A,@DPTR
000292 04              1266             INC     A
000293 F0              1267             MOVX    @DPTR,A
                       1268     ; 
                       1269     ;                       prvAddTaskToReadyQueue( pxNewTCB );
                       1270                             ; SOURCE LINE # 442
000294 E4              1271             CLR     A
000295 FF              1272             MOV     R7,A
000296 FE              1273             MOV     R6,A
000297 FD              1274             MOV     R5,A
000298 FC              1275             MOV     R4,A
000299 850083     E    1276             MOV     DPH,?C_XBP
00029C 850082     E    1277             MOV     DPL,?C_XBP+01H
00029F A3              1278             INC     DPTR
0002A0 A3              1279             INC     DPTR
0002A1 759300     E    1280             MOV     DPX,#?C?XDATASEG
0002A4 E0              1281             MOVX    A,@DPTR
0002A5 FB              1282             MOV     R3,A
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    22

0002A6 A3              1283             INC     DPTR
0002A7 E0              1284             MOVX    A,@DPTR
0002A8 FA              1285             MOV     R2,A
0002A9 A3              1286             INC     DPTR
0002AA E0              1287             MOVX    A,@DPTR
0002AB 2419            1288             ADD     A,#019H
0002AD F9              1289             MOV     R1,A
0002AE E4              1290             CLR     A
0002AF 3A              1291             ADDC    A,R2
0002B0 FA              1292             MOV     R2,A
0002B1 12000000   E    1293             LCALL   ?C?LSTPTR
0002B5 850083     E    1294             MOV     DPH,?C_XBP
0002B8 850082     E    1295             MOV     DPL,?C_XBP+01H
0002BB A3              1296             INC     DPTR
0002BC A3              1297             INC     DPTR
0002BD 759300     E    1298             MOV     DPX,#?C?XDATASEG
0002C0 E0              1299             MOVX    A,@DPTR
0002C1 FB              1300             MOV     R3,A
0002C2 A3              1301             INC     DPTR
0002C3 E0              1302             MOVX    A,@DPTR
0002C4 FA              1303             MOV     R2,A
0002C5 A3              1304             INC     DPTR
0002C6 E0              1305             MOVX    A,@DPTR
0002C7 2418            1306             ADD     A,#018H
0002C9 F9              1307             MOV     R1,A
0002CA E4              1308             CLR     A
0002CB 3A              1309             ADDC    A,R2
0002CC FA              1310             MOV     R2,A
0002CD 12000000   E    1311             LCALL   ?C?CLDPTR
0002D1 FF              1312             MOV     R7,A
0002D2 90000000   F    1313             MOV     DPTR,#ucTopReadyPriority
0002D6 E0              1314             MOVX    A,@DPTR
0002D7 FE              1315             MOV     R6,A
0002D8 EF              1316             MOV     A,R7
0002D9 D3              1317             SETB    C
0002DA 9E              1318             SUBB    A,R6
0002DB 4002            1319             JC      ?C0007
0002DD EF              1320             MOV     A,R7
0002DE F0              1321             MOVX    @DPTR,A
0002DF                 1322     ?C0007:
0002DF 850083     E    1323             MOV     DPH,?C_XBP
0002E2 850082     E    1324             MOV     DPL,?C_XBP+01H
0002E5 A3              1325             INC     DPTR
0002E6 A3              1326             INC     DPTR
0002E7 759300     E    1327             MOV     DPX,#?C?XDATASEG
0002EA E0              1328             MOVX    A,@DPTR
0002EB FB              1329             MOV     R3,A
0002EC A3              1330             INC     DPTR
0002ED E0              1331             MOVX    A,@DPTR
0002EE FA              1332             MOV     R2,A
0002EF A3              1333             INC     DPTR
0002F0 E0              1334             MOVX    A,@DPTR
0002F1 2419            1335             ADD     A,#019H
0002F3 F9              1336             MOV     R1,A
0002F4 E4              1337             CLR     A
0002F5 3A              1338             ADDC    A,R2
0002F6 FA              1339             MOV     R2,A
0002F7 9000FFFD        1340             MOV     DPTR,#0FFFDH
0002FB 12000000   E    1341             LCALL   ?C?ADDXBP
0002FF EB              1342             MOV     A,R3
000300 F0              1343             MOVX    @DPTR,A
000301 A3              1344             INC     DPTR
000302 EA              1345             MOV     A,R2
000303 F0              1346             MOVX    @DPTR,A
000304 A3              1347             INC     DPTR
000305 E9              1348             MOV     A,R1
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    23

000306 F0              1349             MOVX    @DPTR,A
000307 EF              1350             MOV     A,R7
000308 75F018          1351             MOV     B,#018H
00030B A4              1352             MUL     AB
00030C 2400       F    1353             ADD     A,#LOW (pxReadyTasksLists)
00030E F9              1354             MOV     R1,A
00030F 7400       F    1355             MOV     A,#HIGH (pxReadyTasksLists)
000311 35F0            1356             ADDC    A,B
000313 FA              1357             MOV     R2,A
000314 7B00       F    1358             MOV     R3,#MBYTE (pxReadyTasksLists)
000316 12000000   E    1359             LCALL   _?vListInsertEnd
                       1360     ;               }
                       1361                             ; SOURCE LINE # 443
                       1362     ;               portEXIT_CRITICAL();
00031A D0D092AF        1363              DB 0D0H, 0D0H, 092H, 0AFH;
                       1364     ;       }
                       1365                             ; SOURCE LINE # 445
00031E 800E            1366             SJMP    ?C0008
000320                 1367     ?C0001:
                       1368     ;       else
                       1369     ;       {
                       1370                             ; SOURCE LINE # 447
                       1371     ;               sReturn = errCOULD_NOT_ALLOCATE_REQUIRED_MEMORY;
                       1372                             ; SOURCE LINE # 448
000320 850083     E    1373             MOV     DPH,?C_XBP
000323 850082     E    1374             MOV     DPL,?C_XBP+01H
000326 759300     E    1375             MOV     DPX,#?C?XDATASEG
000329 74FF            1376             MOV     A,#0FFH
00032B F0              1377             MOVX    @DPTR,A
00032C A3              1378             INC     DPTR
00032D F0              1379             MOVX    @DPTR,A
                       1380     ;       }
                       1381                             ; SOURCE LINE # 449
00032E                 1382     ?C0008:
                       1383     ; 
                       1384     ;       if( sReturn == pdPASS )
                       1385                             ; SOURCE LINE # 451
00032E 850083     E    1386             MOV     DPH,?C_XBP
000331 850082     E    1387             MOV     DPL,?C_XBP+01H
000334 759300     E    1388             MOV     DPX,#?C?XDATASEG
000337 E0              1389             MOVX    A,@DPTR
000338 FE              1390             MOV     R6,A
000339 A3              1391             INC     DPTR
00033A E0              1392             MOVX    A,@DPTR
00033B 6401            1393             XRL     A,#01H
00033D 4E              1394             ORL     A,R6
00033E 7070            1395             JNZ     ?C0009
                       1396     ;       {
                       1397                             ; SOURCE LINE # 452
                       1398     ;               if( ( void * ) pxCreatedTask != NULL )
                       1399                             ; SOURCE LINE # 453
000340 90000018        1400             MOV     DPTR,#018H
000344 12000000   E    1401             LCALL   ?C?XBPOFF
000348 E0              1402             MOVX    A,@DPTR
000349 FB              1403             MOV     R3,A
00034A A3              1404             INC     DPTR
00034B E0              1405             MOVX    A,@DPTR
00034C FA              1406             MOV     R2,A
00034D A3              1407             INC     DPTR
00034E E0              1408             MOVX    A,@DPTR
00034F 4A              1409             ORL     A,R2
000350 4B              1410             ORL     A,R3
000351 602D            1411             JZ      ?C0010
                       1412     ;               {
                       1413                             ; SOURCE LINE # 454
                       1414     ;                       /* Pass the TCB out - in an anonymous way.  The calling function
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    24

                               /
                       1415     ;                       task can use this as a handle to delete the task later if 
                       1416     ;                       required.*/
                       1417     ;                       *pxCreatedTask = ( xTaskHandle ) pxNewTCB;
                       1418                             ; SOURCE LINE # 458
000353 850083     E    1419             MOV     DPH,?C_XBP
000356 850082     E    1420             MOV     DPL,?C_XBP+01H
000359 A3              1421             INC     DPTR
00035A A3              1422             INC     DPTR
00035B 759300     E    1423             MOV     DPX,#?C?XDATASEG
00035E E0              1424             MOVX    A,@DPTR
00035F FB              1425             MOV     R3,A
000360 A3              1426             INC     DPTR
000361 E0              1427             MOVX    A,@DPTR
000362 FA              1428             MOV     R2,A
000363 A3              1429             INC     DPTR
000364 E0              1430             MOVX    A,@DPTR
000365 F9              1431             MOV     R1,A
000366 C003            1432             PUSH    AR3
000368 C002            1433             PUSH    AR2
00036A C001            1434             PUSH    AR1
00036C 90000018        1435             MOV     DPTR,#018H
000370 12000000   E    1436             LCALL   ?C?XBPOFF
000374 E0              1437             MOVX    A,@DPTR
000375 FB              1438             MOV     R3,A
000376 A3              1439             INC     DPTR
000377 E0              1440             MOVX    A,@DPTR
000378 FA              1441             MOV     R2,A
000379 A3              1442             INC     DPTR
00037A E0              1443             MOVX    A,@DPTR
00037B F9              1444             MOV     R1,A
00037C 12000000   E    1445             LCALL   ?C?PSTPTR
                       1446     ;               }
                       1447                             ; SOURCE LINE # 459
000380                 1448     ?C0010:
                       1449     ; 
                       1450     ;               if( cSchedulerRunning != pdFALSE )
                       1451                             ; SOURCE LINE # 461
000380 90000000   F    1452             MOV     DPTR,#cSchedulerRunning
000384 E0              1453             MOVX    A,@DPTR
000385 6029            1454             JZ      ?C0009
                       1455     ;               {
                       1456                             ; SOURCE LINE # 462
                       1457     ;                       /* If the created task is of a higher priority than the current 
                               task
                       1458     ;                       then it should run now. */
                       1459     ;                       if( pxCurrentTCB->ucPriority < ucPriority )
                       1460                             ; SOURCE LINE # 465
000387 90000000   F    1461             MOV     DPTR,#pxCurrentTCB
00038B E0              1462             MOVX    A,@DPTR
00038C FB              1463             MOV     R3,A
00038D A3              1464             INC     DPTR
00038E E0              1465             MOVX    A,@DPTR
00038F FA              1466             MOV     R2,A
000390 A3              1467             INC     DPTR
000391 E0              1468             MOVX    A,@DPTR
000392 2418            1469             ADD     A,#018H
000394 F9              1470             MOV     R1,A
000395 E4              1471             CLR     A
000396 3A              1472             ADDC    A,R2
000397 FA              1473             MOV     R2,A
000398 12000000   E    1474             LCALL   ?C?CLDPTR
00039C FF              1475             MOV     R7,A
00039D 90000017        1476             MOV     DPTR,#017H
0003A1 12000000   E    1477             LCALL   ?C?XBPOFF
0003A5 E0              1478             MOVX    A,@DPTR
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    25

0003A6 FE              1479             MOV     R6,A
0003A7 EF              1480             MOV     A,R7
0003A8 C3              1481             CLR     C
0003A9 9E              1482             SUBB    A,R6
0003AA 5004            1483             JNC     ?C0009
                       1484     ;                       {
                       1485                             ; SOURCE LINE # 466
                       1486     ;                               taskYIELD();
                       1487                             ; SOURCE LINE # 467
0003AC 12000000   E    1488             LCALL   _?vPortYield
                       1489     ;                       }
                       1490                             ; SOURCE LINE # 468
                       1491     ;               }
                       1492                             ; SOURCE LINE # 469
                       1493     ;       }
                       1494                             ; SOURCE LINE # 470
0003B0                 1495     ?C0009:
                       1496     ; 
                       1497     ;       return sReturn;
                       1498                             ; SOURCE LINE # 472
0003B0 850083     E    1499             MOV     DPH,?C_XBP
0003B3 850082     E    1500             MOV     DPL,?C_XBP+01H
0003B6 759300     E    1501             MOV     DPX,#?C?XDATASEG
0003B9 E0              1502             MOVX    A,@DPTR
0003BA FE              1503             MOV     R6,A
0003BB A3              1504             INC     DPTR
0003BC E0              1505             MOVX    A,@DPTR
0003BD FF              1506             MOV     R7,A
                       1507     ; }
                       1508                             ; SOURCE LINE # 473
0003BE                 1509     ?C0013:
0003BE 9000001B        1510             MOV     DPTR,#01BH
0003C2 02000000   E    1511             LJMP    ?C?ADDXBP
                       1512     ; END OF _?sTaskCreate
                       1513     
                       1514     ; /*-----------------------------------------------------------*/
                       1515     ; 
                       1516     ; #if( INCLUDE_vTaskDelete == 1 )
                       1517     ; 
                       1518     ;       void vTaskDelete( xTaskHandle pxTaskToDelete ) reentrant
                       1519     ;       {
                       1520     ;       tskTCB *pxTCB;
                       1521     ; 
                       1522     ;               taskENTER_CRITICAL();
                       1523     ;               {
                       1524     ;                       /* If null is passed in here then we are deleting ourselves. */
                       1525     ;                       pxTCB = prvGetTCBFromHandle( pxTaskToDelete );
                       1526     ; 
                       1527     ;                       /* Remove task from the ready list and place in the     terminat
                               ion list.
                       1528     ;                       This will stop the task from be scheduled.  The idle task will c
                               heck
                       1529     ;                       the termination list and free up any memory allocated by the 
                       1530     ;                       scheduler for the TCB and stack. */
                       1531     ;                       vListRemove( &( pxTCB->xGenericListItem ) );
                       1532     ; 
                       1533     ;                       /* Is the task waiting on an event also? */                     
                                                                                                       
                       1534     ;                       if( pxTCB->xEventListItem.pvContainer )
                       1535     ;                       {
                       1536     ;                               vListRemove( &( pxTCB->xEventListItem ) );
                       1537     ;                       }
                       1538     ; 
                       1539     ;                       vListInsertEnd( ( xList * ) &xTasksWaitingTermination, &( pxTCB-
                               >xGenericListItem ) );
                       1540     ;               }
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    26

                       1541     ;               taskEXIT_CRITICAL();
                       1542     ; 
                       1543     ;               /* Force a reschedule if we have just deleted the current task. */
                       1544     ;               if( ( void * ) pxTaskToDelete == NULL )
                       1545     ;               {
                       1546     ;                       taskYIELD();
                       1547     ;               }
                       1548     ;       }
                       1549     ; 
                       1550     ; #endif
                       1551     ; 
                       1552     ; 
                       1553     ; 
                       1554     ; 
                       1555     ; 
                       1556     ; 
                       1557     ; /*-----------------------------------------------------------
                       1558     ;  * TASK CONTROL API documented in task.h
                       1559     ;  *----------------------------------------------------------*/
                       1560     ; 
                       1561     ; #if( INCLUDE_vTaskDelayUntil == 1 )
                       1562     ;       void vTaskDelayUntil( portTickType *pxPreviousWakeTime, portTickType xTimeIncrem
                               ent ) reentrant
                       1563     
------                 1564             RSEG  ?PR?_?vTaskDelayUntil?TASKS
000000                 1565     _?vTaskDelayUntil:
                       1566             USING   0
                       1567                             ; SOURCE LINE # 522
000000 9000FFFC        1568             MOV     DPTR,#0FFFCH
000004 12000000   E    1569             LCALL   ?C?ADDXBP
000008 12000000   E    1570             LCALL   ?C?LSTXDATA
00000C 9000FFFD        1571             MOV     DPTR,#0FFFDH
000010 12000000   E    1572             LCALL   ?C?ADDXBP
000014 EB              1573             MOV     A,R3
000015 F0              1574             MOVX    @DPTR,A
000016 A3              1575             INC     DPTR
000017 EA              1576             MOV     A,R2
000018 F0              1577             MOVX    @DPTR,A
000019 A3              1578             INC     DPTR
00001A E9              1579             MOV     A,R1
00001B F0              1580             MOVX    @DPTR,A
00001C 9000FFFA        1581             MOV     DPTR,#0FFFAH
000020 12000000   E    1582             LCALL   ?C?ADDXBP
                       1583     ;       {
                       1584     ;       portTickType xTimeToWake;
                       1585     ;       portCHAR cAlreadyYielded, cShouldDelay = ( portCHAR ) pdFALSE;
                       1586                             ; SOURCE LINE # 525
000024 90000005        1587             MOV     DPTR,#05H
000028 12000000   E    1588             LCALL   ?C?XBPOFF
00002C E4              1589             CLR     A
00002D F0              1590             MOVX    @DPTR,A
                       1591     ; 
                       1592     ;               vTaskSuspendAll();
                       1593                             ; SOURCE LINE # 527
00002E 12000000   F    1594             LCALL   _?vTaskSuspendAll
                       1595     ;               {
                       1596                             ; SOURCE LINE # 528
                       1597     ;                       /* Generate the tick time at which the task wants to wake. */
                       1598     ;                       xTimeToWake = *pxPreviousWakeTime + xTimeIncrement;
                       1599                             ; SOURCE LINE # 530
000032 90000006        1600             MOV     DPTR,#06H
000036 12000000   E    1601             LCALL   ?C?XBPOFF
00003A E0              1602             MOVX    A,@DPTR
00003B FB              1603             MOV     R3,A
00003C A3              1604             INC     DPTR
00003D E0              1605             MOVX    A,@DPTR
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    27

00003E FA              1606             MOV     R2,A
00003F A3              1607             INC     DPTR
000040 E0              1608             MOVX    A,@DPTR
000041 F9              1609             MOV     R1,A
000042 12000000   E    1610             LCALL   ?C?LLDPTR
000046 90000009        1611             MOV     DPTR,#09H
00004A 12000000   E    1612             LCALL   ?C?XBPOFF
00004E E0              1613             MOVX    A,@DPTR
00004F F8              1614             MOV     R0,A
000050 A3              1615             INC     DPTR
000051 E0              1616             MOVX    A,@DPTR
000052 F9              1617             MOV     R1,A
000053 A3              1618             INC     DPTR
000054 E0              1619             MOVX    A,@DPTR
000055 FA              1620             MOV     R2,A
000056 A3              1621             INC     DPTR
000057 E0              1622             MOVX    A,@DPTR
000058 2F              1623             ADD     A,R7
000059 FF              1624             MOV     R7,A
00005A EA              1625             MOV     A,R2
00005B 3E              1626             ADDC    A,R6
00005C FE              1627             MOV     R6,A
00005D E9              1628             MOV     A,R1
00005E 3D              1629             ADDC    A,R5
00005F FD              1630             MOV     R5,A
000060 E8              1631             MOV     A,R0
000061 3C              1632             ADDC    A,R4
000062 FC              1633             MOV     R4,A
000063 850083     E    1634             MOV     DPH,?C_XBP
000066 850082     E    1635             MOV     DPL,?C_XBP+01H
000069 759300     E    1636             MOV     DPX,#?C?XDATASEG
00006C 12000000   E    1637             LCALL   ?C?LSTXDATA
                       1638     ; 
                       1639     ;                       if( xTickCount < *pxPreviousWakeTime )
                       1640                             ; SOURCE LINE # 532
000070 90000006        1641             MOV     DPTR,#06H
000074 12000000   E    1642             LCALL   ?C?XBPOFF
000078 E0              1643             MOVX    A,@DPTR
000079 FB              1644             MOV     R3,A
00007A A3              1645             INC     DPTR
00007B E0              1646             MOVX    A,@DPTR
00007C FA              1647             MOV     R2,A
00007D A3              1648             INC     DPTR
00007E E0              1649             MOVX    A,@DPTR
00007F F9              1650             MOV     R1,A
000080 12000000   E    1651             LCALL   ?C?LLDPTR
000084 90000000   F    1652             MOV     DPTR,#xTickCount
000088 E0              1653             MOVX    A,@DPTR
000089 F8              1654             MOV     R0,A
00008A A3              1655             INC     DPTR
00008B E0              1656             MOVX    A,@DPTR
00008C F9              1657             MOV     R1,A
00008D A3              1658             INC     DPTR
00008E E0              1659             MOVX    A,@DPTR
00008F FA              1660             MOV     R2,A
000090 A3              1661             INC     DPTR
000091 E0              1662             MOVX    A,@DPTR
000092 FB              1663             MOV     R3,A
000093 C3              1664             CLR     C
000094 12000000   E    1665             LCALL   ?C?ULCMP
000098 505D            1666             JNC     ?C0014
                       1667     ;                       {
                       1668                             ; SOURCE LINE # 533
                       1669     ;                               /* The tick count has overflowed since this function was
                                
                       1670     ;                               lasted called.  In this case the only time we should eve
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    28

                               r 
                       1671     ;                               actually delay is if the wake time has also     overflow
                               ed, 
                       1672     ;                               and the wake time is greater than the tick time.  When t
                               his 
                       1673     ;                               is the case it is as if neither time had overflowed. */
                       1674     ;                               if( ( xTimeToWake < *pxPreviousWakeTime ) && ( xTimeToWa
                               ke > xTickCount ) )
                       1675                             ; SOURCE LINE # 539
00009A 90000006        1676             MOV     DPTR,#06H
00009E 12000000   E    1677             LCALL   ?C?XBPOFF
0000A2 E0              1678             MOVX    A,@DPTR
0000A3 FB              1679             MOV     R3,A
0000A4 A3              1680             INC     DPTR
0000A5 E0              1681             MOVX    A,@DPTR
0000A6 FA              1682             MOV     R2,A
0000A7 A3              1683             INC     DPTR
0000A8 E0              1684             MOVX    A,@DPTR
0000A9 F9              1685             MOV     R1,A
0000AA 12000000   E    1686             LCALL   ?C?LLDPTR
0000AE 850083     E    1687             MOV     DPH,?C_XBP
0000B1 850082     E    1688             MOV     DPL,?C_XBP+01H
0000B4 759300     E    1689             MOV     DPX,#?C?XDATASEG
0000B7 E0              1690             MOVX    A,@DPTR
0000B8 F8              1691             MOV     R0,A
0000B9 A3              1692             INC     DPTR
0000BA E0              1693             MOVX    A,@DPTR
0000BB F9              1694             MOV     R1,A
0000BC A3              1695             INC     DPTR
0000BD E0              1696             MOVX    A,@DPTR
0000BE FA              1697             MOV     R2,A
0000BF A3              1698             INC     DPTR
0000C0 E0              1699             MOVX    A,@DPTR
0000C1 FB              1700             MOV     R3,A
0000C2 C3              1701             CLR     C
0000C3 12000000   E    1702             LCALL   ?C?ULCMP
0000C7 4003            1703             JC      $ + 5H
0000C9 010000     F    1704             AJMP    ?C0016
0000CC 90000000   F    1705             MOV     DPTR,#xTickCount
0000D0 E0              1706             MOVX    A,@DPTR
0000D1 FC              1707             MOV     R4,A
0000D2 A3              1708             INC     DPTR
0000D3 E0              1709             MOVX    A,@DPTR
0000D4 FD              1710             MOV     R5,A
0000D5 A3              1711             INC     DPTR
0000D6 E0              1712             MOVX    A,@DPTR
0000D7 FE              1713             MOV     R6,A
0000D8 A3              1714             INC     DPTR
0000D9 E0              1715             MOVX    A,@DPTR
0000DA FF              1716             MOV     R7,A
0000DB 850083     E    1717             MOV     DPH,?C_XBP
0000DE 850082     E    1718             MOV     DPL,?C_XBP+01H
0000E1 759300     E    1719             MOV     DPX,#?C?XDATASEG
0000E4 E0              1720             MOVX    A,@DPTR
0000E5 F8              1721             MOV     R0,A
0000E6 A3              1722             INC     DPTR
0000E7 E0              1723             MOVX    A,@DPTR
0000E8 F9              1724             MOV     R1,A
0000E9 A3              1725             INC     DPTR
0000EA E0              1726             MOVX    A,@DPTR
0000EB FA              1727             MOV     R2,A
0000EC A3              1728             INC     DPTR
0000ED E0              1729             MOVX    A,@DPTR
0000EE FB              1730             MOV     R3,A
0000EF 12000000   E    1731             LCALL   ?C?ULCMP
0000F3 4066            1732             JC      ?C0016
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    29

                       1733     ;                               {
                       1734                             ; SOURCE LINE # 540
                       1735     ;                                       cShouldDelay = ( portCHAR ) pdTRUE;
                       1736                             ; SOURCE LINE # 541
                       1737     ;                               }
                       1738                             ; SOURCE LINE # 542
                       1739     ;                       }
                       1740                             ; SOURCE LINE # 543
0000F5 8059            1741             SJMP    ?C0121
0000F7                 1742     ?C0014:
                       1743     ;                       else
                       1744     ;                       {
                       1745                             ; SOURCE LINE # 545
                       1746     ;                               /* The tick time has not overflowed.  In this case we wi
                               ll
                       1747     ;                               delay if either the wake time has overflowed, and/or the
                       1748     ;                               tick time is less than the wake time. */
                       1749     ;                               if( ( xTimeToWake < *pxPreviousWakeTime ) || ( xTimeToWa
                               ke > xTickCount ) )
                       1750                             ; SOURCE LINE # 549
0000F7 90000006        1751             MOV     DPTR,#06H
0000FB 12000000   E    1752             LCALL   ?C?XBPOFF
0000FF E0              1753             MOVX    A,@DPTR
000100 FB              1754             MOV     R3,A
000101 A3              1755             INC     DPTR
000102 E0              1756             MOVX    A,@DPTR
000103 FA              1757             MOV     R2,A
000104 A3              1758             INC     DPTR
000105 E0              1759             MOVX    A,@DPTR
000106 F9              1760             MOV     R1,A
000107 12000000   E    1761             LCALL   ?C?LLDPTR
00010B 850083     E    1762             MOV     DPH,?C_XBP
00010E 850082     E    1763             MOV     DPL,?C_XBP+01H
000111 759300     E    1764             MOV     DPX,#?C?XDATASEG
000114 E0              1765             MOVX    A,@DPTR
000115 F8              1766             MOV     R0,A
000116 A3              1767             INC     DPTR
000117 E0              1768             MOVX    A,@DPTR
000118 F9              1769             MOV     R1,A
000119 A3              1770             INC     DPTR
00011A E0              1771             MOVX    A,@DPTR
00011B FA              1772             MOV     R2,A
00011C A3              1773             INC     DPTR
00011D E0              1774             MOVX    A,@DPTR
00011E FB              1775             MOV     R3,A
00011F C3              1776             CLR     C
000120 12000000   E    1777             LCALL   ?C?ULCMP
000124 402A            1778             JC      ?C0018
000126 90000000   F    1779             MOV     DPTR,#xTickCount
00012A E0              1780             MOVX    A,@DPTR
00012B FC              1781             MOV     R4,A
00012C A3              1782             INC     DPTR
00012D E0              1783             MOVX    A,@DPTR
00012E FD              1784             MOV     R5,A
00012F A3              1785             INC     DPTR
000130 E0              1786             MOVX    A,@DPTR
000131 FE              1787             MOV     R6,A
000132 A3              1788             INC     DPTR
000133 E0              1789             MOVX    A,@DPTR
000134 FF              1790             MOV     R7,A
000135 850083     E    1791             MOV     DPH,?C_XBP
000138 850082     E    1792             MOV     DPL,?C_XBP+01H
00013B 759300     E    1793             MOV     DPX,#?C?XDATASEG
00013E E0              1794             MOVX    A,@DPTR
00013F F8              1795             MOV     R0,A
000140 A3              1796             INC     DPTR
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    30

000141 E0              1797             MOVX    A,@DPTR
000142 F9              1798             MOV     R1,A
000143 A3              1799             INC     DPTR
000144 E0              1800             MOVX    A,@DPTR
000145 FA              1801             MOV     R2,A
000146 A3              1802             INC     DPTR
000147 E0              1803             MOVX    A,@DPTR
000148 FB              1804             MOV     R3,A
000149 D3              1805             SETB    C
00014A 12000000   E    1806             LCALL   ?C?ULCMP
00014E 400B            1807             JC      ?C0016
000150                 1808     ?C0018:
                       1809     ;                               {
                       1810                             ; SOURCE LINE # 550
                       1811     ;                                       cShouldDelay = ( portCHAR ) pdTRUE;
                       1812                             ; SOURCE LINE # 551
000150                 1813     ?C0121:
000150 90000005        1814             MOV     DPTR,#05H
000154 12000000   E    1815             LCALL   ?C?XBPOFF
000158 7401            1816             MOV     A,#01H
00015A F0              1817             MOVX    @DPTR,A
                       1818     ;                               }
                       1819                             ; SOURCE LINE # 552
                       1820     ;                       }
                       1821                             ; SOURCE LINE # 553
00015B                 1822     ?C0016:
                       1823     ; 
                       1824     ;                       /* Update the wake time ready for the next call. */
                       1825     ;                       *pxPreviousWakeTime = xTimeToWake;
                       1826                             ; SOURCE LINE # 556
00015B 850083     E    1827             MOV     DPH,?C_XBP
00015E 850082     E    1828             MOV     DPL,?C_XBP+01H
000161 759300     E    1829             MOV     DPX,#?C?XDATASEG
000164 E0              1830             MOVX    A,@DPTR
000165 FC              1831             MOV     R4,A
000166 A3              1832             INC     DPTR
000167 E0              1833             MOVX    A,@DPTR
000168 FD              1834             MOV     R5,A
000169 A3              1835             INC     DPTR
00016A E0              1836             MOVX    A,@DPTR
00016B FE              1837             MOV     R6,A
00016C A3              1838             INC     DPTR
00016D E0              1839             MOVX    A,@DPTR
00016E FF              1840             MOV     R7,A
00016F 90000006        1841             MOV     DPTR,#06H
000173 12000000   E    1842             LCALL   ?C?XBPOFF
000177 E0              1843             MOVX    A,@DPTR
000178 FB              1844             MOV     R3,A
000179 A3              1845             INC     DPTR
00017A E0              1846             MOVX    A,@DPTR
00017B FA              1847             MOV     R2,A
00017C A3              1848             INC     DPTR
00017D E0              1849             MOVX    A,@DPTR
00017E F9              1850             MOV     R1,A
00017F 12000000   E    1851             LCALL   ?C?LSTPTR
                       1852     ; 
                       1853     ;                       if( cShouldDelay )
                       1854                             ; SOURCE LINE # 558
000183 90000005        1855             MOV     DPTR,#05H
000187 12000000   E    1856             LCALL   ?C?XBPOFF
00018B E0              1857             MOVX    A,@DPTR
00018C 7003            1858             JNZ     $ + 5H
00018E 010000     F    1859             AJMP    ?C0019
                       1860     ;                       {
                       1861                             ; SOURCE LINE # 559
                       1862     ;                               /* We must remove ourselves from the ready list before a
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    31

                               dding 
                       1863     ;                               ourselves to the blocked list as the same list item is u
                               sed for 
                       1864     ;                               both lists. */
                       1865     ;                               vListRemove( ( xListItem * ) &( pxCurrentTCB->xGenericLi
                               stItem ) );
                       1866                             ; SOURCE LINE # 563
000191 90000000   F    1867             MOV     DPTR,#pxCurrentTCB
000195 E0              1868             MOVX    A,@DPTR
000196 FB              1869             MOV     R3,A
000197 A3              1870             INC     DPTR
000198 E0              1871             MOVX    A,@DPTR
000199 FA              1872             MOV     R2,A
00019A A3              1873             INC     DPTR
00019B E0              1874             MOVX    A,@DPTR
00019C 2419            1875             ADD     A,#019H
00019E F9              1876             MOV     R1,A
00019F E4              1877             CLR     A
0001A0 3A              1878             ADDC    A,R2
0001A1 FA              1879             MOV     R2,A
0001A2 12000000   E    1880             LCALL   _?vListRemove
                       1881     ; 
                       1882     ;                               /* The list item will be inserted in wake time order. */
                       1883     ;                               listSET_LIST_ITEM_VALUE( &( pxCurrentTCB->xGenericListIt
                               em ), xTimeToWake );
                       1884                             ; SOURCE LINE # 566
0001A6 850083     E    1885             MOV     DPH,?C_XBP
0001A9 850082     E    1886             MOV     DPL,?C_XBP+01H
0001AC 759300     E    1887             MOV     DPX,#?C?XDATASEG
0001AF E0              1888             MOVX    A,@DPTR
0001B0 FC              1889             MOV     R4,A
0001B1 A3              1890             INC     DPTR
0001B2 E0              1891             MOVX    A,@DPTR
0001B3 FD              1892             MOV     R5,A
0001B4 A3              1893             INC     DPTR
0001B5 E0              1894             MOVX    A,@DPTR
0001B6 FE              1895             MOV     R6,A
0001B7 A3              1896             INC     DPTR
0001B8 E0              1897             MOVX    A,@DPTR
0001B9 FF              1898             MOV     R7,A
0001BA 90000000   F    1899             MOV     DPTR,#pxCurrentTCB
0001BE E0              1900             MOVX    A,@DPTR
0001BF FB              1901             MOV     R3,A
0001C0 A3              1902             INC     DPTR
0001C1 E0              1903             MOVX    A,@DPTR
0001C2 FA              1904             MOV     R2,A
0001C3 A3              1905             INC     DPTR
0001C4 E0              1906             MOVX    A,@DPTR
0001C5 2419            1907             ADD     A,#019H
0001C7 F9              1908             MOV     R1,A
0001C8 E4              1909             CLR     A
0001C9 3A              1910             ADDC    A,R2
0001CA FA              1911             MOV     R2,A
0001CB 12000000   E    1912             LCALL   ?C?LSTPTR
                       1913     ; 
                       1914     ;                               if( xTimeToWake < xTickCount )
                       1915                             ; SOURCE LINE # 568
0001CF 90000000   F    1916             MOV     DPTR,#xTickCount
0001D3 E0              1917             MOVX    A,@DPTR
0001D4 FC              1918             MOV     R4,A
0001D5 A3              1919             INC     DPTR
0001D6 E0              1920             MOVX    A,@DPTR
0001D7 FD              1921             MOV     R5,A
0001D8 A3              1922             INC     DPTR
0001D9 E0              1923             MOVX    A,@DPTR
0001DA FE              1924             MOV     R6,A
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    32

0001DB A3              1925             INC     DPTR
0001DC E0              1926             MOVX    A,@DPTR
0001DD FF              1927             MOV     R7,A
0001DE 850083     E    1928             MOV     DPH,?C_XBP
0001E1 850082     E    1929             MOV     DPL,?C_XBP+01H
0001E4 759300     E    1930             MOV     DPX,#?C?XDATASEG
0001E7 E0              1931             MOVX    A,@DPTR
0001E8 F8              1932             MOV     R0,A
0001E9 A3              1933             INC     DPTR
0001EA E0              1934             MOVX    A,@DPTR
0001EB F9              1935             MOV     R1,A
0001EC A3              1936             INC     DPTR
0001ED E0              1937             MOVX    A,@DPTR
0001EE FA              1938             MOV     R2,A
0001EF A3              1939             INC     DPTR
0001F0 E0              1940             MOVX    A,@DPTR
0001F1 FB              1941             MOV     R3,A
0001F2 C3              1942             CLR     C
0001F3 12000000   E    1943             LCALL   ?C?ULCMP
0001F7 90000000   F    1944             MOV     DPTR,#pxCurrentTCB
0001FB E0              1945             MOVX    A,@DPTR
0001FC FB              1946             MOV     R3,A
0001FD 5021            1947             JNC     ?C0020
                       1948     ;                               {
                       1949                             ; SOURCE LINE # 569
                       1950     ;                                       /* Wake time has overflowed.  Place this item in
                                the 
                       1951     ;                                       overflow list. */
                       1952     ;                                       vListInsert( ( xList * ) pxOverflowDelayedTaskLi
                               st, ( xListItem * ) &( pxCurrentTCB->xGenericListItem ) );
                       1953                             ; SOURCE LINE # 572
0001FF A3              1954             INC     DPTR
000200 E0              1955             MOVX    A,@DPTR
000201 FA              1956             MOV     R2,A
000202 A3              1957             INC     DPTR
000203 E0              1958             MOVX    A,@DPTR
000204 2419            1959             ADD     A,#019H
000206 F9              1960             MOV     R1,A
000207 E4              1961             CLR     A
000208 3A              1962             ADDC    A,R2
000209 FA              1963             MOV     R2,A
00020A 9000FFFD        1964             MOV     DPTR,#0FFFDH
00020E 12000000   E    1965             LCALL   ?C?ADDXBP
000212 EB              1966             MOV     A,R3
000213 F0              1967             MOVX    @DPTR,A
000214 A3              1968             INC     DPTR
000215 EA              1969             MOV     A,R2
000216 F0              1970             MOVX    @DPTR,A
000217 A3              1971             INC     DPTR
000218 E9              1972             MOV     A,R1
000219 F0              1973             MOVX    @DPTR,A
00021A 90000000   F    1974             MOV     DPTR,#pxOverflowDelayedTaskList
                       1975     ;                               }
                       1976                             ; SOURCE LINE # 573
00021E 801F            1977             SJMP    ?C0120
000220                 1978     ?C0020:
                       1979     ;                               else
                       1980     ;                               {
                       1981                             ; SOURCE LINE # 575
                       1982     ;                                       /* The wake time has not overflowed, so we can u
                               se the 
                       1983     ;                                       current block list. */
                       1984     ;                                       vListInsert( ( xList * ) pxDelayedTaskList, ( xL
                               istItem * ) &( pxCurrentTCB->xGenericListItem ) );
                       1985                             ; SOURCE LINE # 578
000220 A3              1986             INC     DPTR
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    33

000221 E0              1987             MOVX    A,@DPTR
000222 FA              1988             MOV     R2,A
000223 A3              1989             INC     DPTR
000224 E0              1990             MOVX    A,@DPTR
000225 2419            1991             ADD     A,#019H
000227 F9              1992             MOV     R1,A
000228 E4              1993             CLR     A
000229 3A              1994             ADDC    A,R2
00022A FA              1995             MOV     R2,A
00022B 9000FFFD        1996             MOV     DPTR,#0FFFDH
00022F 12000000   E    1997             LCALL   ?C?ADDXBP
000233 EB              1998             MOV     A,R3
000234 F0              1999             MOVX    @DPTR,A
000235 A3              2000             INC     DPTR
000236 EA              2001             MOV     A,R2
000237 F0              2002             MOVX    @DPTR,A
000238 A3              2003             INC     DPTR
000239 E9              2004             MOV     A,R1
00023A F0              2005             MOVX    @DPTR,A
00023B 90000000   F    2006             MOV     DPTR,#pxDelayedTaskList
00023F                 2007     ?C0120:
00023F E0              2008             MOVX    A,@DPTR
000240 FB              2009             MOV     R3,A
000241 A3              2010             INC     DPTR
000242 E0              2011             MOVX    A,@DPTR
000243 FA              2012             MOV     R2,A
000244 A3              2013             INC     DPTR
000245 E0              2014             MOVX    A,@DPTR
000246 F9              2015             MOV     R1,A
000247 12000000   E    2016             LCALL   _?vListInsert
                       2017     ;                               }
                       2018                             ; SOURCE LINE # 579
                       2019     ;                       }
                       2020                             ; SOURCE LINE # 580
00024B                 2021     ?C0019:
                       2022     ;               }
                       2023                             ; SOURCE LINE # 581
                       2024     ;               cAlreadyYielded = cTaskResumeAll();
                       2025                             ; SOURCE LINE # 582
00024B 12000000   F    2026             LCALL   _?cTaskResumeAll
00024F 90000004        2027             MOV     DPTR,#04H
000253 12000000   E    2028             LCALL   ?C?XBPOFF
000257 EF              2029             MOV     A,R7
000258 F0              2030             MOVX    @DPTR,A
                       2031     ; 
                       2032     ;               /* Force a reschedule if cTaskResumeAll has not already done so, we may 
                       2033     ;               have put ourselves to sleep. */
                       2034     ;               if( !cAlreadyYielded )
                       2035                             ; SOURCE LINE # 586
000259 90000004        2036             MOV     DPTR,#04H
00025D 12000000   E    2037             LCALL   ?C?XBPOFF
000261 E0              2038             MOVX    A,@DPTR
000262 7004            2039             JNZ     ?C0023
                       2040     ;               {
                       2041                             ; SOURCE LINE # 587
                       2042     ;                       taskYIELD(); 
                       2043                             ; SOURCE LINE # 588
000264 12000000   E    2044             LCALL   _?vPortYield
                       2045     ;               }
                       2046                             ; SOURCE LINE # 589
                       2047     ;       }
                       2048                             ; SOURCE LINE # 590
000268                 2049     ?C0023:
000268 9000000D        2050             MOV     DPTR,#0DH
00026C 02000000   E    2051             LJMP    ?C?ADDXBP
                       2052     ; END OF _?vTaskDelayUntil
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    34

                       2053     
                       2054     ; #endif
                       2055     ; /*-----------------------------------------------------------*/
                       2056     ; 
                       2057     ; #if( INCLUDE_vTaskDelay == 1 )
                       2058     ;       void vTaskDelay( portTickType xTicksToDelay ) reentrant
                       2059     
------                 2060             RSEG  ?PR?_?vTaskDelay?TASKS
000000                 2061     _?vTaskDelay:
                       2062             USING   0
                       2063                             ; SOURCE LINE # 595
000000 9000FFFC        2064             MOV     DPTR,#0FFFCH
000004 12000000   E    2065             LCALL   ?C?ADDXBP
000008 12000000   E    2066             LCALL   ?C?LSTXDATA
00000C 9000FFFB        2067             MOV     DPTR,#0FFFBH
000010 12000000   E    2068             LCALL   ?C?ADDXBP
                       2069     ;       {
                       2070     ;       portTickType xTimeToWake;
                       2071     ;       signed portCHAR cAlreadyYielded = pdFALSE;
                       2072                             ; SOURCE LINE # 598
000014 90000004        2073             MOV     DPTR,#04H
000018 12000000   E    2074             LCALL   ?C?XBPOFF
00001C E4              2075             CLR     A
00001D F0              2076             MOVX    @DPTR,A
                       2077     ; 
                       2078     ;               /* A delay time of zero just forces a reschedule. */
                       2079     ;               if( xTicksToDelay > ( portTickType ) 0 )
                       2080                             ; SOURCE LINE # 601
00001E FF              2081             MOV     R7,A
00001F FE              2082             MOV     R6,A
000020 FD              2083             MOV     R5,A
000021 FC              2084             MOV     R4,A
000022 90000005        2085             MOV     DPTR,#05H
000026 12000000   E    2086             LCALL   ?C?XBPOFF
00002A E0              2087             MOVX    A,@DPTR
00002B F8              2088             MOV     R0,A
00002C A3              2089             INC     DPTR
00002D E0              2090             MOVX    A,@DPTR
00002E F9              2091             MOV     R1,A
00002F A3              2092             INC     DPTR
000030 E0              2093             MOVX    A,@DPTR
000031 FA              2094             MOV     R2,A
000032 A3              2095             INC     DPTR
000033 E0              2096             MOVX    A,@DPTR
000034 FB              2097             MOV     R3,A
000035 D3              2098             SETB    C
000036 12000000   E    2099             LCALL   ?C?ULCMP
00003A 5003            2100             JNC     $ + 5H
00003C 010000     F    2101             AJMP    ?C0024
                       2102     ;               {
                       2103                             ; SOURCE LINE # 602
                       2104     ;                       vTaskSuspendAll();
                       2105                             ; SOURCE LINE # 603
00003F 12000000   F    2106             LCALL   _?vTaskSuspendAll
                       2107     ;                       {
                       2108                             ; SOURCE LINE # 604
                       2109     ;                               /* A task that is removed from the event list while the 
                       2110     ;                               scheduler is suspended will not get placed in the ready 
                       2111     ;                               list or removed from the blocked list until the schedule
                               r 
                       2112     ;                               is resumed.  
                       2113     ;                               
                       2114     ;                               This task cannot be in an event list as it is the curren
                               tly 
                       2115     ;                               executing task. */
                       2116     ; 
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    35

                       2117     ;                               /* Calculate the time to wake - this may overflow but th
                               is is 
                       2118     ;                               not a problem. */
                       2119     ;                               xTimeToWake = xTickCount + xTicksToDelay;
                       2120                             ; SOURCE LINE # 615
000043 90000005        2121             MOV     DPTR,#05H
000047 12000000   E    2122             LCALL   ?C?XBPOFF
00004B E0              2123             MOVX    A,@DPTR
00004C FC              2124             MOV     R4,A
00004D A3              2125             INC     DPTR
00004E E0              2126             MOVX    A,@DPTR
00004F FD              2127             MOV     R5,A
000050 A3              2128             INC     DPTR
000051 E0              2129             MOVX    A,@DPTR
000052 FE              2130             MOV     R6,A
000053 A3              2131             INC     DPTR
000054 E0              2132             MOVX    A,@DPTR
000055 FF              2133             MOV     R7,A
000056 90000000   F    2134             MOV     DPTR,#xTickCount
00005A E0              2135             MOVX    A,@DPTR
00005B F8              2136             MOV     R0,A
00005C A3              2137             INC     DPTR
00005D E0              2138             MOVX    A,@DPTR
00005E F9              2139             MOV     R1,A
00005F A3              2140             INC     DPTR
000060 E0              2141             MOVX    A,@DPTR
000061 FA              2142             MOV     R2,A
000062 A3              2143             INC     DPTR
000063 E0              2144             MOVX    A,@DPTR
000064 2F              2145             ADD     A,R7
000065 FF              2146             MOV     R7,A
000066 EA              2147             MOV     A,R2
000067 3E              2148             ADDC    A,R6
000068 FE              2149             MOV     R6,A
000069 E9              2150             MOV     A,R1
00006A 3D              2151             ADDC    A,R5
00006B FD              2152             MOV     R5,A
00006C E8              2153             MOV     A,R0
00006D 3C              2154             ADDC    A,R4
00006E FC              2155             MOV     R4,A
00006F 850083     E    2156             MOV     DPH,?C_XBP
000072 850082     E    2157             MOV     DPL,?C_XBP+01H
000075 759300     E    2158             MOV     DPX,#?C?XDATASEG
000078 12000000   E    2159             LCALL   ?C?LSTXDATA
                       2160     ; 
                       2161     ;                               /* We must remove ourselves from the ready list before a
                               dding 
                       2162     ;                               ourselves to the blocked list as the same list item is u
                               sed for 
                       2163     ;                               both lists. */
                       2164     ;                               vListRemove( ( xListItem * ) &( pxCurrentTCB->xGenericLi
                               stItem ) );
                       2165                             ; SOURCE LINE # 620
00007C 90000000   F    2166             MOV     DPTR,#pxCurrentTCB
000080 E0              2167             MOVX    A,@DPTR
000081 FB              2168             MOV     R3,A
000082 A3              2169             INC     DPTR
000083 E0              2170             MOVX    A,@DPTR
000084 FA              2171             MOV     R2,A
000085 A3              2172             INC     DPTR
000086 E0              2173             MOVX    A,@DPTR
000087 2419            2174             ADD     A,#019H
000089 F9              2175             MOV     R1,A
00008A E4              2176             CLR     A
00008B 3A              2177             ADDC    A,R2
00008C FA              2178             MOV     R2,A
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    36

00008D 12000000   E    2179             LCALL   _?vListRemove
                       2180     ; 
                       2181     ;                               /* The list item will be inserted in wake time order. */
                       2182     ;                               listSET_LIST_ITEM_VALUE( &( pxCurrentTCB->xGenericListIt
                               em ), xTimeToWake );
                       2183                             ; SOURCE LINE # 623
000091 850083     E    2184             MOV     DPH,?C_XBP
000094 850082     E    2185             MOV     DPL,?C_XBP+01H
000097 759300     E    2186             MOV     DPX,#?C?XDATASEG
00009A E0              2187             MOVX    A,@DPTR
00009B FC              2188             MOV     R4,A
00009C A3              2189             INC     DPTR
00009D E0              2190             MOVX    A,@DPTR
00009E FD              2191             MOV     R5,A
00009F A3              2192             INC     DPTR
0000A0 E0              2193             MOVX    A,@DPTR
0000A1 FE              2194             MOV     R6,A
0000A2 A3              2195             INC     DPTR
0000A3 E0              2196             MOVX    A,@DPTR
0000A4 FF              2197             MOV     R7,A
0000A5 90000000   F    2198             MOV     DPTR,#pxCurrentTCB
0000A9 E0              2199             MOVX    A,@DPTR
0000AA FB              2200             MOV     R3,A
0000AB A3              2201             INC     DPTR
0000AC E0              2202             MOVX    A,@DPTR
0000AD FA              2203             MOV     R2,A
0000AE A3              2204             INC     DPTR
0000AF E0              2205             MOVX    A,@DPTR
0000B0 2419            2206             ADD     A,#019H
0000B2 F9              2207             MOV     R1,A
0000B3 E4              2208             CLR     A
0000B4 3A              2209             ADDC    A,R2
0000B5 FA              2210             MOV     R2,A
0000B6 12000000   E    2211             LCALL   ?C?LSTPTR
                       2212     ; 
                       2213     ;                               if( xTimeToWake < xTickCount )
                       2214                             ; SOURCE LINE # 625
0000BA 90000000   F    2215             MOV     DPTR,#xTickCount
0000BE E0              2216             MOVX    A,@DPTR
0000BF FC              2217             MOV     R4,A
0000C0 A3              2218             INC     DPTR
0000C1 E0              2219             MOVX    A,@DPTR
0000C2 FD              2220             MOV     R5,A
0000C3 A3              2221             INC     DPTR
0000C4 E0              2222             MOVX    A,@DPTR
0000C5 FE              2223             MOV     R6,A
0000C6 A3              2224             INC     DPTR
0000C7 E0              2225             MOVX    A,@DPTR
0000C8 FF              2226             MOV     R7,A
0000C9 850083     E    2227             MOV     DPH,?C_XBP
0000CC 850082     E    2228             MOV     DPL,?C_XBP+01H
0000CF 759300     E    2229             MOV     DPX,#?C?XDATASEG
0000D2 E0              2230             MOVX    A,@DPTR
0000D3 F8              2231             MOV     R0,A
0000D4 A3              2232             INC     DPTR
0000D5 E0              2233             MOVX    A,@DPTR
0000D6 F9              2234             MOV     R1,A
0000D7 A3              2235             INC     DPTR
0000D8 E0              2236             MOVX    A,@DPTR
0000D9 FA              2237             MOV     R2,A
0000DA A3              2238             INC     DPTR
0000DB E0              2239             MOVX    A,@DPTR
0000DC FB              2240             MOV     R3,A
0000DD C3              2241             CLR     C
0000DE 12000000   E    2242             LCALL   ?C?ULCMP
0000E2 90000000   F    2243             MOV     DPTR,#pxCurrentTCB
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    37

0000E6 E0              2244             MOVX    A,@DPTR
0000E7 FB              2245             MOV     R3,A
0000E8 5021            2246             JNC     ?C0025
                       2247     ;                               {
                       2248                             ; SOURCE LINE # 626
                       2249     ;                                       /* Wake time has overflowed.  Place this item in
                                the 
                       2250     ;                                       overflow list. */
                       2251     ;                                       vListInsert( ( xList * ) pxOverflowDelayedTaskLi
                               st, ( xListItem * ) &( pxCurrentTCB->xGenericListItem ) );
                       2252                             ; SOURCE LINE # 629
0000EA A3              2253             INC     DPTR
0000EB E0              2254             MOVX    A,@DPTR
0000EC FA              2255             MOV     R2,A
0000ED A3              2256             INC     DPTR
0000EE E0              2257             MOVX    A,@DPTR
0000EF 2419            2258             ADD     A,#019H
0000F1 F9              2259             MOV     R1,A
0000F2 E4              2260             CLR     A
0000F3 3A              2261             ADDC    A,R2
0000F4 FA              2262             MOV     R2,A
0000F5 9000FFFD        2263             MOV     DPTR,#0FFFDH
0000F9 12000000   E    2264             LCALL   ?C?ADDXBP
0000FD EB              2265             MOV     A,R3
0000FE F0              2266             MOVX    @DPTR,A
0000FF A3              2267             INC     DPTR
000100 EA              2268             MOV     A,R2
000101 F0              2269             MOVX    @DPTR,A
000102 A3              2270             INC     DPTR
000103 E9              2271             MOV     A,R1
000104 F0              2272             MOVX    @DPTR,A
000105 90000000   F    2273             MOV     DPTR,#pxOverflowDelayedTaskList
                       2274     ;                               }
                       2275                             ; SOURCE LINE # 630
000109 801F            2276             SJMP    ?C0122
00010B                 2277     ?C0025:
                       2278     ;                               else
                       2279     ;                               {
                       2280                             ; SOURCE LINE # 632
                       2281     ;                                       /* The wake time has not overflowed, so we can u
                               se the 
                       2282     ;                                       current block list. */
                       2283     ;                                       vListInsert( ( xList * ) pxDelayedTaskList, ( xL
                               istItem * ) &( pxCurrentTCB->xGenericListItem ) );
                       2284                             ; SOURCE LINE # 635
00010B A3              2285             INC     DPTR
00010C E0              2286             MOVX    A,@DPTR
00010D FA              2287             MOV     R2,A
00010E A3              2288             INC     DPTR
00010F E0              2289             MOVX    A,@DPTR
000110 2419            2290             ADD     A,#019H
000112 F9              2291             MOV     R1,A
000113 E4              2292             CLR     A
000114 3A              2293             ADDC    A,R2
000115 FA              2294             MOV     R2,A
000116 9000FFFD        2295             MOV     DPTR,#0FFFDH
00011A 12000000   E    2296             LCALL   ?C?ADDXBP
00011E EB              2297             MOV     A,R3
00011F F0              2298             MOVX    @DPTR,A
000120 A3              2299             INC     DPTR
000121 EA              2300             MOV     A,R2
000122 F0              2301             MOVX    @DPTR,A
000123 A3              2302             INC     DPTR
000124 E9              2303             MOV     A,R1
000125 F0              2304             MOVX    @DPTR,A
000126 90000000   F    2305             MOV     DPTR,#pxDelayedTaskList
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    38

00012A                 2306     ?C0122:
00012A E0              2307             MOVX    A,@DPTR
00012B FB              2308             MOV     R3,A
00012C A3              2309             INC     DPTR
00012D E0              2310             MOVX    A,@DPTR
00012E FA              2311             MOV     R2,A
00012F A3              2312             INC     DPTR
000130 E0              2313             MOVX    A,@DPTR
000131 F9              2314             MOV     R1,A
000132 12000000   E    2315             LCALL   _?vListInsert
                       2316     ;                               }
                       2317                             ; SOURCE LINE # 636
000136                 2318     ?C0026:
                       2319     ;                       }
                       2320                             ; SOURCE LINE # 637
                       2321     ;                       cAlreadyYielded = cTaskResumeAll();
                       2322                             ; SOURCE LINE # 638
000136 12000000   F    2323             LCALL   _?cTaskResumeAll
00013A 90000004        2324             MOV     DPTR,#04H
00013E 12000000   E    2325             LCALL   ?C?XBPOFF
000142 EF              2326             MOV     A,R7
000143 F0              2327             MOVX    @DPTR,A
                       2328     ;               }
                       2329                             ; SOURCE LINE # 639
000144                 2330     ?C0024:
                       2331     ;               
                       2332     ;               /* Force a reschedule if cTaskResumeAll has not already done so, we may 
                       2333     ;               have put ourselves to sleep. */
                       2334     ;               if( !cAlreadyYielded )
                       2335                             ; SOURCE LINE # 643
000144 90000004        2336             MOV     DPTR,#04H
000148 12000000   E    2337             LCALL   ?C?XBPOFF
00014C E0              2338             MOVX    A,@DPTR
00014D 7004            2339             JNZ     ?C0028
                       2340     ;               {
                       2341                             ; SOURCE LINE # 644
                       2342     ;                       taskYIELD(); 
                       2343                             ; SOURCE LINE # 645
00014F 12000000   E    2344             LCALL   _?vPortYield
                       2345     ;               }
                       2346                             ; SOURCE LINE # 646
                       2347     ;       }
                       2348                             ; SOURCE LINE # 647
000153                 2349     ?C0028:
000153 90000009        2350             MOV     DPTR,#09H
000157 02000000   E    2351             LJMP    ?C?ADDXBP
                       2352     ; END OF _?vTaskDelay
                       2353     
                       2354     ; #endif
                       2355     ; /*-----------------------------------------------------------*/
                       2356     ; 
                       2357     ; #if( INCLUDE_ucTaskPriorityGet == 1 )
                       2358     ; 
                       2359     ;       unsigned portCHAR ucTaskPriorityGet( xTaskHandle pxTask ) reentrant
                       2360     ;       {
                       2361     ;       tskTCB *pxTCB;
                       2362     ;       unsigned portCHAR ucReturn;
                       2363     ; 
                       2364     ;               taskENTER_CRITICAL();
                       2365     ;               {
                       2366     ;                       /* If null is passed in here then we are changing the
                       2367     ;                       priority of the calling function. */
                       2368     ;                       pxTCB = prvGetTCBFromHandle( pxTask );
                       2369     ;                       ucReturn = pxTCB->ucPriority;
                       2370     ;               }
                       2371     ;               taskEXIT_CRITICAL();
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    39

                       2372     ; 
                       2373     ;               return ucReturn;
                       2374     ;       }
                       2375     ; 
                       2376     ; #endif
                       2377     ; /*-----------------------------------------------------------*/
                       2378     ; 
                       2379     ; #if( INCLUDE_vTaskPrioritySet == 1 )
                       2380     ; 
                       2381     ;       void vTaskPrioritySet( xTaskHandle pxTask, unsigned portCHAR ucNewPriority ) ree
                               ntrant
                       2382     ;       {
                       2383     ;       tskTCB *pxTCB;
                       2384     ;       unsigned portCHAR ucCurrentPriority;
                       2385     ; 
                       2386     ;               /* Ensure the new priority is valid. */
                       2387     ;               if( ucNewPriority >= portMAX_PRIORITIES )
                       2388     ;               {
                       2389     ;                       ucNewPriority = portMAX_PRIORITIES - ( unsigned portCHAR ) 1;
                       2390     ;               }
                       2391     ; 
                       2392     ;               taskENTER_CRITICAL();
                       2393     ;               {
                       2394     ;                       /* If null is passed in here then we are changing the
                       2395     ;                       priority of the calling function. */
                       2396     ;                       pxTCB = prvGetTCBFromHandle( pxTask );
                       2397     ;                       ucCurrentPriority = pxTCB->ucPriority;
                       2398     ; 
                       2399     ;                       if( ucCurrentPriority != ucNewPriority )
                       2400     ;                       {
                       2401     ;                               pxTCB->ucPriority = ucNewPriority;
                       2402     ; 
                       2403     ;                               /* If the task is in the blocked or suspended list we ne
                               ed do 
                       2404     ;                               nothing more than change it's priority variable. However
                               , if 
                       2405     ;                               the task is in a ready list it needs to be removed and p
                               laced 
                       2406     ;                               in the queue appropriate to its new priority. */
                       2407     ;                               if( listIS_CONTAINED_WITHIN( &( pxReadyTasksLists[ ucCur
                               rentPriority ] ), &( pxTCB->xGenericListItem ) ) )
                       2408     ;                               {
                       2409     ;                                       /* The task is currently in its ready list - rem
                               ove before adding
                       2410     ;                                       it to it's new ready list. */
                       2411     ;                                       vListRemove( &( pxTCB->xGenericListItem ) );
                       2412     ;                                       prvAddTaskToReadyQueue( pxTCB );
                       2413     ;                               }                       
                       2414     ;                       }
                       2415     ;               }
                       2416     ;               taskEXIT_CRITICAL();
                       2417     ; 
                       2418     ;               /* The priority change may have readied a task of higher
                       2419     ;               priority than the calling task. */
                       2420     ;               taskYIELD();
                       2421     ;       }
                       2422     ; 
                       2423     ; #endif
                       2424     ; /*-----------------------------------------------------------*/
                       2425     ; 
                       2426     ; #if( INCLUDE_vTaskSuspend == 1 )
                       2427     ; 
                       2428     ;       void vTaskSuspend( xTaskHandle pxTaskToSuspend ) reentrant
                       2429     
------                 2430             RSEG  ?PR?_?vTaskSuspend?TASKS
000000                 2431     _?vTaskSuspend:
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    40

                       2432             USING   0
                       2433                             ; SOURCE LINE # 722
000000 9000FFFD        2434             MOV     DPTR,#0FFFDH
000004 12000000   E    2435             LCALL   ?C?ADDXBP
000008 EB              2436             MOV     A,R3
000009 F0              2437             MOVX    @DPTR,A
00000A A3              2438             INC     DPTR
00000B EA              2439             MOV     A,R2
00000C F0              2440             MOVX    @DPTR,A
00000D A3              2441             INC     DPTR
00000E E9              2442             MOV     A,R1
00000F F0              2443             MOVX    @DPTR,A
000010 9000FFFD        2444             MOV     DPTR,#0FFFDH
000014 12000000   E    2445             LCALL   ?C?ADDXBP
                       2446     ;       {
                       2447     ;       tskTCB *pxTCB;
000018 A2AFC2AF        2448              DB 0A2H, 0AFH, 0C2H, 0AFH, 0C0H, 0D0H;
00001C C0D0                     
                       2449     ; 
                       2450     ;               taskENTER_CRITICAL();
                       2451     ;               {
                       2452                             ; SOURCE LINE # 727
                       2453     ;                       /* If null is passed in here then we are suspending ourselves. *
                               /
                       2454     ;                       pxTCB = prvGetTCBFromHandle( pxTaskToSuspend );
                       2455                             ; SOURCE LINE # 729
00001E 90000003        2456             MOV     DPTR,#03H
000022 12000000   E    2457             LCALL   ?C?XBPOFF
000026 E0              2458             MOVX    A,@DPTR
000027 FB              2459             MOV     R3,A
000028 A3              2460             INC     DPTR
000029 E0              2461             MOVX    A,@DPTR
00002A FA              2462             MOV     R2,A
00002B A3              2463             INC     DPTR
00002C E0              2464             MOVX    A,@DPTR
00002D 4A              2465             ORL     A,R2
00002E 4B              2466             ORL     A,R3
00002F 700E            2467             JNZ     ?C0029
000031 90000000   F    2468             MOV     DPTR,#pxCurrentTCB
000035 E0              2469             MOVX    A,@DPTR
000036 FB              2470             MOV     R3,A
000037 A3              2471             INC     DPTR
000038 E0              2472             MOVX    A,@DPTR
000039 FA              2473             MOV     R2,A
00003A A3              2474             INC     DPTR
00003B E0              2475             MOVX    A,@DPTR
00003C F9              2476             MOV     R1,A
00003D 8010            2477             SJMP    ?C0030
00003F                 2478     ?C0029:
00003F 90000003        2479             MOV     DPTR,#03H
000043 12000000   E    2480             LCALL   ?C?XBPOFF
000047 E0              2481             MOVX    A,@DPTR
000048 FB              2482             MOV     R3,A
000049 A3              2483             INC     DPTR
00004A E0              2484             MOVX    A,@DPTR
00004B FA              2485             MOV     R2,A
00004C A3              2486             INC     DPTR
00004D E0              2487             MOVX    A,@DPTR
00004E F9              2488             MOV     R1,A
00004F                 2489     ?C0030:
00004F 850083     E    2490             MOV     DPH,?C_XBP
000052 850082     E    2491             MOV     DPL,?C_XBP+01H
000055 759300     E    2492             MOV     DPX,#?C?XDATASEG
000058 EB              2493             MOV     A,R3
000059 F0              2494             MOVX    @DPTR,A
00005A A3              2495             INC     DPTR
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    41

00005B EA              2496             MOV     A,R2
00005C F0              2497             MOVX    @DPTR,A
00005D A3              2498             INC     DPTR
00005E E9              2499             MOV     A,R1
00005F F0              2500             MOVX    @DPTR,A
                       2501     ; 
                       2502     ;                       /* Remove task from the ready/delayed list and place in the     
                               suspended list. */
                       2503     ;                       vListRemove( &( pxTCB->xGenericListItem ) );
                       2504                             ; SOURCE LINE # 732
000060 850083     E    2505             MOV     DPH,?C_XBP
000063 850082     E    2506             MOV     DPL,?C_XBP+01H
000066 759300     E    2507             MOV     DPX,#?C?XDATASEG
000069 E0              2508             MOVX    A,@DPTR
00006A FB              2509             MOV     R3,A
00006B A3              2510             INC     DPTR
00006C E0              2511             MOVX    A,@DPTR
00006D FA              2512             MOV     R2,A
00006E A3              2513             INC     DPTR
00006F E0              2514             MOVX    A,@DPTR
000070 2419            2515             ADD     A,#019H
000072 F9              2516             MOV     R1,A
000073 E4              2517             CLR     A
000074 3A              2518             ADDC    A,R2
000075 FA              2519             MOV     R2,A
000076 12000000   E    2520             LCALL   _?vListRemove
                       2521     ; 
                       2522     ;                       /* Is the task waiting on an event also? */                     
                                                                                                       
                       2523     ;                       if( pxTCB->xEventListItem.pvContainer )
                       2524                             ; SOURCE LINE # 735
00007A 850083     E    2525             MOV     DPH,?C_XBP
00007D 850082     E    2526             MOV     DPL,?C_XBP+01H
000080 759300     E    2527             MOV     DPX,#?C?XDATASEG
000083 E0              2528             MOVX    A,@DPTR
000084 FB              2529             MOV     R3,A
000085 A3              2530             INC     DPTR
000086 E0              2531             MOVX    A,@DPTR
000087 FA              2532             MOV     R2,A
000088 A3              2533             INC     DPTR
000089 E0              2534             MOVX    A,@DPTR
00008A 2436            2535             ADD     A,#036H
00008C F9              2536             MOV     R1,A
00008D E4              2537             CLR     A
00008E 3A              2538             ADDC    A,R2
00008F FA              2539             MOV     R2,A
000090 12000000   E    2540             LCALL   ?C?PLDPTR
000094 EA              2541             MOV     A,R2
000095 49              2542             ORL     A,R1
000096 4B              2543             ORL     A,R3
000097 601A            2544             JZ      ?C0031
                       2545     ;                       {
                       2546                             ; SOURCE LINE # 736
                       2547     ;                               vListRemove( &( pxTCB->xEventListItem ) );
                       2548                             ; SOURCE LINE # 737
000099 850083     E    2549             MOV     DPH,?C_XBP
00009C 850082     E    2550             MOV     DPL,?C_XBP+01H
00009F 759300     E    2551             MOV     DPX,#?C?XDATASEG
0000A2 E0              2552             MOVX    A,@DPTR
0000A3 FB              2553             MOV     R3,A
0000A4 A3              2554             INC     DPTR
0000A5 E0              2555             MOVX    A,@DPTR
0000A6 FA              2556             MOV     R2,A
0000A7 A3              2557             INC     DPTR
0000A8 E0              2558             MOVX    A,@DPTR
0000A9 2429            2559             ADD     A,#029H
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    42

0000AB F9              2560             MOV     R1,A
0000AC E4              2561             CLR     A
0000AD 3A              2562             ADDC    A,R2
0000AE FA              2563             MOV     R2,A
0000AF 12000000   E    2564             LCALL   _?vListRemove
                       2565     ;                       }
                       2566                             ; SOURCE LINE # 738
0000B3                 2567     ?C0031:
                       2568     ; 
                       2569     ;                       vListInsertEnd( ( xList * ) &xSuspendedTaskList, &( pxTCB->xGene
                               ricListItem ) );
                       2570                             ; SOURCE LINE # 740
0000B3 850083     E    2571             MOV     DPH,?C_XBP
0000B6 850082     E    2572             MOV     DPL,?C_XBP+01H
0000B9 759300     E    2573             MOV     DPX,#?C?XDATASEG
0000BC E0              2574             MOVX    A,@DPTR
0000BD FB              2575             MOV     R3,A
0000BE A3              2576             INC     DPTR
0000BF E0              2577             MOVX    A,@DPTR
0000C0 FA              2578             MOV     R2,A
0000C1 A3              2579             INC     DPTR
0000C2 E0              2580             MOVX    A,@DPTR
0000C3 2419            2581             ADD     A,#019H
0000C5 F9              2582             MOV     R1,A
0000C6 E4              2583             CLR     A
0000C7 3A              2584             ADDC    A,R2
0000C8 FA              2585             MOV     R2,A
0000C9 9000FFFD        2586             MOV     DPTR,#0FFFDH
0000CD 12000000   E    2587             LCALL   ?C?ADDXBP
0000D1 EB              2588             MOV     A,R3
0000D2 F0              2589             MOVX    @DPTR,A
0000D3 A3              2590             INC     DPTR
0000D4 EA              2591             MOV     A,R2
0000D5 F0              2592             MOVX    @DPTR,A
0000D6 A3              2593             INC     DPTR
0000D7 E9              2594             MOV     A,R1
0000D8 F0              2595             MOVX    @DPTR,A
0000D9 7B00       F    2596             MOV     R3,#MBYTE (xSuspendedTaskList)
0000DB 7A00       F    2597             MOV     R2,#HIGH (xSuspendedTaskList)
0000DD 7900       F    2598             MOV     R1,#LOW (xSuspendedTaskList)
0000DF 12000000   E    2599             LCALL   _?vListInsertEnd
                       2600     ;               }
                       2601                             ; SOURCE LINE # 741
                       2602     ;               taskEXIT_CRITICAL();
0000E3 D0D092AF        2603              DB 0D0H, 0D0H, 092H, 0AFH;
                       2604     ; 
                       2605     ;               /* We may have just suspended the current task. */
                       2606     ;               if( ( void * ) pxTaskToSuspend == NULL )
                       2607                             ; SOURCE LINE # 745
0000E7 90000003        2608             MOV     DPTR,#03H
0000EB 12000000   E    2609             LCALL   ?C?XBPOFF
0000EF E0              2610             MOVX    A,@DPTR
0000F0 FB              2611             MOV     R3,A
0000F1 A3              2612             INC     DPTR
0000F2 E0              2613             MOVX    A,@DPTR
0000F3 FA              2614             MOV     R2,A
0000F4 A3              2615             INC     DPTR
0000F5 E0              2616             MOVX    A,@DPTR
0000F6 4A              2617             ORL     A,R2
0000F7 4B              2618             ORL     A,R3
0000F8 7004            2619             JNZ     ?C0033
                       2620     ;               {
                       2621                             ; SOURCE LINE # 746
                       2622     ;                       taskYIELD();
                       2623                             ; SOURCE LINE # 747
0000FA 12000000   E    2624             LCALL   _?vPortYield
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    43

                       2625     ;               }
                       2626                             ; SOURCE LINE # 748
                       2627     ;       }
                       2628                             ; SOURCE LINE # 749
0000FE                 2629     ?C0033:
0000FE 90000006        2630             MOV     DPTR,#06H
000102 02000000   E    2631             LJMP    ?C?ADDXBP
                       2632     ; END OF _?vTaskSuspend
                       2633     
                       2634     ; 
                       2635     ; #endif
                       2636     ; /*-----------------------------------------------------------*/
                       2637     ; 
                       2638     ; #if( INCLUDE_vTaskSuspend == 1 )
                       2639     ; 
                       2640     ;       void vTaskResume( xTaskHandle pxTaskToResume )reentrant
                       2641     
------                 2642             RSEG  ?PR?_?vTaskResume?TASKS
000000                 2643     _?vTaskResume:
                       2644             USING   0
                       2645                             ; SOURCE LINE # 756
000000 9000FFFD        2646             MOV     DPTR,#0FFFDH
000004 12000000   E    2647             LCALL   ?C?ADDXBP
000008 EB              2648             MOV     A,R3
000009 F0              2649             MOVX    @DPTR,A
00000A A3              2650             INC     DPTR
00000B EA              2651             MOV     A,R2
00000C F0              2652             MOVX    @DPTR,A
00000D A3              2653             INC     DPTR
00000E E9              2654             MOV     A,R1
00000F F0              2655             MOVX    @DPTR,A
000010 9000FFFB        2656             MOV     DPTR,#0FFFBH
000014 12000000   E    2657             LCALL   ?C?ADDXBP
                       2658     ;       {
                       2659     ;       tskTCB *pxTCB;
                       2660     ;       portSHORT sYieldRequired;
                       2661     ; 
                       2662     ;               /* Remove the task from whichever list it is currently in, and place
                       2663     ;               it in the ready list. */
                       2664     ;               pxTCB = ( tskTCB * ) pxTaskToResume;
                       2665                             ; SOURCE LINE # 763
000018 90000005        2666             MOV     DPTR,#05H
00001C 12000000   E    2667             LCALL   ?C?XBPOFF
000020 E0              2668             MOVX    A,@DPTR
000021 F9              2669             MOV     R1,A
000022 A3              2670             INC     DPTR
000023 E0              2671             MOVX    A,@DPTR
000024 FA              2672             MOV     R2,A
000025 A3              2673             INC     DPTR
000026 E0              2674             MOVX    A,@DPTR
000027 850083     E    2675             MOV     DPH,?C_XBP
00002A 850082     E    2676             MOV     DPL,?C_XBP+01H
00002D 759300     E    2677             MOV     DPX,#?C?XDATASEG
000030 C9              2678             XCH     A,R1
000031 F0              2679             MOVX    @DPTR,A
000032 A3              2680             INC     DPTR
000033 EA              2681             MOV     A,R2
000034 F0              2682             MOVX    @DPTR,A
000035 A3              2683             INC     DPTR
000036 E9              2684             MOV     A,R1
000037 F0              2685             MOVX    @DPTR,A
                       2686     ; 
                       2687     ;               /* The parameter cannot be NULL as it is impossible to resume the
                       2688     ;               currently executing task. */
                       2689     ;               if( pxTCB != NULL )
                       2690                             ; SOURCE LINE # 767
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    44

000038 850083     E    2691             MOV     DPH,?C_XBP
00003B 850082     E    2692             MOV     DPL,?C_XBP+01H
00003E 759300     E    2693             MOV     DPX,#?C?XDATASEG
000041 E0              2694             MOVX    A,@DPTR
000042 FB              2695             MOV     R3,A
000043 A3              2696             INC     DPTR
000044 E0              2697             MOVX    A,@DPTR
000045 FA              2698             MOV     R2,A
000046 A3              2699             INC     DPTR
000047 E0              2700             MOVX    A,@DPTR
000048 4A              2701             ORL     A,R2
000049 4B              2702             ORL     A,R3
00004A 7003            2703             JNZ     $ + 5H
00004C 010000     F    2704             AJMP    ?C0039
                       2705     ;               {
                       2706                             ; SOURCE LINE # 768
                       2707     ;                       taskENTER_CRITICAL();
00004F A2AFC2AF        2708              DB 0A2H, 0AFH, 0C2H, 0AFH, 0C0H, 0D0H;
000053 C0D0                     
                       2709     ;                       {
                       2710                             ; SOURCE LINE # 770
                       2711     ;                               sYieldRequired = ( pxTCB->ucPriority >= pxCurrentTCB->uc
                               Priority );
                       2712                             ; SOURCE LINE # 771
000055 90000000   F    2713             MOV     DPTR,#pxCurrentTCB
000059 E0              2714             MOVX    A,@DPTR
00005A FB              2715             MOV     R3,A
00005B A3              2716             INC     DPTR
00005C E0              2717             MOVX    A,@DPTR
00005D FA              2718             MOV     R2,A
00005E A3              2719             INC     DPTR
00005F E0              2720             MOVX    A,@DPTR
000060 2418            2721             ADD     A,#018H
000062 F9              2722             MOV     R1,A
000063 E4              2723             CLR     A
000064 3A              2724             ADDC    A,R2
000065 FA              2725             MOV     R2,A
000066 12000000   E    2726             LCALL   ?C?CLDPTR
00006A FF              2727             MOV     R7,A
00006B 850083     E    2728             MOV     DPH,?C_XBP
00006E 850082     E    2729             MOV     DPL,?C_XBP+01H
000071 759300     E    2730             MOV     DPX,#?C?XDATASEG
000074 E0              2731             MOVX    A,@DPTR
000075 FB              2732             MOV     R3,A
000076 A3              2733             INC     DPTR
000077 E0              2734             MOVX    A,@DPTR
000078 FA              2735             MOV     R2,A
000079 A3              2736             INC     DPTR
00007A E0              2737             MOVX    A,@DPTR
00007B 2418            2738             ADD     A,#018H
00007D F9              2739             MOV     R1,A
00007E E4              2740             CLR     A
00007F 3A              2741             ADDC    A,R2
000080 FA              2742             MOV     R2,A
000081 12000000   E    2743             LCALL   ?C?CLDPTR
000085 C3              2744             CLR     C
000086 9F              2745             SUBB    A,R7
000087 7E00            2746             MOV     R6,#00H
000089 4004            2747             JC      ?C0035
00008B 7F01            2748             MOV     R7,#01H
00008D 8002            2749             SJMP    ?C0036
00008F                 2750     ?C0035:
00008F 7F00            2751             MOV     R7,#00H
000091                 2752     ?C0036:
000091 90000003        2753             MOV     DPTR,#03H
000095 12000000   E    2754             LCALL   ?C?XBPOFF
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    45

000099 EE              2755             MOV     A,R6
00009A F0              2756             MOVX    @DPTR,A
00009B A3              2757             INC     DPTR
00009C EF              2758             MOV     A,R7
00009D F0              2759             MOVX    @DPTR,A
                       2760     ;                               vListRemove( &( pxTCB->xGenericListItem ) );
                       2761                             ; SOURCE LINE # 772
00009E 850083     E    2762             MOV     DPH,?C_XBP
0000A1 850082     E    2763             MOV     DPL,?C_XBP+01H
0000A4 759300     E    2764             MOV     DPX,#?C?XDATASEG
0000A7 E0              2765             MOVX    A,@DPTR
0000A8 FB              2766             MOV     R3,A
0000A9 A3              2767             INC     DPTR
0000AA E0              2768             MOVX    A,@DPTR
0000AB FA              2769             MOV     R2,A
0000AC A3              2770             INC     DPTR
0000AD E0              2771             MOVX    A,@DPTR
0000AE 2419            2772             ADD     A,#019H
0000B0 F9              2773             MOV     R1,A
0000B1 E4              2774             CLR     A
0000B2 3A              2775             ADDC    A,R2
0000B3 FA              2776             MOV     R2,A
0000B4 12000000   E    2777             LCALL   _?vListRemove
                       2778     ;                               prvAddTaskToReadyQueue( pxTCB );
                       2779                             ; SOURCE LINE # 773
0000B8 E4              2780             CLR     A
0000B9 FF              2781             MOV     R7,A
0000BA FE              2782             MOV     R6,A
0000BB FD              2783             MOV     R5,A
0000BC FC              2784             MOV     R4,A
0000BD 850083     E    2785             MOV     DPH,?C_XBP
0000C0 850082     E    2786             MOV     DPL,?C_XBP+01H
0000C3 759300     E    2787             MOV     DPX,#?C?XDATASEG
0000C6 E0              2788             MOVX    A,@DPTR
0000C7 FB              2789             MOV     R3,A
0000C8 A3              2790             INC     DPTR
0000C9 E0              2791             MOVX    A,@DPTR
0000CA FA              2792             MOV     R2,A
0000CB A3              2793             INC     DPTR
0000CC E0              2794             MOVX    A,@DPTR
0000CD 2419            2795             ADD     A,#019H
0000CF F9              2796             MOV     R1,A
0000D0 E4              2797             CLR     A
0000D1 3A              2798             ADDC    A,R2
0000D2 FA              2799             MOV     R2,A
0000D3 12000000   E    2800             LCALL   ?C?LSTPTR
0000D7 850083     E    2801             MOV     DPH,?C_XBP
0000DA 850082     E    2802             MOV     DPL,?C_XBP+01H
0000DD 759300     E    2803             MOV     DPX,#?C?XDATASEG
0000E0 E0              2804             MOVX    A,@DPTR
0000E1 FB              2805             MOV     R3,A
0000E2 A3              2806             INC     DPTR
0000E3 E0              2807             MOVX    A,@DPTR
0000E4 FA              2808             MOV     R2,A
0000E5 A3              2809             INC     DPTR
0000E6 E0              2810             MOVX    A,@DPTR
0000E7 2418            2811             ADD     A,#018H
0000E9 F9              2812             MOV     R1,A
0000EA E4              2813             CLR     A
0000EB 3A              2814             ADDC    A,R2
0000EC FA              2815             MOV     R2,A
0000ED 12000000   E    2816             LCALL   ?C?CLDPTR
0000F1 FF              2817             MOV     R7,A
0000F2 90000000   F    2818             MOV     DPTR,#ucTopReadyPriority
0000F6 E0              2819             MOVX    A,@DPTR
0000F7 FE              2820             MOV     R6,A
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    46

0000F8 EF              2821             MOV     A,R7
0000F9 D3              2822             SETB    C
0000FA 9E              2823             SUBB    A,R6
0000FB 4002            2824             JC      ?C0037
0000FD EF              2825             MOV     A,R7
0000FE F0              2826             MOVX    @DPTR,A
0000FF                 2827     ?C0037:
0000FF 850083     E    2828             MOV     DPH,?C_XBP
000102 850082     E    2829             MOV     DPL,?C_XBP+01H
000105 759300     E    2830             MOV     DPX,#?C?XDATASEG
000108 E0              2831             MOVX    A,@DPTR
000109 FB              2832             MOV     R3,A
00010A A3              2833             INC     DPTR
00010B E0              2834             MOVX    A,@DPTR
00010C FA              2835             MOV     R2,A
00010D A3              2836             INC     DPTR
00010E E0              2837             MOVX    A,@DPTR
00010F 2419            2838             ADD     A,#019H
000111 F9              2839             MOV     R1,A
000112 E4              2840             CLR     A
000113 3A              2841             ADDC    A,R2
000114 FA              2842             MOV     R2,A
000115 9000FFFD        2843             MOV     DPTR,#0FFFDH
000119 12000000   E    2844             LCALL   ?C?ADDXBP
00011D EB              2845             MOV     A,R3
00011E F0              2846             MOVX    @DPTR,A
00011F A3              2847             INC     DPTR
000120 EA              2848             MOV     A,R2
000121 F0              2849             MOVX    @DPTR,A
000122 A3              2850             INC     DPTR
000123 E9              2851             MOV     A,R1
000124 F0              2852             MOVX    @DPTR,A
000125 EF              2853             MOV     A,R7
000126 75F018          2854             MOV     B,#018H
000129 A4              2855             MUL     AB
00012A 2400       F    2856             ADD     A,#LOW (pxReadyTasksLists)
00012C F9              2857             MOV     R1,A
00012D 7400       F    2858             MOV     A,#HIGH (pxReadyTasksLists)
00012F 35F0            2859             ADDC    A,B
000131 FA              2860             MOV     R2,A
000132 7B00       F    2861             MOV     R3,#MBYTE (pxReadyTasksLists)
000134 12000000   E    2862             LCALL   _?vListInsertEnd
                       2863     ;                       }
                       2864                             ; SOURCE LINE # 774
                       2865     ;                       taskEXIT_CRITICAL();
000138 D0D092AF        2866              DB 0D0H, 0D0H, 092H, 0AFH;
                       2867     ; 
                       2868     ;                       /* We may have just resumed a higher priority task. */
                       2869     ;                       if( sYieldRequired )
                       2870                             ; SOURCE LINE # 778
00013C 90000003        2871             MOV     DPTR,#03H
000140 12000000   E    2872             LCALL   ?C?XBPOFF
000144 E0              2873             MOVX    A,@DPTR
000145 FE              2874             MOV     R6,A
000146 A3              2875             INC     DPTR
000147 E0              2876             MOVX    A,@DPTR
000148 4E              2877             ORL     A,R6
000149 6004            2878             JZ      ?C0039
                       2879     ;                       {
                       2880                             ; SOURCE LINE # 779
                       2881     ;                               /* This yield may not cause the task just resumed to run
                               , but
                       2882     ;                               will leave the lists in the correct state for the next y
                               ield. */
                       2883     ;                               taskYIELD();
                       2884                             ; SOURCE LINE # 782
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    47

00014B 12000000   E    2885             LCALL   _?vPortYield
                       2886     ;                       }
                       2887                             ; SOURCE LINE # 783
                       2888     ;               }
                       2889                             ; SOURCE LINE # 784
                       2890     ;       }
                       2891                             ; SOURCE LINE # 785
00014F                 2892     ?C0039:
00014F 90000008        2893             MOV     DPTR,#08H
000153 02000000   E    2894             LJMP    ?C?ADDXBP
                       2895     ; END OF _?vTaskResume
                       2896     
                       2897     ; 
                       2898     ; #endif
                       2899     ; 
                       2900     ; 
                       2901     ; 
                       2902     ; 
                       2903     ; 
                       2904     ; /*-----------------------------------------------------------
                       2905     ;  * PUBLIC SCHEDULER CONTROL documented in task.h
                       2906     ;  *----------------------------------------------------------*/
                       2907     ; 
                       2908     ; 
                       2909     ; void vTaskStartScheduler( portSHORT sUsePreemption )reentrant
                       2910     
------                 2911             RSEG  ?PR?_?vTaskStartScheduler?TASKS
000000                 2912     _?vTaskStartScheduler:
                       2913             USING   0
                       2914                             ; SOURCE LINE # 798
000000 9000FFFE        2915             MOV     DPTR,#0FFFEH
000004 12000000   E    2916             LCALL   ?C?ADDXBP
000008 EE              2917             MOV     A,R6
000009 F0              2918             MOVX    @DPTR,A
00000A A3              2919             INC     DPTR
00000B EF              2920             MOV     A,R7
00000C F0              2921             MOVX    @DPTR,A
                       2922     ; {
                       2923     ;       /* Check a task has been created. */
                       2924     ;       if( pxCurrentTCB != NULL )
                       2925                             ; SOURCE LINE # 801
00000D 90000000   F    2926             MOV     DPTR,#pxCurrentTCB
000011 E0              2927             MOVX    A,@DPTR
000012 FB              2928             MOV     R3,A
000013 A3              2929             INC     DPTR
000014 E0              2930             MOVX    A,@DPTR
000015 FA              2931             MOV     R2,A
000016 A3              2932             INC     DPTR
000017 E0              2933             MOVX    A,@DPTR
000018 4A              2934             ORL     A,R2
000019 4B              2935             ORL     A,R3
00001A 6035            2936             JZ      ?C0043
                       2937     ;       {
                       2938                             ; SOURCE LINE # 802
                       2939     ;               sUsingPreemption = sUsePreemption;
                       2940                             ; SOURCE LINE # 803
00001C 850083     E    2941             MOV     DPH,?C_XBP
00001F 850082     E    2942             MOV     DPL,?C_XBP+01H
000022 759300     E    2943             MOV     DPX,#?C?XDATASEG
000025 E0              2944             MOVX    A,@DPTR
000026 FA              2945             MOV     R2,A
000027 A3              2946             INC     DPTR
000028 E0              2947             MOVX    A,@DPTR
000029 FB              2948             MOV     R3,A
00002A 90000000   F    2949             MOV     DPTR,#sUsingPreemption
00002E EA              2950             MOV     A,R2
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    48

00002F F0              2951             MOVX    @DPTR,A
000030 A3              2952             INC     DPTR
000031 EB              2953             MOV     A,R3
000032 F0              2954             MOVX    @DPTR,A
                       2955     ; 
                       2956     ;               /* Interrupts are turned off here, to ensure a tick does not occur
                       2957     ;               before or during the call to sPortStartScheduler().  The stacks of 
                       2958     ;               the created tasks contain a status word with interrupts switched on
                       2959     ;               so interrupts will automatically get re-enabled when the first task
                       2960     ;               starts to run.
                       2961     ;               
                       2962     ;               STEPPING THROUGH HERE USING A DEBUGGER CAN CAUSE BIG PROBLEMS IF THE
                       2963     ;               DEBUGGER ALLOWS INTERRUPTS TO BE PROCESSED. */
                       2964     ;               portDISABLE_INTERRUPTS();
                       2965                             ; SOURCE LINE # 813
000033 C2AF            2966             CLR     EA
                       2967     ; 
                       2968     ;               cSchedulerRunning = pdTRUE;
                       2969                             ; SOURCE LINE # 815
000035 90000000   F    2970             MOV     DPTR,#cSchedulerRunning
000039 7401            2971             MOV     A,#01H
00003B F0              2972             MOVX    @DPTR,A
                       2973     ;               xTickCount = ( portTickType ) 0;
                       2974                             ; SOURCE LINE # 816
00003C E4              2975             CLR     A
00003D FF              2976             MOV     R7,A
00003E FE              2977             MOV     R6,A
00003F FD              2978             MOV     R5,A
000040 FC              2979             MOV     R4,A
000041 90000000   F    2980             MOV     DPTR,#xTickCount
000045 12000000   E    2981             LCALL   ?C?LSTXDATA
                       2982     ; 
                       2983     ;               /* Setting up the timer tick is hardware specific and thus in the 
                       2984     ;               portable interface. */
                       2985     ;               if( sPortStartScheduler( sUsePreemption ) )
                       2986                             ; SOURCE LINE # 820
000049 AF03            2987             MOV     R7,AR3
00004B AE02            2988             MOV     R6,AR2
00004D 12000000   E    2989             LCALL   _?sPortStartScheduler
                       2990     ;               {
                       2991                             ; SOURCE LINE # 821
                       2992     ;                       /* Should not reach here as if the scheduler is running the
                       2993     ;                       function will not return. */
                       2994     ;               }
                       2995                             ; SOURCE LINE # 824
000051                 2996     ?C0041:
                       2997     ;               else
                       2998     ;               {
                       2999                             ; SOURCE LINE # 826
                       3000     ;                       /* Should only reach here if a task calls sTaskEndScheduler(). *
                               /
                       3001     ;               }
                       3002                             ; SOURCE LINE # 828
                       3003     ;       }
                       3004                             ; SOURCE LINE # 829
                       3005     ; }
                       3006                             ; SOURCE LINE # 830
000051                 3007     ?C0043:
000051 90000002        3008             MOV     DPTR,#02H
000055 02000000   E    3009             LJMP    ?C?ADDXBP
                       3010     ; END OF _?vTaskStartScheduler
                       3011     
                       3012     ; /*-----------------------------------------------------------*/
                       3013     ; 
                       3014     ; void vTaskEndScheduler( void ) reentrant
                       3015     
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    49

------                 3016             RSEG  ?PR?_?vTaskEndScheduler?TASKS
000000                 3017     _?vTaskEndScheduler:
                       3018             USING   0
                       3019                             ; SOURCE LINE # 833
                       3020     ; {
                       3021     ;       /* Stop the scheduler interrupts and call the portable scheduler end 
                       3022     ;       routine so the original ISRs can be restored if necessary.  The port
                       3023     ;       layer must ensure interrupts enable     bit is left in the correct state. */
                       3024     ;       portDISABLE_INTERRUPTS();
                       3025                             ; SOURCE LINE # 838
000000 C2AF            3026             CLR     EA
                       3027     ;       cSchedulerRunning = pdFALSE;
                       3028                             ; SOURCE LINE # 839
000002 E4              3029             CLR     A
000003 90000000   F    3030             MOV     DPTR,#cSchedulerRunning
000007 F0              3031             MOVX    @DPTR,A
                       3032     ;       vPortEndScheduler();
                       3033                             ; SOURCE LINE # 840
000008 02000000   E    3034             LJMP    _?vPortEndScheduler
                       3035     ; END OF _?vTaskEndScheduler
                       3036     
                       3037     ; }
                       3038     ; /*----------------------------------------------------------*/
                       3039     ; 
                       3040     ; void vTaskSuspendAll( void ) reentrant
                       3041     
------                 3042             RSEG  ?PR?_?vTaskSuspendAll?TASKS
000000                 3043     _?vTaskSuspendAll:
                       3044             USING   0
                       3045                             ; SOURCE LINE # 844
                       3046     ; {
                       3047     ;       portENTER_CRITICAL();
000000 A2AFC2AF        3048              DB 0A2H, 0AFH, 0C2H, 0AFH, 0C0H, 0D0H;
000004 C0D0                     
                       3049     ;               ++ucSchedulerSuspended;
                       3050                             ; SOURCE LINE # 847
000006 90000000   F    3051             MOV     DPTR,#ucSchedulerSuspended
00000A E0              3052             MOVX    A,@DPTR
00000B 04              3053             INC     A
00000C F0              3054             MOVX    @DPTR,A
                       3055     ;       portEXIT_CRITICAL();
00000D D0D092AF        3056              DB 0D0H, 0D0H, 092H, 0AFH;
                       3057     ; }
                       3058                             ; SOURCE LINE # 849
000011 22              3059             RET     
                       3060     ; END OF _?vTaskSuspendAll
                       3061     
                       3062     ; /*----------------------------------------------------------*/
                       3063     ; 
                       3064     ; signed portCHAR cTaskResumeAll( void ) reentrant
                       3065     
------                 3066             RSEG  ?PR?_?cTaskResumeAll?TASKS
000000                 3067     _?cTaskResumeAll:
                       3068             USING   0
                       3069                             ; SOURCE LINE # 852
000000 9000FFFC        3070             MOV     DPTR,#0FFFCH
000004 12000000   E    3071             LCALL   ?C?ADDXBP
                       3072     ; {
                       3073     ; register tskTCB *pxTCB;
                       3074     ; signed portCHAR cAlreadyYielded = ( signed portCHAR ) pdFALSE;
                       3075                             ; SOURCE LINE # 855
000008 90000003        3076             MOV     DPTR,#03H
00000C 12000000   E    3077             LCALL   ?C?XBPOFF
000010 E4              3078             CLR     A
000011 F0              3079             MOVX    @DPTR,A
000012 A2AFC2AF        3080              DB 0A2H, 0AFH, 0C2H, 0AFH, 0C0H, 0D0H;
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    50

000016 C0D0                     
                       3081     ; 
                       3082     ;       /* It is possible that an ISR caused a task to be removed from an event
                       3083     ;       list while the scheduler was suspended.  If this was the case then the
                       3084     ;       removed task will have been added to the xPendingReadyList.  Once the
                       3085     ;       scheduler has been resumed it is safe to move all the pending ready
                       3086     ;       tasks from this list into their appropriate ready list. */
                       3087     ;       portENTER_CRITICAL();
                       3088     ;       {
                       3089                             ; SOURCE LINE # 863
                       3090     ;               --ucSchedulerSuspended;
                       3091                             ; SOURCE LINE # 864
000018 90000000   F    3092             MOV     DPTR,#ucSchedulerSuspended
00001C E0              3093             MOVX    A,@DPTR
00001D 14              3094             DEC     A
00001E F0              3095             MOVX    @DPTR,A
                       3096     ; 
                       3097     ;               if( ucSchedulerSuspended == pdFALSE )
                       3098                             ; SOURCE LINE # 866
00001F E0              3099             MOVX    A,@DPTR
000020 6003            3100             JZ      $ + 5H
000022 010000     F    3101             AJMP    ?C0046
                       3102     ;               {
                       3103                             ; SOURCE LINE # 867
                       3104     ;                       if( usCurrentNumberOfTasks > ( unsigned portSHORT ) 0 )
                       3105                             ; SOURCE LINE # 868
000025 D3              3106             SETB    C
000026 90000000   F    3107             MOV     DPTR,#usCurrentNumberOfTasks+01H
00002A E0              3108             MOVX    A,@DPTR
00002B 9400            3109             SUBB    A,#00H
00002D 90000000   F    3110             MOV     DPTR,#usCurrentNumberOfTasks
000031 E0              3111             MOVX    A,@DPTR
000032 9400            3112             SUBB    A,#00H
000034 5003            3113             JNC     $ + 5H
000036 010000     F    3114             AJMP    ?C0046
                       3115     ;                       {
                       3116                             ; SOURCE LINE # 869
000039                 3117     ?C0048:
                       3118     ;                               /* Move any readied tasks from the pending list into the
                                
                       3119     ;                               appropriate ready list. */
                       3120     ;                               while( ( pxTCB = ( tskTCB * ) listGET_OWNER_OF_HEAD_ENTR
                               Y(  ( ( xList * ) &xPendingReadyList ) ) ) != NULL )
                       3121                             ; SOURCE LINE # 872
000039 90000000   F    3122             MOV     DPTR,#xPendingReadyList
00003D E0              3123             MOVX    A,@DPTR
00003E 7002            3124             JNZ     ?C0113
000040 A3              3125             INC     DPTR
000041 E0              3126             MOVX    A,@DPTR
000042                 3127     ?C0113:
000042 6022            3128             JZ      ?C0050
000044 90000000   F    3129             MOV     DPTR,#xPendingReadyList+02H
000048 E0              3130             MOVX    A,@DPTR
000049 FB              3131             MOV     R3,A
00004A A3              3132             INC     DPTR
00004B E0              3133             MOVX    A,@DPTR
00004C FA              3134             MOV     R2,A
00004D A3              3135             INC     DPTR
00004E E0              3136             MOVX    A,@DPTR
00004F 2404            3137             ADD     A,#04H
000051 F9              3138             MOV     R1,A
000052 E4              3139             CLR     A
000053 3A              3140             ADDC    A,R2
000054 FA              3141             MOV     R2,A
000055 12000000   E    3142             LCALL   ?C?PLDPTR
000059 E9              3143             MOV     A,R1
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    51

00005A 240A            3144             ADD     A,#0AH
00005C F9              3145             MOV     R1,A
00005D E4              3146             CLR     A
00005E 3A              3147             ADDC    A,R2
00005F FA              3148             MOV     R2,A
000060 12000000   E    3149             LCALL   ?C?PLDPTR
000064 8006            3150             SJMP    ?C0051
000066                 3151     ?C0050:
000066 7B00            3152             MOV     R3,#00H
000068 7A00            3153             MOV     R2,#00H
00006A 7900            3154             MOV     R1,#00H
00006C                 3155     ?C0051:
00006C 850083     E    3156             MOV     DPH,?C_XBP
00006F 850082     E    3157             MOV     DPL,?C_XBP+01H
000072 759300     E    3158             MOV     DPX,#?C?XDATASEG
000075 EB              3159             MOV     A,R3
000076 F0              3160             MOVX    @DPTR,A
000077 A3              3161             INC     DPTR
000078 EA              3162             MOV     A,R2
000079 F0              3163             MOVX    @DPTR,A
00007A A3              3164             INC     DPTR
00007B E9              3165             MOV     A,R1
00007C F0              3166             MOVX    @DPTR,A
00007D 4A              3167             ORL     A,R2
00007E 4B              3168             ORL     A,R3
00007F 7003            3169             JNZ     $ + 5H
000081 010000     F    3170             AJMP    ?C0049
                       3171     ;                               {
                       3172                             ; SOURCE LINE # 873
                       3173     ;                                       vListRemove( &( pxTCB->xEventListItem ) );
                       3174                             ; SOURCE LINE # 874
000084 850083     E    3175             MOV     DPH,?C_XBP
000087 850082     E    3176             MOV     DPL,?C_XBP+01H
00008A 759300     E    3177             MOV     DPX,#?C?XDATASEG
00008D E0              3178             MOVX    A,@DPTR
00008E FB              3179             MOV     R3,A
00008F A3              3180             INC     DPTR
000090 E0              3181             MOVX    A,@DPTR
000091 FA              3182             MOV     R2,A
000092 A3              3183             INC     DPTR
000093 E0              3184             MOVX    A,@DPTR
000094 2429            3185             ADD     A,#029H
000096 F9              3186             MOV     R1,A
000097 E4              3187             CLR     A
000098 3A              3188             ADDC    A,R2
000099 FA              3189             MOV     R2,A
00009A 12000000   E    3190             LCALL   _?vListRemove
                       3191     ;                                       vListRemove( &( pxTCB->xGenericListItem ) );
                       3192                             ; SOURCE LINE # 875
00009E 850083     E    3193             MOV     DPH,?C_XBP
0000A1 850082     E    3194             MOV     DPL,?C_XBP+01H
0000A4 759300     E    3195             MOV     DPX,#?C?XDATASEG
0000A7 E0              3196             MOVX    A,@DPTR
0000A8 FB              3197             MOV     R3,A
0000A9 A3              3198             INC     DPTR
0000AA E0              3199             MOVX    A,@DPTR
0000AB FA              3200             MOV     R2,A
0000AC A3              3201             INC     DPTR
0000AD E0              3202             MOVX    A,@DPTR
0000AE 2419            3203             ADD     A,#019H
0000B0 F9              3204             MOV     R1,A
0000B1 E4              3205             CLR     A
0000B2 3A              3206             ADDC    A,R2
0000B3 FA              3207             MOV     R2,A
0000B4 12000000   E    3208             LCALL   _?vListRemove
                       3209     ;                                       prvAddTaskToReadyQueue( pxTCB );
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    52

                       3210                             ; SOURCE LINE # 876
0000B8 E4              3211             CLR     A
0000B9 FF              3212             MOV     R7,A
0000BA FE              3213             MOV     R6,A
0000BB FD              3214             MOV     R5,A
0000BC FC              3215             MOV     R4,A
0000BD 850083     E    3216             MOV     DPH,?C_XBP
0000C0 850082     E    3217             MOV     DPL,?C_XBP+01H
0000C3 759300     E    3218             MOV     DPX,#?C?XDATASEG
0000C6 E0              3219             MOVX    A,@DPTR
0000C7 FB              3220             MOV     R3,A
0000C8 A3              3221             INC     DPTR
0000C9 E0              3222             MOVX    A,@DPTR
0000CA FA              3223             MOV     R2,A
0000CB A3              3224             INC     DPTR
0000CC E0              3225             MOVX    A,@DPTR
0000CD 2419            3226             ADD     A,#019H
0000CF F9              3227             MOV     R1,A
0000D0 E4              3228             CLR     A
0000D1 3A              3229             ADDC    A,R2
0000D2 FA              3230             MOV     R2,A
0000D3 12000000   E    3231             LCALL   ?C?LSTPTR
0000D7 850083     E    3232             MOV     DPH,?C_XBP
0000DA 850082     E    3233             MOV     DPL,?C_XBP+01H
0000DD 759300     E    3234             MOV     DPX,#?C?XDATASEG
0000E0 E0              3235             MOVX    A,@DPTR
0000E1 FB              3236             MOV     R3,A
0000E2 A3              3237             INC     DPTR
0000E3 E0              3238             MOVX    A,@DPTR
0000E4 FA              3239             MOV     R2,A
0000E5 A3              3240             INC     DPTR
0000E6 E0              3241             MOVX    A,@DPTR
0000E7 2418            3242             ADD     A,#018H
0000E9 F9              3243             MOV     R1,A
0000EA E4              3244             CLR     A
0000EB 3A              3245             ADDC    A,R2
0000EC FA              3246             MOV     R2,A
0000ED 12000000   E    3247             LCALL   ?C?CLDPTR
0000F1 FF              3248             MOV     R7,A
0000F2 90000000   F    3249             MOV     DPTR,#ucTopReadyPriority
0000F6 E0              3250             MOVX    A,@DPTR
0000F7 FE              3251             MOV     R6,A
0000F8 EF              3252             MOV     A,R7
0000F9 D3              3253             SETB    C
0000FA 9E              3254             SUBB    A,R6
0000FB 4002            3255             JC      ?C0052
0000FD EF              3256             MOV     A,R7
0000FE F0              3257             MOVX    @DPTR,A
0000FF                 3258     ?C0052:
0000FF 850083     E    3259             MOV     DPH,?C_XBP
000102 850082     E    3260             MOV     DPL,?C_XBP+01H
000105 759300     E    3261             MOV     DPX,#?C?XDATASEG
000108 E0              3262             MOVX    A,@DPTR
000109 FB              3263             MOV     R3,A
00010A A3              3264             INC     DPTR
00010B E0              3265             MOVX    A,@DPTR
00010C FA              3266             MOV     R2,A
00010D A3              3267             INC     DPTR
00010E E0              3268             MOVX    A,@DPTR
00010F 2419            3269             ADD     A,#019H
000111 F9              3270             MOV     R1,A
000112 E4              3271             CLR     A
000113 3A              3272             ADDC    A,R2
000114 FA              3273             MOV     R2,A
000115 9000FFFD        3274             MOV     DPTR,#0FFFDH
000119 12000000   E    3275             LCALL   ?C?ADDXBP
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    53

00011D EB              3276             MOV     A,R3
00011E F0              3277             MOVX    @DPTR,A
00011F A3              3278             INC     DPTR
000120 EA              3279             MOV     A,R2
000121 F0              3280             MOVX    @DPTR,A
000122 A3              3281             INC     DPTR
000123 E9              3282             MOV     A,R1
000124 F0              3283             MOVX    @DPTR,A
000125 EF              3284             MOV     A,R7
000126 75F018          3285             MOV     B,#018H
000129 A4              3286             MUL     AB
00012A 2400       F    3287             ADD     A,#LOW (pxReadyTasksLists)
00012C F9              3288             MOV     R1,A
00012D 7400       F    3289             MOV     A,#HIGH (pxReadyTasksLists)
00012F 35F0            3290             ADDC    A,B
000131 FA              3291             MOV     R2,A
000132 7B00       F    3292             MOV     R3,#MBYTE (pxReadyTasksLists)
000134 12000000   E    3293             LCALL   _?vListInsertEnd
                       3294     ;                               }
                       3295                             ; SOURCE LINE # 877
000138 010000     F    3296             AJMP    ?C0048
00013B                 3297     ?C0049:
                       3298     ; 
                       3299     ;                               /* If any ticks occurred while the scheduler was suspend
                               ed then
                       3300     ;                               they should be processed now.  This ensures the tick cou
                               nt does not
                       3301     ;                               slip, and that any delayed tasks are resumed at the corr
                               ect time. */
                       3302     ;                               if( ucMissedTicks > 0 )
                       3303                             ; SOURCE LINE # 882
00013B 90000000   F    3304             MOV     DPTR,#ucMissedTicks
00013F E0              3305             MOVX    A,@DPTR
000140 D3              3306             SETB    C
000141 9400            3307             SUBB    A,#00H
000143 4026            3308             JC      ?C0046
                       3309     ;                               {
                       3310                             ; SOURCE LINE # 883
000145                 3311     ?C0054:
                       3312     ;                                       while( ucMissedTicks > 0 )
                       3313                             ; SOURCE LINE # 884
000145 90000000   F    3314             MOV     DPTR,#ucMissedTicks
000149 E0              3315             MOVX    A,@DPTR
00014A D3              3316             SETB    C
00014B 9400            3317             SUBB    A,#00H
00014D 400D            3318             JC      ?C0055
                       3319     ;                                       {
                       3320                             ; SOURCE LINE # 885
                       3321     ;                                               vTaskIncrementTick();
                       3322                             ; SOURCE LINE # 886
00014F 12000000   F    3323             LCALL   _?vTaskIncrementTick
                       3324     ;                                               --ucMissedTicks;
                       3325                             ; SOURCE LINE # 887
000153 90000000   F    3326             MOV     DPTR,#ucMissedTicks
000157 E0              3327             MOVX    A,@DPTR
000158 14              3328             DEC     A
000159 F0              3329             MOVX    @DPTR,A
                       3330     ;                                       }
                       3331                             ; SOURCE LINE # 888
00015A 80E9            3332             SJMP    ?C0054
00015C                 3333     ?C0055:
                       3334     ; 
                       3335     ;                                       /* As we have processed some ticks it is appropr
                               iate to yield
                       3336     ;                                       to ensure the highest priority task that is read
                               y to run is
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    54

                       3337     ;                                       the task actually running. */
                       3338     ;                                       cAlreadyYielded = ( signed portCHAR ) pdTRUE;
                       3339                             ; SOURCE LINE # 893
00015C 90000003        3340             MOV     DPTR,#03H
000160 12000000   E    3341             LCALL   ?C?XBPOFF
000164 7401            3342             MOV     A,#01H
000166 F0              3343             MOVX    @DPTR,A
                       3344     ;                                       taskYIELD();
                       3345                             ; SOURCE LINE # 894
000167 12000000   E    3346             LCALL   _?vPortYield
                       3347     ;                               }
                       3348                             ; SOURCE LINE # 895
                       3349     ;                       }
                       3350                             ; SOURCE LINE # 896
                       3351     ;               }
                       3352                             ; SOURCE LINE # 897
00016B                 3353     ?C0046:
                       3354     ;       }
                       3355                             ; SOURCE LINE # 898
                       3356     ;       portEXIT_CRITICAL();
00016B D0D092AF        3357              DB 0D0H, 0D0H, 092H, 0AFH;
                       3358     ; 
                       3359     ;       return cAlreadyYielded;
                       3360                             ; SOURCE LINE # 901
00016F 90000003        3361             MOV     DPTR,#03H
000173 12000000   E    3362             LCALL   ?C?XBPOFF
000177 E0              3363             MOVX    A,@DPTR
000178 FF              3364             MOV     R7,A
                       3365     ; }
                       3366                             ; SOURCE LINE # 902
000179                 3367     ?C0056:
000179 90000004        3368             MOV     DPTR,#04H
00017D 02000000   E    3369             LJMP    ?C?ADDXBP
                       3370     ; END OF _?cTaskResumeAll
                       3371     
                       3372     ; 
                       3373     ; 
                       3374     ; 
                       3375     ; 
                       3376     ; 
                       3377     ; 
                       3378     ; /*-----------------------------------------------------------
                       3379     ;  * PUBLIC TASK UTILITIES documented in task.h
                       3380     ;  *----------------------------------------------------------*/
                       3381     ; 
                       3382     ; 
                       3383     ; 
                       3384     ; volatile portTickType xTaskGetTickCount( void ) reentrant
                       3385     
------                 3386             RSEG  ?PR?_?xTaskGetTickCount?TASKS
000000                 3387     _?xTaskGetTickCount:
                       3388             USING   0
                       3389                             ; SOURCE LINE # 915
000000 9000FFFC        3390             MOV     DPTR,#0FFFCH
000004 12000000   E    3391             LCALL   ?C?ADDXBP
                       3392     ; {
                       3393     ; portTickType xTicks;
000008 A2AFC2AF        3394              DB 0A2H, 0AFH, 0C2H, 0AFH, 0C0H, 0D0H;
00000C C0D0                     
                       3395     ; 
                       3396     ;       /* Critical section required if running on a 16 bit processor. */
                       3397     ;       taskENTER_CRITICAL();
                       3398     ;       {
                       3399                             ; SOURCE LINE # 921
                       3400     ;               xTicks = xTickCount;
                       3401                             ; SOURCE LINE # 922
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    55

00000E 90000000   F    3402             MOV     DPTR,#xTickCount
000012 E0              3403             MOVX    A,@DPTR
000013 FC              3404             MOV     R4,A
000014 A3              3405             INC     DPTR
000015 E0              3406             MOVX    A,@DPTR
000016 FD              3407             MOV     R5,A
000017 A3              3408             INC     DPTR
000018 E0              3409             MOVX    A,@DPTR
000019 FE              3410             MOV     R6,A
00001A A3              3411             INC     DPTR
00001B E0              3412             MOVX    A,@DPTR
00001C FF              3413             MOV     R7,A
00001D 850083     E    3414             MOV     DPH,?C_XBP
000020 850082     E    3415             MOV     DPL,?C_XBP+01H
000023 759300     E    3416             MOV     DPX,#?C?XDATASEG
000026 12000000   E    3417             LCALL   ?C?LSTXDATA
                       3418     ;       }
                       3419                             ; SOURCE LINE # 923
                       3420     ;       taskEXIT_CRITICAL();
00002A D0D092AF        3421              DB 0D0H, 0D0H, 092H, 0AFH;
                       3422     ; 
                       3423     ;       return xTicks;
                       3424                             ; SOURCE LINE # 926
00002E 850083     E    3425             MOV     DPH,?C_XBP
000031 850082     E    3426             MOV     DPL,?C_XBP+01H
000034 759300     E    3427             MOV     DPX,#?C?XDATASEG
000037 E0              3428             MOVX    A,@DPTR
000038 FC              3429             MOV     R4,A
000039 A3              3430             INC     DPTR
00003A E0              3431             MOVX    A,@DPTR
00003B FD              3432             MOV     R5,A
00003C A3              3433             INC     DPTR
00003D E0              3434             MOVX    A,@DPTR
00003E FE              3435             MOV     R6,A
00003F A3              3436             INC     DPTR
000040 E0              3437             MOVX    A,@DPTR
000041 FF              3438             MOV     R7,A
                       3439     ; }
                       3440                             ; SOURCE LINE # 927
000042                 3441     ?C0057:
000042 90000004        3442             MOV     DPTR,#04H
000046 02000000   E    3443             LJMP    ?C?ADDXBP
                       3444     ; END OF _?xTaskGetTickCount
                       3445     
                       3446     ; /*-----------------------------------------------------------*/
                       3447     ; 
                       3448     ; unsigned portSHORT usTaskGetNumberOfTasks( void ) reentrant
                       3449     
------                 3450             RSEG  ?PR?_?usTaskGetNumberOfTasks?TASKS
000000                 3451     _?usTaskGetNumberOfTasks:
                       3452             USING   0
                       3453                             ; SOURCE LINE # 930
000000 9000FFFE        3454             MOV     DPTR,#0FFFEH
000004 12000000   E    3455             LCALL   ?C?ADDXBP
                       3456     ; {
                       3457     ; unsigned portSHORT usNumberOfTasks;
000008 A2AFC2AF        3458              DB 0A2H, 0AFH, 0C2H, 0AFH, 0C0H, 0D0H;
00000C C0D0                     
                       3459     ; 
                       3460     ;       taskENTER_CRITICAL();
                       3461     ;               usNumberOfTasks = usCurrentNumberOfTasks;
                       3462                             ; SOURCE LINE # 935
00000E 90000000   F    3463             MOV     DPTR,#usCurrentNumberOfTasks
000012 E0              3464             MOVX    A,@DPTR
000013 FF              3465             MOV     R7,A
000014 A3              3466             INC     DPTR
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    56

000015 E0              3467             MOVX    A,@DPTR
000016 850083     E    3468             MOV     DPH,?C_XBP
000019 850082     E    3469             MOV     DPL,?C_XBP+01H
00001C 759300     E    3470             MOV     DPX,#?C?XDATASEG
00001F CF              3471             XCH     A,R7
000020 F0              3472             MOVX    @DPTR,A
000021 A3              3473             INC     DPTR
000022 EF              3474             MOV     A,R7
000023 F0              3475             MOVX    @DPTR,A
                       3476     ;       taskEXIT_CRITICAL();
000024 D0D092AF        3477              DB 0D0H, 0D0H, 092H, 0AFH;
                       3478     ; 
                       3479     ;       return usNumberOfTasks;
                       3480                             ; SOURCE LINE # 938
000028 850083     E    3481             MOV     DPH,?C_XBP
00002B 850082     E    3482             MOV     DPL,?C_XBP+01H
00002E 759300     E    3483             MOV     DPX,#?C?XDATASEG
000031 E0              3484             MOVX    A,@DPTR
000032 FE              3485             MOV     R6,A
000033 A3              3486             INC     DPTR
000034 E0              3487             MOVX    A,@DPTR
000035 FF              3488             MOV     R7,A
                       3489     ; }
                       3490                             ; SOURCE LINE # 939
000036                 3491     ?C0058:
000036 90000002        3492             MOV     DPTR,#02H
00003A 02000000   E    3493             LJMP    ?C?ADDXBP
                       3494     ; END OF _?usTaskGetNumberOfTasks
                       3495     
                       3496     ; /*-----------------------------------------------------------*/
                       3497     ; 
                       3498     ; #if( ( USE_TRACE_FACILITY == 1 ) && ( INCLUDE_vTaskDelete == 1 ) && ( INCLUDE_vTaskSus
                               pend == 1 ) )
                       3499     ; 
                       3500     ;       void vTaskList( signed portCHAR *pcWriteBuffer ) reentrant
                       3501     ;       {
                       3502     ;       unsigned portSHORT usQueue;
                       3503     ; 
                       3504     ;               /* This is a VERY costly function that should be used for debug only.
                       3505     ;               It leaves interrupts disabled for a LONG time. */
                       3506     ; 
                       3507     ;               taskENTER_CRITICAL();
                       3508     ;               {
                       3509     ;                       /* Run through all the lists that could potentially contain a TC
                               B and
                       3510     ;                       report the task name, state and stack high water mark. */
                       3511     ; 
                       3512     ;                       pcWriteBuffer[ 0 ] = ( signed portCHAR ) 0x00;
                       3513     ;                       strcat( pcWriteBuffer, ( const signed portCHAR * ) "\r\n" );
                       3514     ; 
                       3515     ;                       usQueue = ( unsigned portSHORT ) ucTopUsedPriority + ( unsigned 
                               portSHORT ) 1;
                       3516     ; 
                       3517     ;                       do
                       3518     ;                       {
                       3519     ;                               usQueue--;
                       3520     ; 
                       3521     ;                               if( !listLIST_IS_EMPTY( &( pxReadyTasksLists[ usQueue ] 
                               ) ) )
                       3522     ;                               {
                       3523     ;                                       prvListTaskWithinSingleList( pcWriteBuffer, ( xL
                               ist * ) &( pxReadyTasksLists[ usQueue ] ), tskREADY_CHAR );                     
                       3524     ;                               }
                       3525     ;                       }while( usQueue > ( unsigned portSHORT ) tskIDLE_PRIORITY );
                       3526     ; 
                       3527     ;                       if( !listLIST_IS_EMPTY( pxDelayedTaskList ) )
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    57

                       3528     ;                       {
                       3529     ;                               prvListTaskWithinSingleList( pcWriteBuffer, ( xList * ) 
                               pxDelayedTaskList, tskBLOCKED_CHAR );
                       3530     ;                       }
                       3531     ; 
                       3532     ;                       if( !listLIST_IS_EMPTY( pxOverflowDelayedTaskList ) )
                       3533     ;                       {
                       3534     ;                               prvListTaskWithinSingleList( pcWriteBuffer, ( xList * ) 
                               pxOverflowDelayedTaskList, tskBLOCKED_CHAR );
                       3535     ;                       }
                       3536     ; 
                       3537     ;                       if( !listLIST_IS_EMPTY( &xTasksWaitingTermination ) )
                       3538     ;                       {
                       3539     ;                               prvListTaskWithinSingleList( pcWriteBuffer, ( xList * ) 
                               &xTasksWaitingTermination, tskDELETED_CHAR );
                       3540     ;                       }
                       3541     ; 
                       3542     ;                       if( !listLIST_IS_EMPTY( &xSuspendedTaskList ) )
                       3543     ;                       {
                       3544     ;                               prvListTaskWithinSingleList( pcWriteBuffer, ( xList * ) 
                               &xSuspendedTaskList, tskSUSPENDED_CHAR );
                       3545     ;                       }
                       3546     ;               }
                       3547     ;               taskEXIT_CRITICAL();
                       3548     ;       }
                       3549     ; 
                       3550     ; #endif
                       3551     ; /*----------------------------------------------------------*/
                       3552     ; 
                       3553     ; #if( USE_TRACE_FACILITY == 1 )
                       3554     ; 
                       3555     ;       void vTaskStartTrace( signed portCHAR * pcBuffer, unsigned portSHORT usBufferSiz
                               e ) reentrant
                       3556     ;       {
                       3557     ;               portENTER_CRITICAL();
                       3558     ;               {
                       3559     ;                       pcTraceBuffer = ( volatile signed portCHAR * volatile )pcBuffer;
                       3560     ;                       pcTraceBufferStart = pcBuffer;
                       3561     ;                       pcTraceBufferEnd = pcBuffer + usBufferSize - tskSIZE_OF_EACH_TRA
                               CE_LINE;
                       3562     ;                       cTracing = ( signed portCHAR ) pdTRUE;
                       3563     ;               }
                       3564     ;               portEXIT_CRITICAL();
                       3565     ;       }
                       3566     ; 
                       3567     ; #endif
                       3568     ; /*----------------------------------------------------------*/
                       3569     ; 
                       3570     ; #if( USE_TRACE_FACILITY == 1 )
                       3571     ; 
                       3572     ;       unsigned portSHORT usTaskEndTrace( void ) reentrant
                       3573     ;       {
                       3574     ;       unsigned portSHORT usBufferLength;
                       3575     ; 
                       3576     ;               portENTER_CRITICAL();
                       3577     ;                       cTracing = ( signed portCHAR ) pdFALSE;
                       3578     ;               portEXIT_CRITICAL();
                       3579     ; 
                       3580     ;               usBufferLength = ( unsigned portSHORT ) ( pcTraceBuffer - pcTraceBufferS
                               tart );
                       3581     ; 
                       3582     ;               return usBufferLength;
                       3583     ;       }
                       3584     ; 
                       3585     ; #endif
                       3586     ; 
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    58

                       3587     ; 
                       3588     ; 
                       3589     ; 
                       3590     ; 
                       3591     ; 
                       3592     ; 
                       3593     ; /*-----------------------------------------------------------
                       3594     ;  * SCHEDULER INTERNALS AVAILABLE FOR PORTING PURPOSES
                       3595     ;  * documented in task.h
                       3596     ;  *----------------------------------------------------------*/
                       3597     ; 
                       3598     ; 
                       3599     ; inline void vTaskIncrementTick( void ) reentrant
                       3600     
------                 3601             RSEG  ?PR?_?vTaskIncrementTick?TASKS
000000                 3602     _?vTaskIncrementTick:
                       3603             USING   0
                       3604                             ; SOURCE LINE # 1043
000000 9000FFFD        3605             MOV     DPTR,#0FFFDH
000004 12000000   E    3606             LCALL   ?C?ADDXBP
                       3607     ; {
                       3608     ;       /* Called by the portable layer each time a tick interrupt occurs.
                       3609     ;       Increments the tick then checks to see if the new tick value will cause any
                       3610     ;       tasks to be unblocked. */
                       3611     ;       if( ucSchedulerSuspended == ( unsigned portCHAR ) pdFALSE )
                       3612                             ; SOURCE LINE # 1048
000008 90000000   F    3613             MOV     DPTR,#ucSchedulerSuspended
00000C E0              3614             MOVX    A,@DPTR
00000D 6003            3615             JZ      $ + 5H
00000F 010000     F    3616             AJMP    ?C0059
                       3617     ;       {
                       3618                             ; SOURCE LINE # 1049
                       3619     ;               ++xTickCount;
                       3620                             ; SOURCE LINE # 1050
000012 90000000   F    3621             MOV     DPTR,#xTickCount
000016 E0              3622             MOVX    A,@DPTR
000017 FC              3623             MOV     R4,A
000018 A3              3624             INC     DPTR
000019 E0              3625             MOVX    A,@DPTR
00001A FD              3626             MOV     R5,A
00001B A3              3627             INC     DPTR
00001C E0              3628             MOVX    A,@DPTR
00001D FE              3629             MOV     R6,A
00001E A3              3630             INC     DPTR
00001F E0              3631             MOVX    A,@DPTR
000020 2401            3632             ADD     A,#01H
000022 FF              3633             MOV     R7,A
000023 E4              3634             CLR     A
000024 3E              3635             ADDC    A,R6
000025 FE              3636             MOV     R6,A
000026 E4              3637             CLR     A
000027 3D              3638             ADDC    A,R5
000028 FD              3639             MOV     R5,A
000029 E4              3640             CLR     A
00002A 3C              3641             ADDC    A,R4
00002B FC              3642             MOV     R4,A
00002C 90000000   F    3643             MOV     DPTR,#xTickCount
000030 12000000   E    3644             LCALL   ?C?LSTXDATA
                       3645     ;               if( xTickCount == ( portTickType ) 0 )
                       3646                             ; SOURCE LINE # 1051
000034 E4              3647             CLR     A
000035 FF              3648             MOV     R7,A
000036 FE              3649             MOV     R6,A
000037 FD              3650             MOV     R5,A
000038 FC              3651             MOV     R4,A
000039 90000000   F    3652             MOV     DPTR,#xTickCount
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    59

00003D E0              3653             MOVX    A,@DPTR
00003E F8              3654             MOV     R0,A
00003F A3              3655             INC     DPTR
000040 E0              3656             MOVX    A,@DPTR
000041 F9              3657             MOV     R1,A
000042 A3              3658             INC     DPTR
000043 E0              3659             MOVX    A,@DPTR
000044 FA              3660             MOV     R2,A
000045 A3              3661             INC     DPTR
000046 E0              3662             MOVX    A,@DPTR
000047 FB              3663             MOV     R3,A
000048 C3              3664             CLR     C
000049 12000000   E    3665             LCALL   ?C?ULCMP
00004D 704F            3666             JNZ     ?C0061
                       3667     ;               {
                       3668                             ; SOURCE LINE # 1052
                       3669     ;                       volatile xList *pxTemp;
                       3670     ; 
                       3671     ;                       /* Tick count has overflowed so we need to swap the delay lists.
                                 If there are
                       3672     ;                       any items in pxDelayedTaskList here then there is an error! */
                       3673     ;                       pxTemp = pxDelayedTaskList;
                       3674                             ; SOURCE LINE # 1057
00004F 90000000   F    3675             MOV     DPTR,#pxDelayedTaskList
000053 E0              3676             MOVX    A,@DPTR
000054 F9              3677             MOV     R1,A
000055 A3              3678             INC     DPTR
000056 E0              3679             MOVX    A,@DPTR
000057 FA              3680             MOV     R2,A
000058 A3              3681             INC     DPTR
000059 E0              3682             MOVX    A,@DPTR
00005A 850083     E    3683             MOV     DPH,?C_XBP
00005D 850082     E    3684             MOV     DPL,?C_XBP+01H
000060 759300     E    3685             MOV     DPX,#?C?XDATASEG
000063 C9              3686             XCH     A,R1
000064 F0              3687             MOVX    @DPTR,A
000065 A3              3688             INC     DPTR
000066 EA              3689             MOV     A,R2
000067 F0              3690             MOVX    @DPTR,A
000068 A3              3691             INC     DPTR
000069 E9              3692             MOV     A,R1
00006A F0              3693             MOVX    @DPTR,A
                       3694     ;                       pxDelayedTaskList = pxOverflowDelayedTaskList;
                       3695                             ; SOURCE LINE # 1058
00006B 90000000   F    3696             MOV     DPTR,#pxOverflowDelayedTaskList
00006F E0              3697             MOVX    A,@DPTR
000070 F9              3698             MOV     R1,A
000071 A3              3699             INC     DPTR
000072 E0              3700             MOVX    A,@DPTR
000073 FA              3701             MOV     R2,A
000074 A3              3702             INC     DPTR
000075 E0              3703             MOVX    A,@DPTR
000076 90000000   F    3704             MOV     DPTR,#pxDelayedTaskList
00007A C9              3705             XCH     A,R1
00007B F0              3706             MOVX    @DPTR,A
00007C A3              3707             INC     DPTR
00007D EA              3708             MOV     A,R2
00007E F0              3709             MOVX    @DPTR,A
00007F A3              3710             INC     DPTR
000080 E9              3711             MOV     A,R1
000081 F0              3712             MOVX    @DPTR,A
                       3713     ;                       pxOverflowDelayedTaskList = pxTemp;
                       3714                             ; SOURCE LINE # 1059
000082 850083     E    3715             MOV     DPH,?C_XBP
000085 850082     E    3716             MOV     DPL,?C_XBP+01H
000088 759300     E    3717             MOV     DPX,#?C?XDATASEG
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    60

00008B E0              3718             MOVX    A,@DPTR
00008C F9              3719             MOV     R1,A
00008D A3              3720             INC     DPTR
00008E E0              3721             MOVX    A,@DPTR
00008F FA              3722             MOV     R2,A
000090 A3              3723             INC     DPTR
000091 E0              3724             MOVX    A,@DPTR
000092 90000000   F    3725             MOV     DPTR,#pxOverflowDelayedTaskList
000096 C9              3726             XCH     A,R1
000097 F0              3727             MOVX    @DPTR,A
000098 A3              3728             INC     DPTR
000099 EA              3729             MOV     A,R2
00009A F0              3730             MOVX    @DPTR,A
00009B A3              3731             INC     DPTR
00009C E9              3732             MOV     A,R1
00009D F0              3733             MOVX    @DPTR,A
                       3734     ;               }
                       3735                             ; SOURCE LINE # 1060
                       3736     ; 
                       3737     ;               /* See if this tick has made a timeout expire. */
                       3738     ;               prvCheckDelayedTasks();
                       3739                             ; SOURCE LINE # 1063
00009E                 3740     ?C0061:
00009E 90000000   F    3741             MOV     DPTR,#pxDelayedTaskList
0000A2 E0              3742             MOVX    A,@DPTR
0000A3 FB              3743             MOV     R3,A
0000A4 A3              3744             INC     DPTR
0000A5 E0              3745             MOVX    A,@DPTR
0000A6 FA              3746             MOV     R2,A
0000A7 A3              3747             INC     DPTR
0000A8 E0              3748             MOVX    A,@DPTR
0000A9 F9              3749             MOV     R1,A
0000AA 12000000   E    3750             LCALL   ?C?ILDPTR
0000AE 45F0            3751             ORL     A,B
0000B0 6023            3752             JZ      ?C0063
0000B2 E9              3753             MOV     A,R1
0000B3 2402            3754             ADD     A,#02H
0000B5 F9              3755             MOV     R1,A
0000B6 E4              3756             CLR     A
0000B7 3A              3757             ADDC    A,R2
0000B8 FA              3758             MOV     R2,A
0000B9 12000000   E    3759             LCALL   ?C?PLDPTR
0000BD E9              3760             MOV     A,R1
0000BE 2404            3761             ADD     A,#04H
0000C0 F9              3762             MOV     R1,A
0000C1 E4              3763             CLR     A
0000C2 3A              3764             ADDC    A,R2
0000C3 FA              3765             MOV     R2,A
0000C4 12000000   E    3766             LCALL   ?C?PLDPTR
0000C8 E9              3767             MOV     A,R1
0000C9 240A            3768             ADD     A,#0AH
0000CB F9              3769             MOV     R1,A
0000CC E4              3770             CLR     A
0000CD 3A              3771             ADDC    A,R2
0000CE FA              3772             MOV     R2,A
0000CF 12000000   E    3773             LCALL   ?C?PLDPTR
0000D3 8006            3774             SJMP    ?C0064
0000D5                 3775     ?C0063:
0000D5 7B00            3776             MOV     R3,#00H
0000D7 7A00            3777             MOV     R2,#00H
0000D9 7900            3778             MOV     R1,#00H
0000DB                 3779     ?C0064:
0000DB 850083     E    3780             MOV     DPH,?C_XBP
0000DE 850082     E    3781             MOV     DPL,?C_XBP+01H
0000E1 759300     E    3782             MOV     DPX,#?C?XDATASEG
0000E4 EB              3783             MOV     A,R3
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    61

0000E5 F0              3784             MOVX    @DPTR,A
0000E6 A3              3785             INC     DPTR
0000E7 EA              3786             MOV     A,R2
0000E8 F0              3787             MOVX    @DPTR,A
0000E9 A3              3788             INC     DPTR
0000EA E9              3789             MOV     A,R1
0000EB F0              3790             MOVX    @DPTR,A
0000EC 4A              3791             ORL     A,R2
0000ED 4B              3792             ORL     A,R3
0000EE 7003            3793             JNZ     $ + 5H
0000F0 010000     F    3794             AJMP    ?C0069
0000F3 850083     E    3795             MOV     DPH,?C_XBP
0000F6 850082     E    3796             MOV     DPL,?C_XBP+01H
0000F9 759300     E    3797             MOV     DPX,#?C?XDATASEG
0000FC E0              3798             MOVX    A,@DPTR
0000FD FB              3799             MOV     R3,A
0000FE A3              3800             INC     DPTR
0000FF E0              3801             MOVX    A,@DPTR
000100 FA              3802             MOV     R2,A
000101 A3              3803             INC     DPTR
000102 E0              3804             MOVX    A,@DPTR
000103 2419            3805             ADD     A,#019H
000105 F9              3806             MOV     R1,A
000106 E4              3807             CLR     A
000107 3A              3808             ADDC    A,R2
000108 FA              3809             MOV     R2,A
000109 12000000   E    3810             LCALL   ?C?LLDPTR
00010D 90000000   F    3811             MOV     DPTR,#xTickCount
000111 E0              3812             MOVX    A,@DPTR
000112 F8              3813             MOV     R0,A
000113 A3              3814             INC     DPTR
000114 E0              3815             MOVX    A,@DPTR
000115 F9              3816             MOV     R1,A
000116 A3              3817             INC     DPTR
000117 E0              3818             MOVX    A,@DPTR
000118 FA              3819             MOV     R2,A
000119 A3              3820             INC     DPTR
00011A E0              3821             MOVX    A,@DPTR
00011B FB              3822             MOV     R3,A
00011C C3              3823             CLR     C
00011D 12000000   E    3824             LCALL   ?C?ULCMP
000121 5003            3825             JNC     $ + 5H
000123 010000     F    3826             AJMP    ?C0069
000126                 3827     ?C0065:
000126 850083     E    3828             MOV     DPH,?C_XBP
000129 850082     E    3829             MOV     DPL,?C_XBP+01H
00012C 759300     E    3830             MOV     DPX,#?C?XDATASEG
00012F E0              3831             MOVX    A,@DPTR
000130 FB              3832             MOV     R3,A
000131 A3              3833             INC     DPTR
000132 E0              3834             MOVX    A,@DPTR
000133 FA              3835             MOV     R2,A
000134 A3              3836             INC     DPTR
000135 E0              3837             MOVX    A,@DPTR
000136 2419            3838             ADD     A,#019H
000138 F9              3839             MOV     R1,A
000139 E4              3840             CLR     A
00013A 3A              3841             ADDC    A,R2
00013B FA              3842             MOV     R2,A
00013C 12000000   E    3843             LCALL   _?vListRemove
000140 850083     E    3844             MOV     DPH,?C_XBP
000143 850082     E    3845             MOV     DPL,?C_XBP+01H
000146 759300     E    3846             MOV     DPX,#?C?XDATASEG
000149 E0              3847             MOVX    A,@DPTR
00014A FB              3848             MOV     R3,A
00014B A3              3849             INC     DPTR
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    62

00014C E0              3850             MOVX    A,@DPTR
00014D FA              3851             MOV     R2,A
00014E A3              3852             INC     DPTR
00014F E0              3853             MOVX    A,@DPTR
000150 2436            3854             ADD     A,#036H
000152 F9              3855             MOV     R1,A
000153 E4              3856             CLR     A
000154 3A              3857             ADDC    A,R2
000155 FA              3858             MOV     R2,A
000156 12000000   E    3859             LCALL   ?C?PLDPTR
00015A EA              3860             MOV     A,R2
00015B 49              3861             ORL     A,R1
00015C 4B              3862             ORL     A,R3
00015D 601A            3863             JZ      ?C0066
00015F 850083     E    3864             MOV     DPH,?C_XBP
000162 850082     E    3865             MOV     DPL,?C_XBP+01H
000165 759300     E    3866             MOV     DPX,#?C?XDATASEG
000168 E0              3867             MOVX    A,@DPTR
000169 FB              3868             MOV     R3,A
00016A A3              3869             INC     DPTR
00016B E0              3870             MOVX    A,@DPTR
00016C FA              3871             MOV     R2,A
00016D A3              3872             INC     DPTR
00016E E0              3873             MOVX    A,@DPTR
00016F 2429            3874             ADD     A,#029H
000171 F9              3875             MOV     R1,A
000172 E4              3876             CLR     A
000173 3A              3877             ADDC    A,R2
000174 FA              3878             MOV     R2,A
000175 12000000   E    3879             LCALL   _?vListRemove
000179                 3880     ?C0066:
000179 E4              3881             CLR     A
00017A FF              3882             MOV     R7,A
00017B FE              3883             MOV     R6,A
00017C FD              3884             MOV     R5,A
00017D FC              3885             MOV     R4,A
00017E 850083     E    3886             MOV     DPH,?C_XBP
000181 850082     E    3887             MOV     DPL,?C_XBP+01H
000184 759300     E    3888             MOV     DPX,#?C?XDATASEG
000187 E0              3889             MOVX    A,@DPTR
000188 FB              3890             MOV     R3,A
000189 A3              3891             INC     DPTR
00018A E0              3892             MOVX    A,@DPTR
00018B FA              3893             MOV     R2,A
00018C A3              3894             INC     DPTR
00018D E0              3895             MOVX    A,@DPTR
00018E 2419            3896             ADD     A,#019H
000190 F9              3897             MOV     R1,A
000191 E4              3898             CLR     A
000192 3A              3899             ADDC    A,R2
000193 FA              3900             MOV     R2,A
000194 12000000   E    3901             LCALL   ?C?LSTPTR
000198 850083     E    3902             MOV     DPH,?C_XBP
00019B 850082     E    3903             MOV     DPL,?C_XBP+01H
00019E 759300     E    3904             MOV     DPX,#?C?XDATASEG
0001A1 E0              3905             MOVX    A,@DPTR
0001A2 FB              3906             MOV     R3,A
0001A3 A3              3907             INC     DPTR
0001A4 E0              3908             MOVX    A,@DPTR
0001A5 FA              3909             MOV     R2,A
0001A6 A3              3910             INC     DPTR
0001A7 E0              3911             MOVX    A,@DPTR
0001A8 2418            3912             ADD     A,#018H
0001AA F9              3913             MOV     R1,A
0001AB E4              3914             CLR     A
0001AC 3A              3915             ADDC    A,R2
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    63

0001AD FA              3916             MOV     R2,A
0001AE 12000000   E    3917             LCALL   ?C?CLDPTR
0001B2 FF              3918             MOV     R7,A
0001B3 90000000   F    3919             MOV     DPTR,#ucTopReadyPriority
0001B7 E0              3920             MOVX    A,@DPTR
0001B8 FE              3921             MOV     R6,A
0001B9 EF              3922             MOV     A,R7
0001BA D3              3923             SETB    C
0001BB 9E              3924             SUBB    A,R6
0001BC 4002            3925             JC      ?C0067
0001BE EF              3926             MOV     A,R7
0001BF F0              3927             MOVX    @DPTR,A
0001C0                 3928     ?C0067:
0001C0 850083     E    3929             MOV     DPH,?C_XBP
0001C3 850082     E    3930             MOV     DPL,?C_XBP+01H
0001C6 759300     E    3931             MOV     DPX,#?C?XDATASEG
0001C9 E0              3932             MOVX    A,@DPTR
0001CA FB              3933             MOV     R3,A
0001CB A3              3934             INC     DPTR
0001CC E0              3935             MOVX    A,@DPTR
0001CD FA              3936             MOV     R2,A
0001CE A3              3937             INC     DPTR
0001CF E0              3938             MOVX    A,@DPTR
0001D0 2419            3939             ADD     A,#019H
0001D2 F9              3940             MOV     R1,A
0001D3 E4              3941             CLR     A
0001D4 3A              3942             ADDC    A,R2
0001D5 FA              3943             MOV     R2,A
0001D6 9000FFFD        3944             MOV     DPTR,#0FFFDH
0001DA 12000000   E    3945             LCALL   ?C?ADDXBP
0001DE EB              3946             MOV     A,R3
0001DF F0              3947             MOVX    @DPTR,A
0001E0 A3              3948             INC     DPTR
0001E1 EA              3949             MOV     A,R2
0001E2 F0              3950             MOVX    @DPTR,A
0001E3 A3              3951             INC     DPTR
0001E4 E9              3952             MOV     A,R1
0001E5 F0              3953             MOVX    @DPTR,A
0001E6 EF              3954             MOV     A,R7
0001E7 75F018          3955             MOV     B,#018H
0001EA A4              3956             MUL     AB
0001EB 2400       F    3957             ADD     A,#LOW (pxReadyTasksLists)
0001ED F9              3958             MOV     R1,A
0001EE 7400       F    3959             MOV     A,#HIGH (pxReadyTasksLists)
0001F0 35F0            3960             ADDC    A,B
0001F2 FA              3961             MOV     R2,A
0001F3 7B00       F    3962             MOV     R3,#MBYTE (pxReadyTasksLists)
0001F5 12000000   E    3963             LCALL   _?vListInsertEnd
0001F9 010000     F    3964             AJMP    ?C0061
                       3965     ;       }
                       3966                             ; SOURCE LINE # 1064
0001FC                 3967     ?C0059:
                       3968     ;       else
                       3969     ;       {
                       3970                             ; SOURCE LINE # 1066
                       3971     ;               ++ucMissedTicks;
                       3972                             ; SOURCE LINE # 1067
0001FC 90000000   F    3973             MOV     DPTR,#ucMissedTicks
000200 E0              3974             MOVX    A,@DPTR
000201 04              3975             INC     A
000202 F0              3976             MOVX    @DPTR,A
                       3977     ;       }
                       3978                             ; SOURCE LINE # 1068
                       3979     ; 
                       3980     ;       #if ( configUSE_TICK_HOOK == 1 )
                       3981     ;       {
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    64

                       3982     ;               extern void vApplicationTickHook( void );
                       3983     ; 
                       3984     ;               vApplicationTickHook();
                       3985     ;       }
                       3986     ;       #endif
                       3987     ; 
                       3988     ; }
                       3989                             ; SOURCE LINE # 1078
000203                 3990     ?C0069:
000203 90000003        3991             MOV     DPTR,#03H
000207 02000000   E    3992             LJMP    ?C?ADDXBP
                       3993     ; END OF _?vTaskIncrementTick
                       3994     
                       3995     ; /*-----------------------------------------------------------*/
                       3996     ; 
                       3997     ; #if( ( INCLUDE_vTaskCleanUpResources == 1 ) && ( INCLUDE_vTaskSuspend == 1 ) )
                       3998     ; 
                       3999     ;       void vTaskCleanUpResources( void ) reentrant
                       4000     ;       {
                       4001     ;       unsigned portSHORT usQueue;
                       4002     ;       volatile tskTCB *pxTCB;
                       4003     ; 
                       4004     ;               usQueue = ( unsigned portSHORT ) ucTopUsedPriority + ( unsigned portSHOR
                               T ) 1;
                       4005     ; 
                       4006     ;               /* Remove any TCB's from the ready queues. */
                       4007     ;               do
                       4008     ;               {
                       4009     ;                       usQueue--;
                       4010     ; 
                       4011     ;                       while( !listLIST_IS_EMPTY( &( pxReadyTasksLists[ usQueue ] ) ) )
                       4012     ;                       {
                       4013     ;                               listGET_OWNER_OF_NEXT_ENTRY( pxTCB, &( pxReadyTasksLists
                               [ usQueue ] ) )
                       4014     ;                               vListRemove( ( xListItem * ) &( pxTCB->xGenericListItem 
                               ) );
                       4015     ; 
                       4016     ;                               prvDeleteTCB( ( tskTCB * ) pxTCB );
                       4017     ;                       }
                       4018     ;               }while( usQueue > ( unsigned portSHORT ) tskIDLE_PRIORITY );
                       4019     ; 
                       4020     ;               /* Remove any TCB's from the delayed queue. */
                       4021     ;               while( !listLIST_IS_EMPTY( &xDelayedTaskList1 ) )
                       4022     ;               {
                       4023     ;                       listGET_OWNER_OF_NEXT_ENTRY( pxTCB, &xDelayedTaskList1 );
                       4024     ;                       vListRemove( ( xListItem * ) &( pxTCB->xGenericListItem ) );
                       4025     ; 
                       4026     ;                       prvDeleteTCB( ( tskTCB * ) pxTCB );
                       4027     ;               }
                       4028     ; 
                       4029     ;               /* Remove any TCB's from the overflow delayed queue. */
                       4030     ;               while( !listLIST_IS_EMPTY( &xDelayedTaskList2 ) )
                       4031     ;               {
                       4032     ;                       listGET_OWNER_OF_NEXT_ENTRY( pxTCB, &xDelayedTaskList2 );
                       4033     ;                       vListRemove( ( xListItem * ) &( pxTCB->xGenericListItem ) );
                       4034     ; 
                       4035     ;                       prvDeleteTCB( ( tskTCB * ) pxTCB );
                       4036     ;               }
                       4037     ; 
                       4038     ;               while( !listLIST_IS_EMPTY( &xSuspendedTaskList ) )
                       4039     ;               {
                       4040     ;                       listGET_OWNER_OF_NEXT_ENTRY( pxTCB, &xSuspendedTaskList );
                       4041     ;                       vListRemove( ( xListItem * ) &( pxTCB->xGenericListItem ) );
                       4042     ; 
                       4043     ;                       prvDeleteTCB( ( tskTCB * ) pxTCB );
                       4044     ;               }               
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    65

                       4045     ; 
                       4046     ;               while( !listLIST_IS_EMPTY( &xPendingReadyList ) )
                       4047     ;               {
                       4048     ;                       listGET_OWNER_OF_NEXT_ENTRY( pxTCB, &xPendingReadyList );
                       4049     ;                       vListRemove( ( xListItem * ) &( pxTCB->xGenericListItem ) );
                       4050     ; 
                       4051     ;                       prvDeleteTCB( ( tskTCB * ) pxTCB );
                       4052     ;               }               
                       4053     ;       }
                       4054     ; 
                       4055     ; #endif
                       4056     ; /*-----------------------------------------------------------*/
                       4057     ; 
                       4058     ; inline void vTaskSwitchContext( void ) reentrant
                       4059     
------                 4060             RSEG  ?PR?_?vTaskSwitchContext?TASKS
000000                 4061     _?vTaskSwitchContext:
                       4062             USING   0
                       4063                             ; SOURCE LINE # 1142
                       4064     ; {
                       4065     ;       if( ucSchedulerSuspended != pdFALSE )
                       4066                             ; SOURCE LINE # 1144
000000 90000000   F    4067             MOV     DPTR,#ucSchedulerSuspended
000004 E0              4068             MOVX    A,@DPTR
000005 6003            4069             JZ      $ + 5H
000007 010000     F    4070             AJMP    ?C0071
                       4071     ;       {
                       4072                             ; SOURCE LINE # 1145
                       4073     ;               /* The scheduler is currently suspended - do not allow a context
                       4074     ;               switch. */
                       4075     ;               return;
                       4076     ;       }
                       4077                             ; SOURCE LINE # 1149
00000A                 4078     ?C0070:
00000A                 4079     ?C0072:
                       4080     ; 
                       4081     ;       /* Find the highest priority queue that contains ready tasks. */
                       4082     ;       while( listLIST_IS_EMPTY( &( pxReadyTasksLists[ ucTopReadyPriority ] ) ) )
                       4083                             ; SOURCE LINE # 1152
00000A 90000000   F    4084             MOV     DPTR,#ucTopReadyPriority
00000E E0              4085             MOVX    A,@DPTR
00000F 75F018          4086             MOV     B,#018H
000012 A4              4087             MUL     AB
000013 2400       F    4088             ADD     A,#LOW (pxReadyTasksLists)
000015 F582            4089             MOV     DPL,A
000017 E4              4090             CLR     A
000018 3400       F    4091             ADDC    A,#HIGH (pxReadyTasksLists)
00001A F583            4092             MOV     DPH,A
00001C 759300     E    4093             MOV     DPX,#?C?XDATASEG
00001F E0              4094             MOVX    A,@DPTR
000020 FE              4095             MOV     R6,A
000021 A3              4096             INC     DPTR
000022 E0              4097             MOVX    A,@DPTR
000023 4E              4098             ORL     A,R6
000024 7009            4099             JNZ     ?C0073
                       4100     ;       {
                       4101                             ; SOURCE LINE # 1153
                       4102     ;               --ucTopReadyPriority;
                       4103                             ; SOURCE LINE # 1154
000026 90000000   F    4104             MOV     DPTR,#ucTopReadyPriority
00002A E0              4105             MOVX    A,@DPTR
00002B 14              4106             DEC     A
00002C F0              4107             MOVX    @DPTR,A
                       4108     ;       }
                       4109                             ; SOURCE LINE # 1155
00002D 80DB            4110             SJMP    ?C0072
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    66

00002F                 4111     ?C0073:
                       4112     ; 
                       4113     ;       /* listGET_OWNER_OF_NEXT_ENTRY walks through the list, so the tasks of the
                       4114     ;       same priority get an equal share of the processor time. */
                       4115     ;       listGET_OWNER_OF_NEXT_ENTRY( pxCurrentTCB, &( pxReadyTasksLists[ ucTopReadyPrior
                               ity ] ) );
                       4116                             ; SOURCE LINE # 1159
00002F 90000000   F    4117             MOV     DPTR,#ucTopReadyPriority
000033 E0              4118             MOVX    A,@DPTR
000034 75F018          4119             MOV     B,#018H
000037 A4              4120             MUL     AB
000038 2400       F    4121             ADD     A,#LOW (pxReadyTasksLists+05H)
00003A F582            4122             MOV     DPL,A
00003C E4              4123             CLR     A
00003D 3400       F    4124             ADDC    A,#HIGH (pxReadyTasksLists+05H)
00003F F583            4125             MOV     DPH,A
000041 759300     E    4126             MOV     DPX,#?C?XDATASEG
000044 E0              4127             MOVX    A,@DPTR
000045 FB              4128             MOV     R3,A
000046 A3              4129             INC     DPTR
000047 E0              4130             MOVX    A,@DPTR
000048 FA              4131             MOV     R2,A
000049 A3              4132             INC     DPTR
00004A E0              4133             MOVX    A,@DPTR
00004B 2404            4134             ADD     A,#04H
00004D F9              4135             MOV     R1,A
00004E E4              4136             CLR     A
00004F 3A              4137             ADDC    A,R2
000050 FA              4138             MOV     R2,A
000051 12000000   E    4139             LCALL   ?C?PLDPTR
000055 90000000   F    4140             MOV     DPTR,#ucTopReadyPriority
000059 E0              4141             MOVX    A,@DPTR
00005A 75F018          4142             MOV     B,#018H
00005D A4              4143             MUL     AB
00005E 2400       F    4144             ADD     A,#LOW (pxReadyTasksLists+05H)
000060 F582            4145             MOV     DPL,A
000062 E4              4146             CLR     A
000063 3400       F    4147             ADDC    A,#HIGH (pxReadyTasksLists+05H)
000065 F583            4148             MOV     DPH,A
000067 759300     E    4149             MOV     DPX,#?C?XDATASEG
00006A EB              4150             MOV     A,R3
00006B F0              4151             MOVX    @DPTR,A
00006C A3              4152             INC     DPTR
00006D EA              4153             MOV     A,R2
00006E F0              4154             MOVX    @DPTR,A
00006F A3              4155             INC     DPTR
000070 E9              4156             MOV     A,R1
000071 F0              4157             MOVX    @DPTR,A
000072 90000000   F    4158             MOV     DPTR,#ucTopReadyPriority
000076 E0              4159             MOVX    A,@DPTR
000077 75F018          4160             MOV     B,#018H
00007A A4              4161             MUL     AB
00007B 2400       F    4162             ADD     A,#LOW (pxReadyTasksLists+02H)
00007D F582            4163             MOV     DPL,A
00007F E4              4164             CLR     A
000080 3400       F    4165             ADDC    A,#HIGH (pxReadyTasksLists+02H)
000082 F583            4166             MOV     DPH,A
000084 759300     E    4167             MOV     DPX,#?C?XDATASEG
000087 E0              4168             MOVX    A,@DPTR
000088 FB              4169             MOV     R3,A
000089 A3              4170             INC     DPTR
00008A E0              4171             MOVX    A,@DPTR
00008B FA              4172             MOV     R2,A
00008C A3              4173             INC     DPTR
00008D E0              4174             MOVX    A,@DPTR
00008E F9              4175             MOV     R1,A
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    67

00008F C003            4176             PUSH    AR3
000091 C002            4177             PUSH    AR2
000093 C001            4178             PUSH    AR1
000095 90000000   F    4179             MOV     DPTR,#ucTopReadyPriority
000099 E0              4180             MOVX    A,@DPTR
00009A 75F018          4181             MOV     B,#018H
00009D A4              4182             MUL     AB
00009E 2400       F    4183             ADD     A,#LOW (pxReadyTasksLists+05H)
0000A0 F582            4184             MOV     DPL,A
0000A2 E4              4185             CLR     A
0000A3 3400       F    4186             ADDC    A,#HIGH (pxReadyTasksLists+05H)
0000A5 F583            4187             MOV     DPH,A
0000A7 759300     E    4188             MOV     DPX,#?C?XDATASEG
0000AA E0              4189             MOVX    A,@DPTR
0000AB FB              4190             MOV     R3,A
0000AC A3              4191             INC     DPTR
0000AD E0              4192             MOVX    A,@DPTR
0000AE FA              4193             MOV     R2,A
0000AF A3              4194             INC     DPTR
0000B0 E0              4195             MOVX    A,@DPTR
0000B1 F9              4196             MOV     R1,A
0000B2 D082            4197             POP     DPL
0000B4 D083            4198             POP     DPH
0000B6 D0E0            4199             POP     ACC
0000B8 6B              4200             XRL     A,R3
0000B9 7008            4201             JNZ     ?C0116
0000BB E9              4202             MOV     A,R1
0000BC 6582            4203             XRL     A,DPL
0000BE 7003            4204             JNZ     ?C0116
0000C0 EA              4205             MOV     A,R2
0000C1 6583            4206             XRL     A,DPH
0000C3                 4207     ?C0116:
0000C3 7043            4208             JNZ     ?C0074
0000C5 90000000   F    4209             MOV     DPTR,#ucTopReadyPriority
0000C9 E0              4210             MOVX    A,@DPTR
0000CA 75F018          4211             MOV     B,#018H
0000CD A4              4212             MUL     AB
0000CE 2400       F    4213             ADD     A,#LOW (pxReadyTasksLists+05H)
0000D0 F582            4214             MOV     DPL,A
0000D2 E4              4215             CLR     A
0000D3 3400       F    4216             ADDC    A,#HIGH (pxReadyTasksLists+05H)
0000D5 F583            4217             MOV     DPH,A
0000D7 759300     E    4218             MOV     DPX,#?C?XDATASEG
0000DA E0              4219             MOVX    A,@DPTR
0000DB FB              4220             MOV     R3,A
0000DC A3              4221             INC     DPTR
0000DD E0              4222             MOVX    A,@DPTR
0000DE FA              4223             MOV     R2,A
0000DF A3              4224             INC     DPTR
0000E0 E0              4225             MOVX    A,@DPTR
0000E1 2404            4226             ADD     A,#04H
0000E3 F9              4227             MOV     R1,A
0000E4 E4              4228             CLR     A
0000E5 3A              4229             ADDC    A,R2
0000E6 FA              4230             MOV     R2,A
0000E7 12000000   E    4231             LCALL   ?C?PLDPTR
0000EB 90000000   F    4232             MOV     DPTR,#ucTopReadyPriority
0000EF E0              4233             MOVX    A,@DPTR
0000F0 75F018          4234             MOV     B,#018H
0000F3 A4              4235             MUL     AB
0000F4 2400       F    4236             ADD     A,#LOW (pxReadyTasksLists+05H)
0000F6 F582            4237             MOV     DPL,A
0000F8 E4              4238             CLR     A
0000F9 3400       F    4239             ADDC    A,#HIGH (pxReadyTasksLists+05H)
0000FB F583            4240             MOV     DPH,A
0000FD 759300     E    4241             MOV     DPX,#?C?XDATASEG
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    68

000100 EB              4242             MOV     A,R3
000101 F0              4243             MOVX    @DPTR,A
000102 A3              4244             INC     DPTR
000103 EA              4245             MOV     A,R2
000104 F0              4246             MOVX    @DPTR,A
000105 A3              4247             INC     DPTR
000106 E9              4248             MOV     A,R1
000107 F0              4249             MOVX    @DPTR,A
000108                 4250     ?C0074:
000108 90000000   F    4251             MOV     DPTR,#ucTopReadyPriority
00010C E0              4252             MOVX    A,@DPTR
00010D 75F018          4253             MOV     B,#018H
000110 A4              4254             MUL     AB
000111 2400       F    4255             ADD     A,#LOW (pxReadyTasksLists+05H)
000113 F582            4256             MOV     DPL,A
000115 E4              4257             CLR     A
000116 3400       F    4258             ADDC    A,#HIGH (pxReadyTasksLists+05H)
000118 F583            4259             MOV     DPH,A
00011A 759300     E    4260             MOV     DPX,#?C?XDATASEG
00011D E0              4261             MOVX    A,@DPTR
00011E FB              4262             MOV     R3,A
00011F A3              4263             INC     DPTR
000120 E0              4264             MOVX    A,@DPTR
000121 FA              4265             MOV     R2,A
000122 A3              4266             INC     DPTR
000123 E0              4267             MOVX    A,@DPTR
000124 240A            4268             ADD     A,#0AH
000126 F9              4269             MOV     R1,A
000127 E4              4270             CLR     A
000128 3A              4271             ADDC    A,R2
000129 FA              4272             MOV     R2,A
00012A 12000000   E    4273             LCALL   ?C?PLDPTR
00012E 90000000   F    4274             MOV     DPTR,#pxCurrentTCB
000132 EB              4275             MOV     A,R3
000133 F0              4276             MOVX    @DPTR,A
000134 A3              4277             INC     DPTR
000135 EA              4278             MOV     A,R2
000136 F0              4279             MOVX    @DPTR,A
000137 A3              4280             INC     DPTR
000138 E9              4281             MOV     A,R1
000139 F0              4282             MOVX    @DPTR,A
                       4283     ;       vWriteTraceToBuffer();
                       4284     ; }
                       4285                             ; SOURCE LINE # 1161
00013A                 4286     ?C0071:
00013A 22              4287             RET     
                       4288     ; END OF _?vTaskSwitchContext
                       4289     
                       4290     ; /*-----------------------------------------------------------*/
                       4291     ; 
                       4292     ; void vTaskPlaceOnEventList( xList *pxEventList, portTickType xTicksToWait ) reentrant
                       4293     
------                 4294             RSEG  ?PR?_?vTaskPlaceOnEventList?TASKS
000000                 4295     _?vTaskPlaceOnEventList:
                       4296             USING   0
                       4297                             ; SOURCE LINE # 1164
000000 9000FFFC        4298             MOV     DPTR,#0FFFCH
000004 12000000   E    4299             LCALL   ?C?ADDXBP
000008 12000000   E    4300             LCALL   ?C?LSTXDATA
00000C 9000FFFD        4301             MOV     DPTR,#0FFFDH
000010 12000000   E    4302             LCALL   ?C?ADDXBP
000014 EB              4303             MOV     A,R3
000015 F0              4304             MOVX    @DPTR,A
000016 A3              4305             INC     DPTR
000017 EA              4306             MOV     A,R2
000018 F0              4307             MOVX    @DPTR,A
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    69

000019 A3              4308             INC     DPTR
00001A E9              4309             MOV     A,R1
00001B F0              4310             MOVX    @DPTR,A
00001C 9000FFFC        4311             MOV     DPTR,#0FFFCH
000020 12000000   E    4312             LCALL   ?C?ADDXBP
                       4313     ; {
                       4314     ; portTickType xTimeToWake;
                       4315     ; 
                       4316     ;       /* THIS FUNCTION MUST BE CALLED WITH INTERRUPTS DISABLED OR THE
                       4317     ;       SCHEDULER SUSPENDED. */
                       4318     ; 
                       4319     ;       /* Place the event list item of the TCB in the appropriate event list.
                       4320     ;       This is placed in the list in priority order so the highest priority task
                       4321     ;       is the first to be woken by the event. */
                       4322     ;       vListInsert( ( xList * ) pxEventList, ( xListItem * ) &( pxCurrentTCB->xEventLis
                               tItem ) );
                       4323                             ; SOURCE LINE # 1174
000024 90000000   F    4324             MOV     DPTR,#pxCurrentTCB
000028 E0              4325             MOVX    A,@DPTR
000029 FB              4326             MOV     R3,A
00002A A3              4327             INC     DPTR
00002B E0              4328             MOVX    A,@DPTR
00002C FA              4329             MOV     R2,A
00002D A3              4330             INC     DPTR
00002E E0              4331             MOVX    A,@DPTR
00002F 2429            4332             ADD     A,#029H
000031 F9              4333             MOV     R1,A
000032 E4              4334             CLR     A
000033 3A              4335             ADDC    A,R2
000034 FA              4336             MOV     R2,A
000035 9000FFFD        4337             MOV     DPTR,#0FFFDH
000039 12000000   E    4338             LCALL   ?C?ADDXBP
00003D EB              4339             MOV     A,R3
00003E F0              4340             MOVX    @DPTR,A
00003F A3              4341             INC     DPTR
000040 EA              4342             MOV     A,R2
000041 F0              4343             MOVX    @DPTR,A
000042 A3              4344             INC     DPTR
000043 E9              4345             MOV     A,R1
000044 F0              4346             MOVX    @DPTR,A
000045 90000007        4347             MOV     DPTR,#07H
000049 12000000   E    4348             LCALL   ?C?XBPOFF
00004D E0              4349             MOVX    A,@DPTR
00004E FB              4350             MOV     R3,A
00004F A3              4351             INC     DPTR
000050 E0              4352             MOVX    A,@DPTR
000051 FA              4353             MOV     R2,A
000052 A3              4354             INC     DPTR
000053 E0              4355             MOVX    A,@DPTR
000054 F9              4356             MOV     R1,A
000055 12000000   E    4357             LCALL   _?vListInsert
                       4358     ; 
                       4359     ;       /* Calculate the time at which the task should be woken if the event does
                       4360     ;       not occur.  This may overflow but this doesn't matter. */
                       4361     ;       xTimeToWake = xTickCount + xTicksToWait;
                       4362                             ; SOURCE LINE # 1178
000059 90000007        4363             MOV     DPTR,#07H
00005D 12000000   E    4364             LCALL   ?C?XBPOFF
000061 E0              4365             MOVX    A,@DPTR
000062 FC              4366             MOV     R4,A
000063 A3              4367             INC     DPTR
000064 E0              4368             MOVX    A,@DPTR
000065 FD              4369             MOV     R5,A
000066 A3              4370             INC     DPTR
000067 E0              4371             MOVX    A,@DPTR
000068 FE              4372             MOV     R6,A
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    70

000069 A3              4373             INC     DPTR
00006A E0              4374             MOVX    A,@DPTR
00006B FF              4375             MOV     R7,A
00006C 90000000   F    4376             MOV     DPTR,#xTickCount
000070 E0              4377             MOVX    A,@DPTR
000071 F8              4378             MOV     R0,A
000072 A3              4379             INC     DPTR
000073 E0              4380             MOVX    A,@DPTR
000074 F9              4381             MOV     R1,A
000075 A3              4382             INC     DPTR
000076 E0              4383             MOVX    A,@DPTR
000077 FA              4384             MOV     R2,A
000078 A3              4385             INC     DPTR
000079 E0              4386             MOVX    A,@DPTR
00007A 2F              4387             ADD     A,R7
00007B FF              4388             MOV     R7,A
00007C EA              4389             MOV     A,R2
00007D 3E              4390             ADDC    A,R6
00007E FE              4391             MOV     R6,A
00007F E9              4392             MOV     A,R1
000080 3D              4393             ADDC    A,R5
000081 FD              4394             MOV     R5,A
000082 E8              4395             MOV     A,R0
000083 3C              4396             ADDC    A,R4
000084 FC              4397             MOV     R4,A
000085 850083     E    4398             MOV     DPH,?C_XBP
000088 850082     E    4399             MOV     DPL,?C_XBP+01H
00008B 759300     E    4400             MOV     DPX,#?C?XDATASEG
00008E 12000000   E    4401             LCALL   ?C?LSTXDATA
                       4402     ; 
                       4403     ;       /* We must remove ourselves from the ready list before adding ourselves
                       4404     ;       to the blocked list as the same list item is used for both lists.  We have
                       4405     ;       exclusive access to the ready lists as the scheduler is locked. */
                       4406     ;       vListRemove( ( xListItem * ) &( pxCurrentTCB->xGenericListItem ) );
                       4407                             ; SOURCE LINE # 1183
000092 90000000   F    4408             MOV     DPTR,#pxCurrentTCB
000096 E0              4409             MOVX    A,@DPTR
000097 FB              4410             MOV     R3,A
000098 A3              4411             INC     DPTR
000099 E0              4412             MOVX    A,@DPTR
00009A FA              4413             MOV     R2,A
00009B A3              4414             INC     DPTR
00009C E0              4415             MOVX    A,@DPTR
00009D 2419            4416             ADD     A,#019H
00009F F9              4417             MOV     R1,A
0000A0 E4              4418             CLR     A
0000A1 3A              4419             ADDC    A,R2
0000A2 FA              4420             MOV     R2,A
0000A3 12000000   E    4421             LCALL   _?vListRemove
                       4422     ; 
                       4423     ;       listSET_LIST_ITEM_VALUE( &( pxCurrentTCB->xGenericListItem ), xTimeToWake );
                       4424                             ; SOURCE LINE # 1185
0000A7 850083     E    4425             MOV     DPH,?C_XBP
0000AA 850082     E    4426             MOV     DPL,?C_XBP+01H
0000AD 759300     E    4427             MOV     DPX,#?C?XDATASEG
0000B0 E0              4428             MOVX    A,@DPTR
0000B1 FC              4429             MOV     R4,A
0000B2 A3              4430             INC     DPTR
0000B3 E0              4431             MOVX    A,@DPTR
0000B4 FD              4432             MOV     R5,A
0000B5 A3              4433             INC     DPTR
0000B6 E0              4434             MOVX    A,@DPTR
0000B7 FE              4435             MOV     R6,A
0000B8 A3              4436             INC     DPTR
0000B9 E0              4437             MOVX    A,@DPTR
0000BA FF              4438             MOV     R7,A
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    71

0000BB 90000000   F    4439             MOV     DPTR,#pxCurrentTCB
0000BF E0              4440             MOVX    A,@DPTR
0000C0 FB              4441             MOV     R3,A
0000C1 A3              4442             INC     DPTR
0000C2 E0              4443             MOVX    A,@DPTR
0000C3 FA              4444             MOV     R2,A
0000C4 A3              4445             INC     DPTR
0000C5 E0              4446             MOVX    A,@DPTR
0000C6 2419            4447             ADD     A,#019H
0000C8 F9              4448             MOV     R1,A
0000C9 E4              4449             CLR     A
0000CA 3A              4450             ADDC    A,R2
0000CB FA              4451             MOV     R2,A
0000CC 12000000   E    4452             LCALL   ?C?LSTPTR
                       4453     ; 
                       4454     ;       if( xTimeToWake < xTickCount )
                       4455                             ; SOURCE LINE # 1187
0000D0 90000000   F    4456             MOV     DPTR,#xTickCount
0000D4 E0              4457             MOVX    A,@DPTR
0000D5 FC              4458             MOV     R4,A
0000D6 A3              4459             INC     DPTR
0000D7 E0              4460             MOVX    A,@DPTR
0000D8 FD              4461             MOV     R5,A
0000D9 A3              4462             INC     DPTR
0000DA E0              4463             MOVX    A,@DPTR
0000DB FE              4464             MOV     R6,A
0000DC A3              4465             INC     DPTR
0000DD E0              4466             MOVX    A,@DPTR
0000DE FF              4467             MOV     R7,A
0000DF 850083     E    4468             MOV     DPH,?C_XBP
0000E2 850082     E    4469             MOV     DPL,?C_XBP+01H
0000E5 759300     E    4470             MOV     DPX,#?C?XDATASEG
0000E8 E0              4471             MOVX    A,@DPTR
0000E9 F8              4472             MOV     R0,A
0000EA A3              4473             INC     DPTR
0000EB E0              4474             MOVX    A,@DPTR
0000EC F9              4475             MOV     R1,A
0000ED A3              4476             INC     DPTR
0000EE E0              4477             MOVX    A,@DPTR
0000EF FA              4478             MOV     R2,A
0000F0 A3              4479             INC     DPTR
0000F1 E0              4480             MOVX    A,@DPTR
0000F2 FB              4481             MOV     R3,A
0000F3 C3              4482             CLR     C
0000F4 12000000   E    4483             LCALL   ?C?ULCMP
0000F8 90000000   F    4484             MOV     DPTR,#pxCurrentTCB
0000FC E0              4485             MOVX    A,@DPTR
0000FD FB              4486             MOV     R3,A
0000FE 5021            4487             JNC     ?C0075
                       4488     ;       {
                       4489                             ; SOURCE LINE # 1188
                       4490     ;               /* Wake time has overflowed.  Place this item in the overflow list. */
                       4491     ;               vListInsert( ( xList * ) pxOverflowDelayedTaskList, ( xListItem * ) &( p
                               xCurrentTCB->xGenericListItem ) );
                       4492                             ; SOURCE LINE # 1190
000100 A3              4493             INC     DPTR
000101 E0              4494             MOVX    A,@DPTR
000102 FA              4495             MOV     R2,A
000103 A3              4496             INC     DPTR
000104 E0              4497             MOVX    A,@DPTR
000105 2419            4498             ADD     A,#019H
000107 F9              4499             MOV     R1,A
000108 E4              4500             CLR     A
000109 3A              4501             ADDC    A,R2
00010A FA              4502             MOV     R2,A
00010B 9000FFFD        4503             MOV     DPTR,#0FFFDH
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    72

00010F 12000000   E    4504             LCALL   ?C?ADDXBP
000113 EB              4505             MOV     A,R3
000114 F0              4506             MOVX    @DPTR,A
000115 A3              4507             INC     DPTR
000116 EA              4508             MOV     A,R2
000117 F0              4509             MOVX    @DPTR,A
000118 A3              4510             INC     DPTR
000119 E9              4511             MOV     A,R1
00011A F0              4512             MOVX    @DPTR,A
00011B 90000000   F    4513             MOV     DPTR,#pxOverflowDelayedTaskList
                       4514     ;       }
                       4515                             ; SOURCE LINE # 1191
00011F 801F            4516             SJMP    ?C0123
000121                 4517     ?C0075:
                       4518     ;       else
                       4519     ;       {
                       4520                             ; SOURCE LINE # 1193
                       4521     ;               /* The wake time has not overflowed, so we can use the current block lis
                               t. */
                       4522     ;               vListInsert( ( xList * ) pxDelayedTaskList, ( xListItem * ) &( pxCurrent
                               TCB->xGenericListItem ) );
                       4523                             ; SOURCE LINE # 1195
000121 A3              4524             INC     DPTR
000122 E0              4525             MOVX    A,@DPTR
000123 FA              4526             MOV     R2,A
000124 A3              4527             INC     DPTR
000125 E0              4528             MOVX    A,@DPTR
000126 2419            4529             ADD     A,#019H
000128 F9              4530             MOV     R1,A
000129 E4              4531             CLR     A
00012A 3A              4532             ADDC    A,R2
00012B FA              4533             MOV     R2,A
00012C 9000FFFD        4534             MOV     DPTR,#0FFFDH
000130 12000000   E    4535             LCALL   ?C?ADDXBP
000134 EB              4536             MOV     A,R3
000135 F0              4537             MOVX    @DPTR,A
000136 A3              4538             INC     DPTR
000137 EA              4539             MOV     A,R2
000138 F0              4540             MOVX    @DPTR,A
000139 A3              4541             INC     DPTR
00013A E9              4542             MOV     A,R1
00013B F0              4543             MOVX    @DPTR,A
00013C 90000000   F    4544             MOV     DPTR,#pxDelayedTaskList
000140                 4545     ?C0123:
000140 E0              4546             MOVX    A,@DPTR
000141 FB              4547             MOV     R3,A
000142 A3              4548             INC     DPTR
000143 E0              4549             MOVX    A,@DPTR
000144 FA              4550             MOV     R2,A
000145 A3              4551             INC     DPTR
000146 E0              4552             MOVX    A,@DPTR
000147 F9              4553             MOV     R1,A
000148 12000000   E    4554             LCALL   _?vListInsert
                       4555     ;       }
                       4556                             ; SOURCE LINE # 1196
                       4557     ; }
                       4558                             ; SOURCE LINE # 1197
00014C                 4559     ?C0077:
00014C 9000000B        4560             MOV     DPTR,#0BH
000150 02000000   E    4561             LJMP    ?C?ADDXBP
                       4562     ; END OF _?vTaskPlaceOnEventList
                       4563     
                       4564     ; /*-----------------------------------------------------------*/
                       4565     ; 
                       4566     ; signed portCHAR cTaskRemoveFromEventList( const xList *pxEventList ) reentrant
                       4567     
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    73

------                 4568             RSEG  ?PR?_?cTaskRemoveFromEventList?TASKS
000000                 4569     _?cTaskRemoveFromEventList:
                       4570             USING   0
                       4571                             ; SOURCE LINE # 1200
000000 9000FFFD        4572             MOV     DPTR,#0FFFDH
000004 12000000   E    4573             LCALL   ?C?ADDXBP
000008 EB              4574             MOV     A,R3
000009 F0              4575             MOVX    @DPTR,A
00000A A3              4576             INC     DPTR
00000B EA              4577             MOV     A,R2
00000C F0              4578             MOVX    @DPTR,A
00000D A3              4579             INC     DPTR
00000E E9              4580             MOV     A,R1
00000F F0              4581             MOVX    @DPTR,A
000010 9000FFFD        4582             MOV     DPTR,#0FFFDH
000014 12000000   E    4583             LCALL   ?C?ADDXBP
                       4584     ; {
                       4585     ; tskTCB *pxUnblockedTCB;
                       4586     ; 
                       4587     ;       /* THIS FUNCTION MUST BE CALLED WITH INTERRUPTS DISABLED OR THE
                       4588     ;       SCHEDULER SUSPENDED.  It can also be called from within an ISR. */
                       4589     ; 
                       4590     ;       /* The event list is sorted in priority order, so we can remove the 
                       4591     ;       first in the list, remove the TCB from the delayed list, and add
                       4592     ;       it to the ready list. 
                       4593     ;       
                       4594     ;       If an event is for a queue that is locked then this function will never
                       4595     ;       get called - the lock count on the queue will get modified instead.  This
                       4596     ;       means we can always expect exclusive access to the event list here. */
                       4597     ;       pxUnblockedTCB = ( tskTCB * ) listGET_OWNER_OF_HEAD_ENTRY( pxEventList );
                       4598                             ; SOURCE LINE # 1214
000018 90000003        4599             MOV     DPTR,#03H
00001C 12000000   E    4600             LCALL   ?C?XBPOFF
000020 E0              4601             MOVX    A,@DPTR
000021 FB              4602             MOV     R3,A
000022 A3              4603             INC     DPTR
000023 E0              4604             MOVX    A,@DPTR
000024 FA              4605             MOV     R2,A
000025 A3              4606             INC     DPTR
000026 E0              4607             MOVX    A,@DPTR
000027 F9              4608             MOV     R1,A
000028 12000000   E    4609             LCALL   ?C?ILDPTR
00002C 45F0            4610             ORL     A,B
00002E 6023            4611             JZ      ?C0078
000030 E9              4612             MOV     A,R1
000031 2402            4613             ADD     A,#02H
000033 F9              4614             MOV     R1,A
000034 E4              4615             CLR     A
000035 3A              4616             ADDC    A,R2
000036 FA              4617             MOV     R2,A
000037 12000000   E    4618             LCALL   ?C?PLDPTR
00003B E9              4619             MOV     A,R1
00003C 2404            4620             ADD     A,#04H
00003E F9              4621             MOV     R1,A
00003F E4              4622             CLR     A
000040 3A              4623             ADDC    A,R2
000041 FA              4624             MOV     R2,A
000042 12000000   E    4625             LCALL   ?C?PLDPTR
000046 E9              4626             MOV     A,R1
000047 240A            4627             ADD     A,#0AH
000049 F9              4628             MOV     R1,A
00004A E4              4629             CLR     A
00004B 3A              4630             ADDC    A,R2
00004C FA              4631             MOV     R2,A
00004D 12000000   E    4632             LCALL   ?C?PLDPTR
000051 8006            4633             SJMP    ?C0079
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    74

000053                 4634     ?C0078:
000053 7B00            4635             MOV     R3,#00H
000055 7A00            4636             MOV     R2,#00H
000057 7900            4637             MOV     R1,#00H
000059                 4638     ?C0079:
000059 850083     E    4639             MOV     DPH,?C_XBP
00005C 850082     E    4640             MOV     DPL,?C_XBP+01H
00005F 759300     E    4641             MOV     DPX,#?C?XDATASEG
000062 EB              4642             MOV     A,R3
000063 F0              4643             MOVX    @DPTR,A
000064 A3              4644             INC     DPTR
000065 EA              4645             MOV     A,R2
000066 F0              4646             MOVX    @DPTR,A
000067 A3              4647             INC     DPTR
000068 E9              4648             MOV     A,R1
000069 F0              4649             MOVX    @DPTR,A
                       4650     ;       vListRemove( &( pxUnblockedTCB->xEventListItem ) );
                       4651                             ; SOURCE LINE # 1215
00006A 850083     E    4652             MOV     DPH,?C_XBP
00006D 850082     E    4653             MOV     DPL,?C_XBP+01H
000070 759300     E    4654             MOV     DPX,#?C?XDATASEG
000073 E0              4655             MOVX    A,@DPTR
000074 FB              4656             MOV     R3,A
000075 A3              4657             INC     DPTR
000076 E0              4658             MOVX    A,@DPTR
000077 FA              4659             MOV     R2,A
000078 A3              4660             INC     DPTR
000079 E0              4661             MOVX    A,@DPTR
00007A 2429            4662             ADD     A,#029H
00007C F9              4663             MOV     R1,A
00007D E4              4664             CLR     A
00007E 3A              4665             ADDC    A,R2
00007F FA              4666             MOV     R2,A
000080 12000000   E    4667             LCALL   _?vListRemove
                       4668     ; 
                       4669     ;       if( ucSchedulerSuspended == ( unsigned portCHAR ) pdFALSE )
                       4670                             ; SOURCE LINE # 1217
000084 90000000   F    4671             MOV     DPTR,#ucSchedulerSuspended
000088 E0              4672             MOVX    A,@DPTR
000089 6003            4673             JZ      $ + 5H
00008B 010000     F    4674             AJMP    ?C0080
                       4675     ;       {
                       4676                             ; SOURCE LINE # 1218
                       4677     ;               vListRemove( &( pxUnblockedTCB->xGenericListItem ) );
                       4678                             ; SOURCE LINE # 1219
00008E 850083     E    4679             MOV     DPH,?C_XBP
000091 850082     E    4680             MOV     DPL,?C_XBP+01H
000094 759300     E    4681             MOV     DPX,#?C?XDATASEG
000097 E0              4682             MOVX    A,@DPTR
000098 FB              4683             MOV     R3,A
000099 A3              4684             INC     DPTR
00009A E0              4685             MOVX    A,@DPTR
00009B FA              4686             MOV     R2,A
00009C A3              4687             INC     DPTR
00009D E0              4688             MOVX    A,@DPTR
00009E 2419            4689             ADD     A,#019H
0000A0 F9              4690             MOV     R1,A
0000A1 E4              4691             CLR     A
0000A2 3A              4692             ADDC    A,R2
0000A3 FA              4693             MOV     R2,A
0000A4 12000000   E    4694             LCALL   _?vListRemove
                       4695     ;               prvAddTaskToReadyQueue( pxUnblockedTCB );
                       4696                             ; SOURCE LINE # 1220
0000A8 E4              4697             CLR     A
0000A9 FF              4698             MOV     R7,A
0000AA FE              4699             MOV     R6,A
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    75

0000AB FD              4700             MOV     R5,A
0000AC FC              4701             MOV     R4,A
0000AD 850083     E    4702             MOV     DPH,?C_XBP
0000B0 850082     E    4703             MOV     DPL,?C_XBP+01H
0000B3 759300     E    4704             MOV     DPX,#?C?XDATASEG
0000B6 E0              4705             MOVX    A,@DPTR
0000B7 FB              4706             MOV     R3,A
0000B8 A3              4707             INC     DPTR
0000B9 E0              4708             MOVX    A,@DPTR
0000BA FA              4709             MOV     R2,A
0000BB A3              4710             INC     DPTR
0000BC E0              4711             MOVX    A,@DPTR
0000BD 2419            4712             ADD     A,#019H
0000BF F9              4713             MOV     R1,A
0000C0 E4              4714             CLR     A
0000C1 3A              4715             ADDC    A,R2
0000C2 FA              4716             MOV     R2,A
0000C3 12000000   E    4717             LCALL   ?C?LSTPTR
0000C7 850083     E    4718             MOV     DPH,?C_XBP
0000CA 850082     E    4719             MOV     DPL,?C_XBP+01H
0000CD 759300     E    4720             MOV     DPX,#?C?XDATASEG
0000D0 E0              4721             MOVX    A,@DPTR
0000D1 FB              4722             MOV     R3,A
0000D2 A3              4723             INC     DPTR
0000D3 E0              4724             MOVX    A,@DPTR
0000D4 FA              4725             MOV     R2,A
0000D5 A3              4726             INC     DPTR
0000D6 E0              4727             MOVX    A,@DPTR
0000D7 2418            4728             ADD     A,#018H
0000D9 F9              4729             MOV     R1,A
0000DA E4              4730             CLR     A
0000DB 3A              4731             ADDC    A,R2
0000DC FA              4732             MOV     R2,A
0000DD 12000000   E    4733             LCALL   ?C?CLDPTR
0000E1 FF              4734             MOV     R7,A
0000E2 90000000   F    4735             MOV     DPTR,#ucTopReadyPriority
0000E6 E0              4736             MOVX    A,@DPTR
0000E7 FE              4737             MOV     R6,A
0000E8 EF              4738             MOV     A,R7
0000E9 D3              4739             SETB    C
0000EA 9E              4740             SUBB    A,R6
0000EB 4002            4741             JC      ?C0081
0000ED EF              4742             MOV     A,R7
0000EE F0              4743             MOVX    @DPTR,A
0000EF                 4744     ?C0081:
0000EF 850083     E    4745             MOV     DPH,?C_XBP
0000F2 850082     E    4746             MOV     DPL,?C_XBP+01H
0000F5 759300     E    4747             MOV     DPX,#?C?XDATASEG
0000F8 E0              4748             MOVX    A,@DPTR
0000F9 FB              4749             MOV     R3,A
0000FA A3              4750             INC     DPTR
0000FB E0              4751             MOVX    A,@DPTR
0000FC FA              4752             MOV     R2,A
0000FD A3              4753             INC     DPTR
0000FE E0              4754             MOVX    A,@DPTR
0000FF 2419            4755             ADD     A,#019H
000101 F9              4756             MOV     R1,A
000102 E4              4757             CLR     A
000103 3A              4758             ADDC    A,R2
000104 FA              4759             MOV     R2,A
000105 9000FFFD        4760             MOV     DPTR,#0FFFDH
000109 12000000   E    4761             LCALL   ?C?ADDXBP
00010D EB              4762             MOV     A,R3
00010E F0              4763             MOVX    @DPTR,A
00010F A3              4764             INC     DPTR
000110 EA              4765             MOV     A,R2
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    76

000111 F0              4766             MOVX    @DPTR,A
000112 A3              4767             INC     DPTR
000113 E9              4768             MOV     A,R1
000114 F0              4769             MOVX    @DPTR,A
000115 EF              4770             MOV     A,R7
000116 75F018          4771             MOV     B,#018H
000119 A4              4772             MUL     AB
00011A 2400       F    4773             ADD     A,#LOW (pxReadyTasksLists)
00011C F9              4774             MOV     R1,A
00011D 7400       F    4775             MOV     A,#HIGH (pxReadyTasksLists)
00011F 35F0            4776             ADDC    A,B
000121 FA              4777             MOV     R2,A
000122 7B00       F    4778             MOV     R3,#MBYTE (pxReadyTasksLists)
                       4779     ;       }
                       4780                             ; SOURCE LINE # 1221
000124 802C            4781             SJMP    ?C0124
000126                 4782     ?C0080:
                       4783     ;       else
                       4784     ;       {
                       4785                             ; SOURCE LINE # 1223
                       4786     ;               /* We cannot access the delayed or ready lists, so will hold this
                       4787     ;               task pending until the scheduler is resumed. */
                       4788     ;               vListInsertEnd( ( xList * ) &( xPendingReadyList ), &( pxUnblockedTCB->x
                               EventListItem ) );
                       4789                             ; SOURCE LINE # 1226
000126 850083     E    4790             MOV     DPH,?C_XBP
000129 850082     E    4791             MOV     DPL,?C_XBP+01H
00012C 759300     E    4792             MOV     DPX,#?C?XDATASEG
00012F E0              4793             MOVX    A,@DPTR
000130 FB              4794             MOV     R3,A
000131 A3              4795             INC     DPTR
000132 E0              4796             MOVX    A,@DPTR
000133 FA              4797             MOV     R2,A
000134 A3              4798             INC     DPTR
000135 E0              4799             MOVX    A,@DPTR
000136 2429            4800             ADD     A,#029H
000138 F9              4801             MOV     R1,A
000139 E4              4802             CLR     A
00013A 3A              4803             ADDC    A,R2
00013B FA              4804             MOV     R2,A
00013C 9000FFFD        4805             MOV     DPTR,#0FFFDH
000140 12000000   E    4806             LCALL   ?C?ADDXBP
000144 EB              4807             MOV     A,R3
000145 F0              4808             MOVX    @DPTR,A
000146 A3              4809             INC     DPTR
000147 EA              4810             MOV     A,R2
000148 F0              4811             MOVX    @DPTR,A
000149 A3              4812             INC     DPTR
00014A E9              4813             MOV     A,R1
00014B F0              4814             MOVX    @DPTR,A
00014C 7B00       F    4815             MOV     R3,#MBYTE (xPendingReadyList)
00014E 7A00       F    4816             MOV     R2,#HIGH (xPendingReadyList)
000150 7900       F    4817             MOV     R1,#LOW (xPendingReadyList)
000152                 4818     ?C0124:
000152 12000000   E    4819             LCALL   _?vListInsertEnd
                       4820     ;       }
                       4821                             ; SOURCE LINE # 1227
000156                 4822     ?C0082:
                       4823     ; 
                       4824     ;       if( pxUnblockedTCB->ucPriority > pxCurrentTCB->ucPriority )
                       4825                             ; SOURCE LINE # 1229
000156 90000000   F    4826             MOV     DPTR,#pxCurrentTCB
00015A E0              4827             MOVX    A,@DPTR
00015B FB              4828             MOV     R3,A
00015C A3              4829             INC     DPTR
00015D E0              4830             MOVX    A,@DPTR
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    77

00015E FA              4831             MOV     R2,A
00015F A3              4832             INC     DPTR
000160 E0              4833             MOVX    A,@DPTR
000161 2418            4834             ADD     A,#018H
000163 F9              4835             MOV     R1,A
000164 E4              4836             CLR     A
000165 3A              4837             ADDC    A,R2
000166 FA              4838             MOV     R2,A
000167 12000000   E    4839             LCALL   ?C?CLDPTR
00016B FF              4840             MOV     R7,A
00016C 850083     E    4841             MOV     DPH,?C_XBP
00016F 850082     E    4842             MOV     DPL,?C_XBP+01H
000172 759300     E    4843             MOV     DPX,#?C?XDATASEG
000175 E0              4844             MOVX    A,@DPTR
000176 FB              4845             MOV     R3,A
000177 A3              4846             INC     DPTR
000178 E0              4847             MOVX    A,@DPTR
000179 FA              4848             MOV     R2,A
00017A A3              4849             INC     DPTR
00017B E0              4850             MOVX    A,@DPTR
00017C 2418            4851             ADD     A,#018H
00017E F9              4852             MOV     R1,A
00017F E4              4853             CLR     A
000180 3A              4854             ADDC    A,R2
000181 FA              4855             MOV     R2,A
000182 12000000   E    4856             LCALL   ?C?CLDPTR
000186 D3              4857             SETB    C
000187 9F              4858             SUBB    A,R7
000188 7F00            4859             MOV     R7,#00H
00018A 4002            4860             JC      ?C0083
                       4861     ;       {
                       4862                             ; SOURCE LINE # 1230
                       4863     ;               /* Return true if the task removed from the event list has
                       4864     ;               a higher priority than the calling task.  This allows
                       4865     ;               the calling task to know if it should force a context 
                       4866     ;               switch now. */
                       4867     ;               return ( signed portCHAR ) pdTRUE;
                       4868                             ; SOURCE LINE # 1235
00018C 7F01            4869             MOV     R7,#01H
                       4870     ;       }
                       4871                             ; SOURCE LINE # 1236
00018E                 4872     ?C0083:
                       4873     ;       else
                       4874     ;       {
                       4875                             ; SOURCE LINE # 1238
                       4876     ;               return ( signed portCHAR ) pdFALSE;
                       4877                             ; SOURCE LINE # 1239
                       4878     ;       }
                       4879                             ; SOURCE LINE # 1240
                       4880     ; }
                       4881                             ; SOURCE LINE # 1241
00018E                 4882     ?C0084:
00018E 90000006        4883             MOV     DPTR,#06H
000192 02000000   E    4884             LJMP    ?C?ADDXBP
                       4885     ; END OF _?cTaskRemoveFromEventList
                       4886     
                       4887     ; 
                       4888     ; 
                       4889     ; 
                       4890     ; 
                       4891     ; 
                       4892     ; /*-----------------------------------------------------------
                       4893     ;  * The Idle task.
                       4894     ;  *----------------------------------------------------------*/
                       4895     ; 
                       4896     ; static void prvIdleTask( void *pvParameters ) reentrant
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    78

                       4897     
------                 4898             RSEG  ?PR?_?prvIdleTask?TASKS
000000                 4899     _?prvIdleTask:
                       4900             USING   0
                       4901                             ; SOURCE LINE # 1251
000000 9000FFFD        4902             MOV     DPTR,#0FFFDH
000004 12000000   E    4903             LCALL   ?C?ADDXBP
000008 EB              4904             MOV     A,R3
000009 F0              4905             MOVX    @DPTR,A
00000A A3              4906             INC     DPTR
00000B EA              4907             MOV     A,R2
00000C F0              4908             MOVX    @DPTR,A
00000D A3              4909             INC     DPTR
00000E E9              4910             MOV     A,R1
00000F F0              4911             MOVX    @DPTR,A
                       4912     ; {
                       4913     ;       /* Stop warnings. */
                       4914     ;       pvParameters = pvParameters;
                       4915                             ; SOURCE LINE # 1254
000010 850083     E    4916             MOV     DPH,?C_XBP
000013 850082     E    4917             MOV     DPL,?C_XBP+01H
000016 759300     E    4918             MOV     DPX,#?C?XDATASEG
000019 E0              4919             MOVX    A,@DPTR
00001A F9              4920             MOV     R1,A
00001B A3              4921             INC     DPTR
00001C E0              4922             MOVX    A,@DPTR
00001D FA              4923             MOV     R2,A
00001E A3              4924             INC     DPTR
00001F E0              4925             MOVX    A,@DPTR
000020 850083     E    4926             MOV     DPH,?C_XBP
000023 850082     E    4927             MOV     DPL,?C_XBP+01H
000026 759300     E    4928             MOV     DPX,#?C?XDATASEG
000029 C9              4929             XCH     A,R1
00002A F0              4930             MOVX    @DPTR,A
00002B A3              4931             INC     DPTR
00002C EA              4932             MOV     A,R2
00002D F0              4933             MOVX    @DPTR,A
00002E A3              4934             INC     DPTR
00002F E9              4935             MOV     A,R1
000030 F0              4936             MOVX    @DPTR,A
                       4937     ; 
                       4938     ;       for( ;; )
                       4939                             ; SOURCE LINE # 1256
000031                 4940     ?C0086:
                       4941     ;       {
                       4942                             ; SOURCE LINE # 1257
                       4943     ;               /* See if any tasks have been deleted. */
                       4944     ;               prvCheckTasksWaitingTermination();
                       4945                             ; SOURCE LINE # 1259
000031 12000000   F    4946             LCALL   _?prvCheckTasksWaitingTermination
                       4947     ; 
                       4948     ;               if( sUsingPreemption == pdFALSE )
                       4949                             ; SOURCE LINE # 1261
000035 90000000   F    4950             MOV     DPTR,#sUsingPreemption
000039 E0              4951             MOVX    A,@DPTR
00003A 7002            4952             JNZ     ?C0117
00003C A3              4953             INC     DPTR
00003D E0              4954             MOVX    A,@DPTR
00003E                 4955     ?C0117:
00003E 70F1            4956             JNZ     ?C0086
                       4957     ;               {
                       4958                             ; SOURCE LINE # 1262
                       4959     ;                       /* If we are not using preemption we keep forcing a task switch 
                               to
                       4960     ;                       see if any other task has become available.  If we are using 
                       4961     ;                       preemption we don't need to do this as any task becoming availab
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    79

                               le
                       4962     ;                       will automatically get the processor anyway. */
                       4963     ;                       taskYIELD();    
                       4964                             ; SOURCE LINE # 1267
000040 12000000   E    4965             LCALL   _?vPortYield
                       4966     ;               }
                       4967                             ; SOURCE LINE # 1268
                       4968     ;       }
                       4969                             ; SOURCE LINE # 1269
000044 80EB            4970             SJMP    ?C0086
                       4971     ; END OF _?prvIdleTask
                       4972     
                       4973     ; } /*lint !e715 pvParameters is not accessed but all task functions require the same pr
                               ototype. */
                       4974     ; 
                       4975     ; 
                       4976     ; 
                       4977     ; 
                       4978     ; 
                       4979     ; 
                       4980     ; 
                       4981     ; /*-----------------------------------------------------------
                       4982     ;  * File private functions documented at the top of the file.
                       4983     ;  *----------------------------------------------------------*/
                       4984     ; 
                       4985     ; 
                       4986     ; 
                       4987     ; static void prvInitialiseTCBVariables( tskTCB *pxTCB, unsigned portSHORT usStackDepth,
                                const signed portCHAR * const pcName, unsigned portCHAR ucPriority ) reentrant
                       4988     
------                 4989             RSEG  ?PR?_?prvInitialiseTCBVariables?TASKS
000000                 4990     _?prvInitialiseTCBVariables:
                       4991             USING   0
                       4992                             ; SOURCE LINE # 1284
000000 9000FFFE        4993             MOV     DPTR,#0FFFEH
000004 12000000   E    4994             LCALL   ?C?ADDXBP
000008 EC              4995             MOV     A,R4
000009 F0              4996             MOVX    @DPTR,A
00000A A3              4997             INC     DPTR
00000B ED              4998             MOV     A,R5
00000C F0              4999             MOVX    @DPTR,A
00000D 9000FFFD        5000             MOV     DPTR,#0FFFDH
000011 12000000   E    5001             LCALL   ?C?ADDXBP
000015 EB              5002             MOV     A,R3
000016 F0              5003             MOVX    @DPTR,A
000017 A3              5004             INC     DPTR
000018 EA              5005             MOV     A,R2
000019 F0              5006             MOVX    @DPTR,A
00001A A3              5007             INC     DPTR
00001B E9              5008             MOV     A,R1
00001C F0              5009             MOVX    @DPTR,A
                       5010     ; {
                       5011     ;       pxTCB->usStackDepth = usStackDepth;
                       5012                             ; SOURCE LINE # 1286
00001D 90000003        5013             MOV     DPTR,#03H
000021 12000000   E    5014             LCALL   ?C?XBPOFF
000025 E0              5015             MOVX    A,@DPTR
000026 FE              5016             MOV     R6,A
000027 A3              5017             INC     DPTR
000028 E0              5018             MOVX    A,@DPTR
000029 FF              5019             MOV     R7,A
00002A 850083     E    5020             MOV     DPH,?C_XBP
00002D 850082     E    5021             MOV     DPL,?C_XBP+01H
000030 759300     E    5022             MOV     DPX,#?C?XDATASEG
000033 E0              5023             MOVX    A,@DPTR
000034 FB              5024             MOV     R3,A
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    80

000035 A3              5025             INC     DPTR
000036 E0              5026             MOVX    A,@DPTR
000037 FA              5027             MOV     R2,A
000038 A3              5028             INC     DPTR
000039 E0              5029             MOVX    A,@DPTR
00003A 2406            5030             ADD     A,#06H
00003C F9              5031             MOV     R1,A
00003D E4              5032             CLR     A
00003E 3A              5033             ADDC    A,R2
00003F FA              5034             MOV     R2,A
000040 EE              5035             MOV     A,R6
000041 8FF0            5036             MOV     B,R7
000043 12000000   E    5037             LCALL   ?C?ISTPTR
                       5038     ; 
                       5039     ;       /* Make sure the name is not too long before copying it into the TCB. */
                       5040     ;       if( strlen( pcName ) < ( unsigned portSHORT ) tskMAX_TASK_NAME_LEN )
                       5041                             ; SOURCE LINE # 1289
000047 90000005        5042             MOV     DPTR,#05H
00004B 12000000   E    5043             LCALL   ?C?XBPOFF
00004F E0              5044             MOVX    A,@DPTR
000050 FB              5045             MOV     R3,A
000051 A3              5046             INC     DPTR
000052 E0              5047             MOVX    A,@DPTR
000053 FA              5048             MOV     R2,A
000054 A3              5049             INC     DPTR
000055 E0              5050             MOVX    A,@DPTR
000056 F9              5051             MOV     R1,A
000057 12000000   E    5052             LCALL   _strlen
00005B C3              5053             CLR     C
00005C EF              5054             MOV     A,R7
00005D 9410            5055             SUBB    A,#010H
00005F EE              5056             MOV     A,R6
000060 9400            5057             SUBB    A,#00H
000062 5046            5058             JNC     ?C0090
                       5059     ;       {
                       5060                             ; SOURCE LINE # 1290
                       5061     ;               portENTER_CRITICAL();
000064 A2AFC2AF        5062              DB 0A2H, 0AFH, 0C2H, 0AFH, 0C0H, 0D0H;
000068 C0D0                     
                       5063     ;                       strcpy( pxTCB->pcTaskName, pcName );
                       5064                             ; SOURCE LINE # 1292
00006A 90000005        5065             MOV     DPTR,#05H
00006E 12000000   E    5066             LCALL   ?C?XBPOFF
000072 E0              5067             MOVX    A,@DPTR
000073 FB              5068             MOV     R3,A
000074 A3              5069             INC     DPTR
000075 E0              5070             MOVX    A,@DPTR
000076 FA              5071             MOV     R2,A
000077 A3              5072             INC     DPTR
000078 E0              5073             MOVX    A,@DPTR
000079 F9              5074             MOV     R1,A
00007A C003            5075             PUSH    AR3
00007C C002            5076             PUSH    AR2
00007E C001            5077             PUSH    AR1
000080 850083     E    5078             MOV     DPH,?C_XBP
000083 850082     E    5079             MOV     DPL,?C_XBP+01H
000086 759300     E    5080             MOV     DPX,#?C?XDATASEG
000089 E0              5081             MOVX    A,@DPTR
00008A FB              5082             MOV     R3,A
00008B A3              5083             INC     DPTR
00008C E0              5084             MOVX    A,@DPTR
00008D FA              5085             MOV     R2,A
00008E A3              5086             INC     DPTR
00008F E0              5087             MOVX    A,@DPTR
000090 2408            5088             ADD     A,#08H
000092 F9              5089             MOV     R1,A
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    81

000093 E4              5090             CLR     A
000094 3A              5091             ADDC    A,R2
000095 A801            5092             MOV     R0,AR1
000097 FC              5093             MOV     R4,A
000098 AD03            5094             MOV     R5,AR3
00009A D001            5095             POP     AR1
00009C D002            5096             POP     AR2
00009E D003            5097             POP     AR3
0000A0 12000000   E    5098             LCALL   ?C?STRCPY
                       5099     ;               portEXIT_CRITICAL();
0000A4 D0D092AF        5100              DB 0D0H, 0D0H, 092H, 0AFH;
                       5101     ;       }
                       5102                             ; SOURCE LINE # 1294
0000A8 806D            5103             SJMP    ?C0091
0000AA                 5104     ?C0090:
                       5105     ;       else
                       5106     ;       {
                       5107                             ; SOURCE LINE # 1296
                       5108     ;               portENTER_CRITICAL();
0000AA A2AFC2AF        5109              DB 0A2H, 0AFH, 0C2H, 0AFH, 0C0H, 0D0H;
0000AE C0D0                     
                       5110     ;                       strncpy( pxTCB->pcTaskName, pcName, ( unsigned portSHORT ) tskMA
                               X_TASK_NAME_LEN );
                       5111                             ; SOURCE LINE # 1298
0000B0 850083     E    5112             MOV     DPH,?C_XBP
0000B3 850082     E    5113             MOV     DPL,?C_XBP+01H
0000B6 759300     E    5114             MOV     DPX,#?C?XDATASEG
0000B9 E0              5115             MOVX    A,@DPTR
0000BA FB              5116             MOV     R3,A
0000BB A3              5117             INC     DPTR
0000BC E0              5118             MOVX    A,@DPTR
0000BD FA              5119             MOV     R2,A
0000BE A3              5120             INC     DPTR
0000BF E0              5121             MOVX    A,@DPTR
0000C0 2408            5122             ADD     A,#08H
0000C2 F9              5123             MOV     R1,A
0000C3 E4              5124             CLR     A
0000C4 3A              5125             ADDC    A,R2
0000C5 FA              5126             MOV     R2,A
0000C6 C003            5127             PUSH    AR3
0000C8 C002            5128             PUSH    AR2
0000CA C001            5129             PUSH    AR1
0000CC 90000005        5130             MOV     DPTR,#05H
0000D0 12000000   E    5131             LCALL   ?C?XBPOFF
0000D4 E0              5132             MOVX    A,@DPTR
0000D5 F9              5133             MOV     R1,A
0000D6 A3              5134             INC     DPTR
0000D7 E0              5135             MOVX    A,@DPTR
0000D8 FA              5136             MOV     R2,A
0000D9 A3              5137             INC     DPTR
0000DA E0              5138             MOVX    A,@DPTR
0000DB 90000000   E    5139             MOV     DPTR,#?_strncpy?BYTE+03H
0000DF C9              5140             XCH     A,R1
0000E0 F0              5141             MOVX    @DPTR,A
0000E1 A3              5142             INC     DPTR
0000E2 EA              5143             MOV     A,R2
0000E3 F0              5144             MOVX    @DPTR,A
0000E4 A3              5145             INC     DPTR
0000E5 E9              5146             MOV     A,R1
0000E6 F0              5147             MOVX    @DPTR,A
0000E7 A3              5148             INC     DPTR
0000E8 E4              5149             CLR     A
0000E9 F0              5150             MOVX    @DPTR,A
0000EA A3              5151             INC     DPTR
0000EB 7410            5152             MOV     A,#010H
0000ED F0              5153             MOVX    @DPTR,A
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    82

0000EE D001            5154             POP     AR1
0000F0 D002            5155             POP     AR2
0000F2 D003            5156             POP     AR3
0000F4 12000000   E    5157             LCALL   _strncpy
                       5158     ;               portEXIT_CRITICAL();
0000F8 D0D092AF        5159              DB 0D0H, 0D0H, 092H, 0AFH;
                       5160     ;               pxTCB->pcTaskName[ ( unsigned portSHORT ) tskMAX_TASK_NAME_LEN - ( unsig
                               ned portSHORT ) 1 ] = '\0';
                       5161                             ; SOURCE LINE # 1300
0000FC 850083     E    5162             MOV     DPH,?C_XBP
0000FF 850082     E    5163             MOV     DPL,?C_XBP+01H
000102 759300     E    5164             MOV     DPX,#?C?XDATASEG
000105 E0              5165             MOVX    A,@DPTR
000106 FB              5166             MOV     R3,A
000107 A3              5167             INC     DPTR
000108 E0              5168             MOVX    A,@DPTR
000109 FA              5169             MOV     R2,A
00010A A3              5170             INC     DPTR
00010B E0              5171             MOVX    A,@DPTR
00010C 2417            5172             ADD     A,#017H
00010E F9              5173             MOV     R1,A
00010F E4              5174             CLR     A
000110 3A              5175             ADDC    A,R2
000111 FA              5176             MOV     R2,A
000112 E4              5177             CLR     A
000113 12000000   E    5178             LCALL   ?C?CSTPTR
                       5179     ;       }
                       5180                             ; SOURCE LINE # 1301
000117                 5181     ?C0091:
                       5182     ; 
                       5183     ;       /* This is used as an array index so must ensure it's not too large. */
                       5184     ;       if( ucPriority >= ( unsigned portCHAR ) portMAX_PRIORITIES )
                       5185                             ; SOURCE LINE # 1304
000117 90000008        5186             MOV     DPTR,#08H
00011B 12000000   E    5187             LCALL   ?C?XBPOFF
00011F E0              5188             MOVX    A,@DPTR
000120 C3              5189             CLR     C
000121 940A            5190             SUBB    A,#0AH
000123 400B            5191             JC      ?C0092
                       5192     ;       {
                       5193                             ; SOURCE LINE # 1305
                       5194     ;               ucPriority = ( unsigned portCHAR ) portMAX_PRIORITIES - ( unsigned portC
                               HAR ) 1;
                       5195                             ; SOURCE LINE # 1306
000125 90000008        5196             MOV     DPTR,#08H
000129 12000000   E    5197             LCALL   ?C?XBPOFF
00012D 7409            5198             MOV     A,#09H
00012F F0              5199             MOVX    @DPTR,A
                       5200     ;       }
                       5201                             ; SOURCE LINE # 1307
000130                 5202     ?C0092:
                       5203     ;       pxTCB->ucPriority = ucPriority;
                       5204                             ; SOURCE LINE # 1308
000130 90000008        5205             MOV     DPTR,#08H
000134 12000000   E    5206             LCALL   ?C?XBPOFF
000138 E0              5207             MOVX    A,@DPTR
000139 FF              5208             MOV     R7,A
00013A 850083     E    5209             MOV     DPH,?C_XBP
00013D 850082     E    5210             MOV     DPL,?C_XBP+01H
000140 759300     E    5211             MOV     DPX,#?C?XDATASEG
000143 E0              5212             MOVX    A,@DPTR
000144 FB              5213             MOV     R3,A
000145 A3              5214             INC     DPTR
000146 E0              5215             MOVX    A,@DPTR
000147 FA              5216             MOV     R2,A
000148 A3              5217             INC     DPTR
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    83

000149 E0              5218             MOVX    A,@DPTR
00014A 2418            5219             ADD     A,#018H
00014C F9              5220             MOV     R1,A
00014D E4              5221             CLR     A
00014E 3A              5222             ADDC    A,R2
00014F FA              5223             MOV     R2,A
000150 EF              5224             MOV     A,R7
000151 12000000   E    5225             LCALL   ?C?CSTPTR
                       5226     ; 
                       5227     ;       vListInitialiseItem( &( pxTCB->xGenericListItem ) );
                       5228                             ; SOURCE LINE # 1310
000155 850083     E    5229             MOV     DPH,?C_XBP
000158 850082     E    5230             MOV     DPL,?C_XBP+01H
00015B 759300     E    5231             MOV     DPX,#?C?XDATASEG
00015E E0              5232             MOVX    A,@DPTR
00015F FB              5233             MOV     R3,A
000160 A3              5234             INC     DPTR
000161 E0              5235             MOVX    A,@DPTR
000162 FA              5236             MOV     R2,A
000163 A3              5237             INC     DPTR
000164 E0              5238             MOVX    A,@DPTR
000165 2419            5239             ADD     A,#019H
000167 F9              5240             MOV     R1,A
000168 E4              5241             CLR     A
000169 3A              5242             ADDC    A,R2
00016A FA              5243             MOV     R2,A
00016B 12000000   E    5244             LCALL   _?vListInitialiseItem
                       5245     ;       vListInitialiseItem( &( pxTCB->xEventListItem ) );
                       5246                             ; SOURCE LINE # 1311
00016F 850083     E    5247             MOV     DPH,?C_XBP
000172 850082     E    5248             MOV     DPL,?C_XBP+01H
000175 759300     E    5249             MOV     DPX,#?C?XDATASEG
000178 E0              5250             MOVX    A,@DPTR
000179 FB              5251             MOV     R3,A
00017A A3              5252             INC     DPTR
00017B E0              5253             MOVX    A,@DPTR
00017C FA              5254             MOV     R2,A
00017D A3              5255             INC     DPTR
00017E E0              5256             MOVX    A,@DPTR
00017F 2429            5257             ADD     A,#029H
000181 F9              5258             MOV     R1,A
000182 E4              5259             CLR     A
000183 3A              5260             ADDC    A,R2
000184 FA              5261             MOV     R2,A
000185 12000000   E    5262             LCALL   _?vListInitialiseItem
                       5263     ; 
                       5264     ;       /* Set the pxTCB as a link back from the xListItem.  This is so we can get 
                       5265     ;       back to the containing TCB from a generic item in a list. */
                       5266     ;       listSET_LIST_ITEM_OWNER( &( pxTCB->xGenericListItem ), pxTCB );
                       5267                             ; SOURCE LINE # 1315
000189 850083     E    5268             MOV     DPH,?C_XBP
00018C 850082     E    5269             MOV     DPL,?C_XBP+01H
00018F 759300     E    5270             MOV     DPX,#?C?XDATASEG
000192 E0              5271             MOVX    A,@DPTR
000193 FB              5272             MOV     R3,A
000194 A3              5273             INC     DPTR
000195 E0              5274             MOVX    A,@DPTR
000196 FA              5275             MOV     R2,A
000197 A3              5276             INC     DPTR
000198 E0              5277             MOVX    A,@DPTR
000199 F9              5278             MOV     R1,A
00019A C003            5279             PUSH    AR3
00019C C002            5280             PUSH    AR2
00019E C001            5281             PUSH    AR1
0001A0 850083     E    5282             MOV     DPH,?C_XBP
0001A3 850082     E    5283             MOV     DPL,?C_XBP+01H
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    84

0001A6 759300     E    5284             MOV     DPX,#?C?XDATASEG
0001A9 E0              5285             MOVX    A,@DPTR
0001AA FB              5286             MOV     R3,A
0001AB A3              5287             INC     DPTR
0001AC E0              5288             MOVX    A,@DPTR
0001AD FA              5289             MOV     R2,A
0001AE A3              5290             INC     DPTR
0001AF E0              5291             MOVX    A,@DPTR
0001B0 2419            5292             ADD     A,#019H
0001B2 F9              5293             MOV     R1,A
0001B3 E4              5294             CLR     A
0001B4 3A              5295             ADDC    A,R2
0001B5 FA              5296             MOV     R2,A
0001B6 E9              5297             MOV     A,R1
0001B7 240A            5298             ADD     A,#0AH
0001B9 F9              5299             MOV     R1,A
0001BA E4              5300             CLR     A
0001BB 3A              5301             ADDC    A,R2
0001BC FA              5302             MOV     R2,A
0001BD 12000000   E    5303             LCALL   ?C?PSTPTR
                       5304     ; 
                       5305     ;       /* Event lists are always in priority order. */
                       5306     ;       listSET_LIST_ITEM_VALUE( &( pxTCB->xEventListItem ), ( portTickType ) ucPriority
                                );
                       5307                             ; SOURCE LINE # 1318
0001C1 90000008        5308             MOV     DPTR,#08H
0001C5 12000000   E    5309             LCALL   ?C?XBPOFF
0001C9 E0              5310             MOVX    A,@DPTR
0001CA FF              5311             MOV     R7,A
0001CB E4              5312             CLR     A
0001CC FC              5313             MOV     R4,A
0001CD FD              5314             MOV     R5,A
0001CE FE              5315             MOV     R6,A
0001CF 850083     E    5316             MOV     DPH,?C_XBP
0001D2 850082     E    5317             MOV     DPL,?C_XBP+01H
0001D5 759300     E    5318             MOV     DPX,#?C?XDATASEG
0001D8 E0              5319             MOVX    A,@DPTR
0001D9 FB              5320             MOV     R3,A
0001DA A3              5321             INC     DPTR
0001DB E0              5322             MOVX    A,@DPTR
0001DC FA              5323             MOV     R2,A
0001DD A3              5324             INC     DPTR
0001DE E0              5325             MOVX    A,@DPTR
0001DF 2429            5326             ADD     A,#029H
0001E1 F9              5327             MOV     R1,A
0001E2 E4              5328             CLR     A
0001E3 3A              5329             ADDC    A,R2
0001E4 FA              5330             MOV     R2,A
0001E5 12000000   E    5331             LCALL   ?C?LSTPTR
                       5332     ;       listSET_LIST_ITEM_OWNER( &( pxTCB->xEventListItem ), pxTCB );
                       5333                             ; SOURCE LINE # 1319
0001E9 850083     E    5334             MOV     DPH,?C_XBP
0001EC 850082     E    5335             MOV     DPL,?C_XBP+01H
0001EF 759300     E    5336             MOV     DPX,#?C?XDATASEG
0001F2 E0              5337             MOVX    A,@DPTR
0001F3 FB              5338             MOV     R3,A
0001F4 A3              5339             INC     DPTR
0001F5 E0              5340             MOVX    A,@DPTR
0001F6 FA              5341             MOV     R2,A
0001F7 A3              5342             INC     DPTR
0001F8 E0              5343             MOVX    A,@DPTR
0001F9 F9              5344             MOV     R1,A
0001FA C003            5345             PUSH    AR3
0001FC C002            5346             PUSH    AR2
0001FE C001            5347             PUSH    AR1
000200 850083     E    5348             MOV     DPH,?C_XBP
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    85

000203 850082     E    5349             MOV     DPL,?C_XBP+01H
000206 759300     E    5350             MOV     DPX,#?C?XDATASEG
000209 E0              5351             MOVX    A,@DPTR
00020A FB              5352             MOV     R3,A
00020B A3              5353             INC     DPTR
00020C E0              5354             MOVX    A,@DPTR
00020D FA              5355             MOV     R2,A
00020E A3              5356             INC     DPTR
00020F E0              5357             MOVX    A,@DPTR
000210 2429            5358             ADD     A,#029H
000212 F9              5359             MOV     R1,A
000213 E4              5360             CLR     A
000214 3A              5361             ADDC    A,R2
000215 FA              5362             MOV     R2,A
000216 E9              5363             MOV     A,R1
000217 240A            5364             ADD     A,#0AH
000219 F9              5365             MOV     R1,A
00021A E4              5366             CLR     A
00021B 3A              5367             ADDC    A,R2
00021C FA              5368             MOV     R2,A
00021D 12000000   E    5369             LCALL   ?C?PSTPTR
                       5370     ; }
                       5371                             ; SOURCE LINE # 1320
000221 90000009        5372             MOV     DPTR,#09H
000225 02000000   E    5373             LJMP    ?C?ADDXBP
                       5374     ; END OF _?prvInitialiseTCBVariables
                       5375     
                       5376     ; /*-----------------------------------------------------------*/
                       5377     ; 
                       5378     ; static portSHORT prvInitialiseTaskLists( void ) reentrant
                       5379     
------                 5380             RSEG  ?PR?_?prvInitialiseTaskLists?TASKS
000000                 5381     _?prvInitialiseTaskLists:
                       5382             USING   0
                       5383                             ; SOURCE LINE # 1323
000000 9000FFFD        5384             MOV     DPTR,#0FFFDH
000004 12000000   E    5385             LCALL   ?C?ADDXBP
                       5386     ; {
                       5387     ; register unsigned portCHAR ucPriority;
                       5388     ; portSHORT sReturn;
                       5389     ; 
                       5390     ;       for( ucPriority = ( unsigned portCHAR) 0; ucPriority < ( unsigned portCHAR ) por
                               tMAX_PRIORITIES; ucPriority++ )
                       5391                             ; SOURCE LINE # 1328
000008 850083     E    5392             MOV     DPH,?C_XBP
00000B 850082     E    5393             MOV     DPL,?C_XBP+01H
00000E 759300     E    5394             MOV     DPX,#?C?XDATASEG
000011 E4              5395             CLR     A
000012 F0              5396             MOVX    @DPTR,A
000013                 5397     ?C0094:
000013 850083     E    5398             MOV     DPH,?C_XBP
000016 850082     E    5399             MOV     DPL,?C_XBP+01H
000019 759300     E    5400             MOV     DPX,#?C?XDATASEG
00001C E0              5401             MOVX    A,@DPTR
00001D FF              5402             MOV     R7,A
00001E C3              5403             CLR     C
00001F 940A            5404             SUBB    A,#0AH
000021 5021            5405             JNC     ?C0095
                       5406     ;       {
                       5407                             ; SOURCE LINE # 1329
                       5408     ;               vListInitialise( ( xList * ) &( pxReadyTasksLists[ ucPriority ] ) );
                       5409                             ; SOURCE LINE # 1330
000023 EF              5410             MOV     A,R7
000024 75F018          5411             MOV     B,#018H
000027 A4              5412             MUL     AB
000028 2400       F    5413             ADD     A,#LOW (pxReadyTasksLists)
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    86

00002A F9              5414             MOV     R1,A
00002B 7400       F    5415             MOV     A,#HIGH (pxReadyTasksLists)
00002D 35F0            5416             ADDC    A,B
00002F FA              5417             MOV     R2,A
000030 7B00       F    5418             MOV     R3,#MBYTE (pxReadyTasksLists)
000032 12000000   E    5419             LCALL   _?vListInitialise
                       5420     ;       }
                       5421                             ; SOURCE LINE # 1331
000036 850083     E    5422             MOV     DPH,?C_XBP
000039 850082     E    5423             MOV     DPL,?C_XBP+01H
00003C 759300     E    5424             MOV     DPX,#?C?XDATASEG
00003F E0              5425             MOVX    A,@DPTR
000040 04              5426             INC     A
000041 F0              5427             MOVX    @DPTR,A
000042 80CF            5428             SJMP    ?C0094
000044                 5429     ?C0095:
                       5430     ; 
                       5431     ;       vListInitialise( ( xList * ) &xDelayedTaskList1 );
                       5432                             ; SOURCE LINE # 1333
000044 7B00       F    5433             MOV     R3,#MBYTE (xDelayedTaskList1)
000046 7A00       F    5434             MOV     R2,#HIGH (xDelayedTaskList1)
000048 7900       F    5435             MOV     R1,#LOW (xDelayedTaskList1)
00004A 12000000   E    5436             LCALL   _?vListInitialise
                       5437     ;       vListInitialise( ( xList * ) &xDelayedTaskList2 );
                       5438                             ; SOURCE LINE # 1334
00004E 7B00       F    5439             MOV     R3,#MBYTE (xDelayedTaskList2)
000050 7A00       F    5440             MOV     R2,#HIGH (xDelayedTaskList2)
000052 7900       F    5441             MOV     R1,#LOW (xDelayedTaskList2)
000054 12000000   E    5442             LCALL   _?vListInitialise
                       5443     ;       vListInitialise( ( xList * ) &xPendingReadyList );
                       5444                             ; SOURCE LINE # 1335
000058 7B00       F    5445             MOV     R3,#MBYTE (xPendingReadyList)
00005A 7A00       F    5446             MOV     R2,#HIGH (xPendingReadyList)
00005C 7900       F    5447             MOV     R1,#LOW (xPendingReadyList)
00005E 12000000   E    5448             LCALL   _?vListInitialise
                       5449     ; 
                       5450     ;       #if( INCLUDE_vTaskDelete == 1 )
                       5451     ;       {
                       5452     ;               vListInitialise( ( xList * ) &xTasksWaitingTermination );
                       5453     ;       }
                       5454     ;       #endif
                       5455     ; 
                       5456     ;       #if( INCLUDE_vTaskSuspend == 1 )
                       5457     ;       {
                       5458                             ; SOURCE LINE # 1344
                       5459     ;               vListInitialise( ( xList * ) &xSuspendedTaskList );
                       5460                             ; SOURCE LINE # 1345
000062 7B00       F    5461             MOV     R3,#MBYTE (xSuspendedTaskList)
000064 7A00       F    5462             MOV     R2,#HIGH (xSuspendedTaskList)
000066 7900       F    5463             MOV     R1,#LOW (xSuspendedTaskList)
000068 12000000   E    5464             LCALL   _?vListInitialise
                       5465     ;       }
                       5466                             ; SOURCE LINE # 1346
                       5467     ;       #endif
                       5468     ; 
                       5469     ;       /* Start with pxDelayedTaskList using list1 and the pxOverflowDelayedTaskList 
                       5470     ;       using list2. */
                       5471     ;       pxDelayedTaskList = &xDelayedTaskList1;
                       5472                             ; SOURCE LINE # 1351
00006C 90000000   F    5473             MOV     DPTR,#pxDelayedTaskList
000070 7400       F    5474             MOV     A,#MBYTE (xDelayedTaskList1)
000072 F0              5475             MOVX    @DPTR,A
000073 A3              5476             INC     DPTR
000074 7400       F    5477             MOV     A,#HIGH (xDelayedTaskList1)
000076 F0              5478             MOVX    @DPTR,A
000077 A3              5479             INC     DPTR
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    87

000078 7400       F    5480             MOV     A,#LOW (xDelayedTaskList1)
00007A F0              5481             MOVX    @DPTR,A
                       5482     ;       pxOverflowDelayedTaskList = &xDelayedTaskList2;
                       5483                             ; SOURCE LINE # 1352
00007B 90000000   F    5484             MOV     DPTR,#pxOverflowDelayedTaskList
00007F 7400       F    5485             MOV     A,#MBYTE (xDelayedTaskList2)
000081 F0              5486             MOVX    @DPTR,A
000082 A3              5487             INC     DPTR
000083 7400       F    5488             MOV     A,#HIGH (xDelayedTaskList2)
000085 F0              5489             MOVX    @DPTR,A
000086 A3              5490             INC     DPTR
000087 7400       F    5491             MOV     A,#LOW (xDelayedTaskList2)
000089 F0              5492             MOVX    @DPTR,A
                       5493     ; 
                       5494     ;       /* Add the idle task at the lowest priority. */
                       5495     ;       sReturn = sTaskCreate( prvIdleTask, ( const portCHAR * const ) "IDLE", tskIDLE_S
                               TACK_SIZE, ( void * ) NULL, tskIDLE_PRIORITY, ( xTaskHandle * ) NULL );
                       5496                             ; SOURCE LINE # 1355
00008A 7B00            5497             MOV     R3,#00H
00008C 7A00            5498             MOV     R2,#00H
00008E 7900            5499             MOV     R1,#00H
000090 9000FFFD        5500             MOV     DPTR,#0FFFDH
000094 12000000   E    5501             LCALL   ?C?ADDXBP
000098 EB              5502             MOV     A,R3
000099 F0              5503             MOVX    @DPTR,A
00009A A3              5504             INC     DPTR
00009B EA              5505             MOV     A,R2
00009C F0              5506             MOVX    @DPTR,A
00009D A3              5507             INC     DPTR
00009E E9              5508             MOV     A,R1
00009F F0              5509             MOVX    @DPTR,A
0000A0 9000FFFF        5510             MOV     DPTR,#0FFFFH
0000A4 12000000   E    5511             LCALL   ?C?ADDXBP
0000A8 E4              5512             CLR     A
0000A9 F0              5513             MOVX    @DPTR,A
0000AA FB              5514             MOV     R3,A
0000AB FA              5515             MOV     R2,A
0000AC F9              5516             MOV     R1,A
0000AD 9000FFFD        5517             MOV     DPTR,#0FFFDH
0000B1 12000000   E    5518             LCALL   ?C?ADDXBP
0000B5 EB              5519             MOV     A,R3
0000B6 F0              5520             MOVX    @DPTR,A
0000B7 A3              5521             INC     DPTR
0000B8 EA              5522             MOV     A,R2
0000B9 F0              5523             MOVX    @DPTR,A
0000BA A3              5524             INC     DPTR
0000BB E9              5525             MOV     A,R1
0000BC F0              5526             MOVX    @DPTR,A
0000BD C3              5527             CLR     C
0000BE E4              5528             CLR     A
0000BF 9400       E    5529             SUBB    A,#LOW (STACK_START)
0000C1 FF              5530             MOV     R7,A
0000C2 7404            5531             MOV     A,#04H
0000C4 9400       E    5532             SUBB    A,#HIGH (STACK_START)
0000C6 FE              5533             MOV     R6,A
0000C7 9000FFFE        5534             MOV     DPTR,#0FFFEH
0000CB 12000000   E    5535             LCALL   ?C?ADDXBP
0000CF EE              5536             MOV     A,R6
0000D0 F0              5537             MOVX    @DPTR,A
0000D1 A3              5538             INC     DPTR
0000D2 EF              5539             MOV     A,R7
0000D3 F0              5540             MOVX    @DPTR,A
0000D4 7B00       F    5541             MOV     R3,#MBYTE (?SC_0)
0000D6 7A00       F    5542             MOV     R2,#HIGH (?SC_0)
0000D8 7900       F    5543             MOV     R1,#LOW (?SC_0)
0000DA 9000FFFD        5544             MOV     DPTR,#0FFFDH
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    88

0000DE 12000000   E    5545             LCALL   ?C?ADDXBP
0000E2 EB              5546             MOV     A,R3
0000E3 F0              5547             MOVX    @DPTR,A
0000E4 A3              5548             INC     DPTR
0000E5 EA              5549             MOV     A,R2
0000E6 F0              5550             MOVX    @DPTR,A
0000E7 A3              5551             INC     DPTR
0000E8 E9              5552             MOV     A,R1
0000E9 F0              5553             MOVX    @DPTR,A
0000EA 7B00       F    5554             MOV     R3,#MBYTE (_?prvIdleTask)
0000EC 7A00       F    5555             MOV     R2,#HIGH (_?prvIdleTask)
0000EE 7900       F    5556             MOV     R1,#LOW (_?prvIdleTask)
0000F0 12000000   F    5557             LCALL   _?sTaskCreate
0000F4 850083     E    5558             MOV     DPH,?C_XBP
0000F7 850082     E    5559             MOV     DPL,?C_XBP+01H
0000FA A3              5560             INC     DPTR
0000FB 759300     E    5561             MOV     DPX,#?C?XDATASEG
0000FE EE              5562             MOV     A,R6
0000FF F0              5563             MOVX    @DPTR,A
000100 A3              5564             INC     DPTR
000101 EF              5565             MOV     A,R7
000102 F0              5566             MOVX    @DPTR,A
                       5567     ; 
                       5568     ;       return sReturn;
                       5569                             ; SOURCE LINE # 1357
000103 850083     E    5570             MOV     DPH,?C_XBP
000106 850082     E    5571             MOV     DPL,?C_XBP+01H
000109 A3              5572             INC     DPTR
00010A 759300     E    5573             MOV     DPX,#?C?XDATASEG
00010D E0              5574             MOVX    A,@DPTR
00010E FE              5575             MOV     R6,A
00010F A3              5576             INC     DPTR
000110 E0              5577             MOVX    A,@DPTR
000111 FF              5578             MOV     R7,A
                       5579     ; }
                       5580                             ; SOURCE LINE # 1358
000112                 5581     ?C0097:
000112 90000003        5582             MOV     DPTR,#03H
000116 02000000   E    5583             LJMP    ?C?ADDXBP
                       5584     ; END OF _?prvInitialiseTaskLists
                       5585     
                       5586     ; /*-----------------------------------------------------------*/
                       5587     ; 
                       5588     ; static void prvCheckTasksWaitingTermination( void ) reentrant
                       5589     
------                 5590             RSEG  ?PR?_?prvCheckTasksWaitingTermination?TASKS
000000                 5591     _?prvCheckTasksWaitingTermination:
                       5592             USING   0
                       5593                             ; SOURCE LINE # 1361
                       5594     ; {                                                     
                       5595     ;       #if( INCLUDE_vTaskDelete == 1 )
                       5596     ;       {                               
                       5597     ;               portSHORT sListIsEmpty;
                       5598     ; 
                       5599     ;               vTaskSuspendAll();
                       5600     ;                       sListIsEmpty = listLIST_IS_EMPTY( &xTasksWaitingTermination );
                       5601     ;               cTaskResumeAll();
                       5602     ; 
                       5603     ;               if( !sListIsEmpty )
                       5604     ;               {
                       5605     ;                       tskTCB *pxTCB;
                       5606     ; 
                       5607     ;                       portENTER_CRITICAL();
                       5608     ;                       {                       
                       5609     ;                               pxTCB = ( tskTCB * ) listGET_OWNER_OF_HEAD_ENTRY( ( ( xL
                               ist * ) &xTasksWaitingTermination ) );
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    89

                       5610     ;                               vListRemove( &( pxTCB->xGenericListItem ) );
                       5611     ;                               --usCurrentNumberOfTasks;
                       5612     ;                       }
                       5613     ;                       portEXIT_CRITICAL();
                       5614     ; 
                       5615     ;                       prvDeleteTCB( pxTCB );
                       5616     ;               }
                       5617     ;       }
                       5618     ;       #endif
                       5619     ; }
                       5620                             ; SOURCE LINE # 1387
000000 22              5621             RET     
                       5622     ; END OF _?prvCheckTasksWaitingTermination
                       5623     
                       5624     ; /*-----------------------------------------------------------*/
                       5625     ; 
                       5626     ; static tskTCB *prvAllocateTCBAndStack( unsigned portSHORT usStackDepth ) reentrant
                       5627     
------                 5628             RSEG  ?PR?_?prvAllocateTCBAndStack?TASKS
000000                 5629     _?prvAllocateTCBAndStack:
                       5630             USING   0
                       5631                             ; SOURCE LINE # 1390
000000 9000FFFE        5632             MOV     DPTR,#0FFFEH
000004 12000000   E    5633             LCALL   ?C?ADDXBP
000008 EE              5634             MOV     A,R6
000009 F0              5635             MOVX    @DPTR,A
00000A A3              5636             INC     DPTR
00000B EF              5637             MOV     A,R7
00000C F0              5638             MOVX    @DPTR,A
00000D 9000FFFD        5639             MOV     DPTR,#0FFFDH
000011 12000000   E    5640             LCALL   ?C?ADDXBP
                       5641     ; {
                       5642     ; tskTCB *pxNewTCB;
                       5643     ; 
                       5644     ;       /* Allocate space for the TCB.  Where the memory comes from depends on
                       5645     ;       the implementation of the port malloc function. */
                       5646     ;       pxNewTCB = ( tskTCB * ) pvPortMalloc( sizeof( tskTCB ) );
                       5647                             ; SOURCE LINE # 1396
000015 7E00            5648             MOV     R6,#00H
000017 7F3A            5649             MOV     R7,#03AH
000019 12000000   E    5650             LCALL   _?pvPortMalloc
00001D 850083     E    5651             MOV     DPH,?C_XBP
000020 850082     E    5652             MOV     DPL,?C_XBP+01H
000023 759300     E    5653             MOV     DPX,#?C?XDATASEG
000026 EB              5654             MOV     A,R3
000027 F0              5655             MOVX    @DPTR,A
000028 A3              5656             INC     DPTR
000029 EA              5657             MOV     A,R2
00002A F0              5658             MOVX    @DPTR,A
00002B A3              5659             INC     DPTR
00002C E9              5660             MOV     A,R1
00002D F0              5661             MOVX    @DPTR,A
                       5662     ; 
                       5663     ;       if( pxNewTCB != NULL )
                       5664                             ; SOURCE LINE # 1398
00002E 850083     E    5665             MOV     DPH,?C_XBP
000031 850082     E    5666             MOV     DPL,?C_XBP+01H
000034 759300     E    5667             MOV     DPX,#?C?XDATASEG
000037 E0              5668             MOVX    A,@DPTR
000038 FB              5669             MOV     R3,A
000039 A3              5670             INC     DPTR
00003A E0              5671             MOVX    A,@DPTR
00003B FA              5672             MOV     R2,A
00003C A3              5673             INC     DPTR
00003D E0              5674             MOVX    A,@DPTR
00003E 4A              5675             ORL     A,R2
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    90

00003F 4B              5676             ORL     A,R3
000040 7003            5677             JNZ     $ + 5H
000042 010000     F    5678             AJMP    ?C0099
                       5679     ;       {
                       5680                             ; SOURCE LINE # 1399
                       5681     ;               /* Allocate space for the stack used by the task being created.  
                       5682     ;               The base of the stack memory stored in the TCB so the task can 
                       5683     ;               be deleted later if required. */
                       5684     ;               pxNewTCB->pxStack = ( portSTACK_TYPE * ) pvPortMalloc( usStackDepth * si
                               zeof( portSTACK_TYPE ) );
                       5685                             ; SOURCE LINE # 1403
000045 90000003        5686             MOV     DPTR,#03H
000049 12000000   E    5687             LCALL   ?C?XBPOFF
00004D E0              5688             MOVX    A,@DPTR
00004E FE              5689             MOV     R6,A
00004F A3              5690             INC     DPTR
000050 E0              5691             MOVX    A,@DPTR
000051 FF              5692             MOV     R7,A
000052 12000000   E    5693             LCALL   _?pvPortMalloc
000056 C003            5694             PUSH    AR3
000058 C002            5695             PUSH    AR2
00005A C001            5696             PUSH    AR1
00005C 850083     E    5697             MOV     DPH,?C_XBP
00005F 850082     E    5698             MOV     DPL,?C_XBP+01H
000062 759300     E    5699             MOV     DPX,#?C?XDATASEG
000065 E0              5700             MOVX    A,@DPTR
000066 FB              5701             MOV     R3,A
000067 A3              5702             INC     DPTR
000068 E0              5703             MOVX    A,@DPTR
000069 FA              5704             MOV     R2,A
00006A A3              5705             INC     DPTR
00006B E0              5706             MOVX    A,@DPTR
00006C 2403            5707             ADD     A,#03H
00006E F9              5708             MOV     R1,A
00006F E4              5709             CLR     A
000070 3A              5710             ADDC    A,R2
000071 FA              5711             MOV     R2,A
000072 12000000   E    5712             LCALL   ?C?PSTPTR
                       5713     ; 
                       5714     ;               if( pxNewTCB->pxStack == NULL )
                       5715                             ; SOURCE LINE # 1405
000076 850083     E    5716             MOV     DPH,?C_XBP
000079 850082     E    5717             MOV     DPL,?C_XBP+01H
00007C 759300     E    5718             MOV     DPX,#?C?XDATASEG
00007F E0              5719             MOVX    A,@DPTR
000080 FB              5720             MOV     R3,A
000081 A3              5721             INC     DPTR
000082 E0              5722             MOVX    A,@DPTR
000083 FA              5723             MOV     R2,A
000084 A3              5724             INC     DPTR
000085 E0              5725             MOVX    A,@DPTR
000086 2403            5726             ADD     A,#03H
000088 F9              5727             MOV     R1,A
000089 E4              5728             CLR     A
00008A 3A              5729             ADDC    A,R2
00008B FA              5730             MOV     R2,A
00008C 12000000   E    5731             LCALL   ?C?PLDPTR
000090 E9              5732             MOV     A,R1
000091 4A              5733             ORL     A,R2
000092 4B              5734             ORL     A,R3
000093 7026            5735             JNZ     ?C0100
                       5736     ;               {
                       5737                             ; SOURCE LINE # 1406
                       5738     ;                       /* Could not allocate the stack.  Delete the allocated TCB. */
                       5739     ;                       vPortFree( pxNewTCB );                  
                       5740                             ; SOURCE LINE # 1408
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    91

000095 850083     E    5741             MOV     DPH,?C_XBP
000098 850082     E    5742             MOV     DPL,?C_XBP+01H
00009B 759300     E    5743             MOV     DPX,#?C?XDATASEG
00009E E0              5744             MOVX    A,@DPTR
00009F FB              5745             MOV     R3,A
0000A0 A3              5746             INC     DPTR
0000A1 E0              5747             MOVX    A,@DPTR
0000A2 FA              5748             MOV     R2,A
0000A3 A3              5749             INC     DPTR
0000A4 E0              5750             MOVX    A,@DPTR
0000A5 F9              5751             MOV     R1,A
0000A6 12000000   E    5752             LCALL   _?vPortFree
                       5753     ;                       pxNewTCB = NULL;                        
                       5754                             ; SOURCE LINE # 1409
0000AA 850083     E    5755             MOV     DPH,?C_XBP
0000AD 850082     E    5756             MOV     DPL,?C_XBP+01H
0000B0 759300     E    5757             MOV     DPX,#?C?XDATASEG
0000B3 E4              5758             CLR     A
0000B4 F0              5759             MOVX    @DPTR,A
0000B5 A3              5760             INC     DPTR
0000B6 F0              5761             MOVX    @DPTR,A
0000B7 A3              5762             INC     DPTR
0000B8 F0              5763             MOVX    @DPTR,A
                       5764     ;               }               
                       5765                             ; SOURCE LINE # 1410
0000B9 802D            5766             SJMP    ?C0099
0000BB                 5767     ?C0100:
                       5768     ;               else
                       5769     ;               {
                       5770                             ; SOURCE LINE # 1412
                       5771     ;                       /* Just to help debugging. */
                       5772     ;                       memset( pxNewTCB->pxStack, tskSTACK_FILL_BYTE, usStackDepth * si
                               zeof( portSTACK_TYPE ) );
                       5773                             ; SOURCE LINE # 1414
0000BB 90000003        5774             MOV     DPTR,#03H
0000BF 12000000   E    5775             LCALL   ?C?XBPOFF
0000C3 E0              5776             MOVX    A,@DPTR
0000C4 FE              5777             MOV     R6,A
0000C5 A3              5778             INC     DPTR
0000C6 E0              5779             MOVX    A,@DPTR
0000C7 FF              5780             MOV     R7,A
0000C8 7DA5            5781             MOV     R5,#0A5H
0000CA 850083     E    5782             MOV     DPH,?C_XBP
0000CD 850082     E    5783             MOV     DPL,?C_XBP+01H
0000D0 759300     E    5784             MOV     DPX,#?C?XDATASEG
0000D3 E0              5785             MOVX    A,@DPTR
0000D4 FB              5786             MOV     R3,A
0000D5 A3              5787             INC     DPTR
0000D6 E0              5788             MOVX    A,@DPTR
0000D7 FA              5789             MOV     R2,A
0000D8 A3              5790             INC     DPTR
0000D9 E0              5791             MOVX    A,@DPTR
0000DA 2403            5792             ADD     A,#03H
0000DC F9              5793             MOV     R1,A
0000DD E4              5794             CLR     A
0000DE 3A              5795             ADDC    A,R2
0000DF FA              5796             MOV     R2,A
0000E0 12000000   E    5797             LCALL   ?C?PLDPTR
0000E4 12000000   E    5798             LCALL   ?C?MEMSET
                       5799     ;               }
                       5800                             ; SOURCE LINE # 1415
                       5801     ;       }
                       5802                             ; SOURCE LINE # 1416
0000E8                 5803     ?C0099:
                       5804     ; 
                       5805     ;       return pxNewTCB;
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    92

                       5806                             ; SOURCE LINE # 1418
0000E8 850083     E    5807             MOV     DPH,?C_XBP
0000EB 850082     E    5808             MOV     DPL,?C_XBP+01H
0000EE 759300     E    5809             MOV     DPX,#?C?XDATASEG
0000F1 E0              5810             MOVX    A,@DPTR
0000F2 FB              5811             MOV     R3,A
0000F3 A3              5812             INC     DPTR
0000F4 E0              5813             MOVX    A,@DPTR
0000F5 FA              5814             MOV     R2,A
0000F6 A3              5815             INC     DPTR
0000F7 E0              5816             MOVX    A,@DPTR
0000F8 F9              5817             MOV     R1,A
                       5818     ; }
                       5819                             ; SOURCE LINE # 1419
0000F9                 5820     ?C0102:
0000F9 90000005        5821             MOV     DPTR,#05H
0000FD 02000000   E    5822             LJMP    ?C?ADDXBP
                       5823     ; END OF _?prvAllocateTCBAndStack
                       5824     
                       5825     ; /*-----------------------------------------------------------*/
                       5826     ; 
                       5827     ; #if( USE_TRACE_FACILITY == 1 )
                       5828     ; 
                       5829     ;       static void prvListTaskWithinSingleList( signed portCHAR *pcWriteBuffer, xList *
                               pxList, signed portCHAR cStatus )reentrant
                       5830     ;       {
                       5831     ;       volatile tskTCB *pxNextTCB, *pxFirstTCB;
                       5832     ;       static signed portCHAR pcStatusString[ 50 ];
                       5833     ;       unsigned portSHORT usStackRemaining;
                       5834     ; 
                       5835     ;               /* Write the details of all the TCB's in pxList into the buffer. */
                       5836     ;               listGET_OWNER_OF_NEXT_ENTRY( pxFirstTCB, pxList );
                       5837     ;               do
                       5838     ;               {
                       5839     ;                       listGET_OWNER_OF_NEXT_ENTRY( pxNextTCB, pxList );
                       5840     ;                       usStackRemaining = usPortCheckFreeStackSpace( ( unsigned portCHA
                               R * ) pxNextTCB->pxStack, tskSTACK_FILL_BYTE );
                       5841     ;                       sprintf( pcStatusString, "%s\t\t%c\t%u\t%u\t%d\r\n", pxNextTCB->
                               pcTaskName, cStatus, pxNextTCB->ucPriority, usStackRemaining, pxNextTCB->ucTCBNumber );
                       5842     ;                       strcat( pcWriteBuffer, pcStatusString );
                       5843     ; 
                       5844     ;               } while( pxNextTCB != pxFirstTCB );
                       5845     ;       }
                       5846     ; 
                       5847     ; #endif
                       5848     ; /*-----------------------------------------------------------*/
                       5849     ; 
                       5850     ; #if( ( INCLUDE_vTaskDelete == 1 ) || ( INCLUDE_vTaskCleanUpResources == 1 ) )
                       5851     ; 
                       5852     ;       static void prvDeleteTCB( tskTCB *pxTCB ) reentrant
                       5853     ;       {
                       5854     ;               /* Free up the memory allocated by the scheduler for the task.  It is up
                                to
                       5855     ;               the task to free any memory allocated at the application level. */
                       5856     ;               vPortFree( pxTCB->pxStack );
                       5857     ;               vPortFree( pxTCB );
                       5858     ;       }
                       5859     ; 
                       5860     ; #endif
                       5861     ; 
                       5862     ; void prvGetCurrentTCB_XBP() reentrant
                       5863     
------                 5864             RSEG  ?PR?_?prvGetCurrentTCB_XBP?TASKS
000000                 5865     _?prvGetCurrentTCB_XBP:
                       5866             USING   0
                       5867                             ; SOURCE LINE # 1457
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    93

                       5868     ; {
                       5869     ;       pxCurrentTCB->pxTopOfStack = C_XBP;
                       5870                             ; SOURCE LINE # 1459
000000 AA00       E    5871             MOV     R2,C_XBP
000002 A900       E    5872             MOV     R1,C_XBP+01H
000004 7B00       E    5873             MOV     R3,#?C?XDATAMTYPE
000006 C003            5874             PUSH    AR3
000008 C002            5875             PUSH    AR2
00000A C001            5876             PUSH    AR1
00000C 90000000   F    5877             MOV     DPTR,#pxCurrentTCB
000010 E0              5878             MOVX    A,@DPTR
000011 FB              5879             MOV     R3,A
000012 A3              5880             INC     DPTR
000013 E0              5881             MOVX    A,@DPTR
000014 FA              5882             MOV     R2,A
000015 A3              5883             INC     DPTR
000016 E0              5884             MOVX    A,@DPTR
000017 F9              5885             MOV     R1,A
000018 12000000   E    5886             LCALL   ?C?PSTPTR
                       5887     ; }
                       5888                             ; SOURCE LINE # 1460
00001C 22              5889             RET     
                       5890     ; END OF _?prvGetCurrentTCB_XBP
                       5891     
                       5892     ; 
                       5893     ; 
                       5894     ; void prvSetCurrentTCB_XBP() reentrant
                       5895     
------                 5896             RSEG  ?PR?_?prvSetCurrentTCB_XBP?TASKS
000000                 5897     _?prvSetCurrentTCB_XBP:
                       5898             USING   0
                       5899                             ; SOURCE LINE # 1463
                       5900     ; {
                       5901     ;       C_XBP=pxCurrentTCB->pxTopOfStack;
                       5902                             ; SOURCE LINE # 1465
000000 90000000   F    5903             MOV     DPTR,#pxCurrentTCB
000004 E0              5904             MOVX    A,@DPTR
000005 FB              5905             MOV     R3,A
000006 A3              5906             INC     DPTR
000007 E0              5907             MOVX    A,@DPTR
000008 FA              5908             MOV     R2,A
000009 A3              5909             INC     DPTR
00000A E0              5910             MOVX    A,@DPTR
00000B F9              5911             MOV     R1,A
00000C 12000000   E    5912             LCALL   ?C?PLDPTR
000010 AF01            5913             MOV     R7,AR1
000012 8A00       E    5914             MOV     C_XBP,R2
000014 8F00       E    5915             MOV     C_XBP+01H,R7
                       5916     ; }
                       5917                             ; SOURCE LINE # 1466
000016 22              5918             RET     
                       5919     ; END OF _?prvSetCurrentTCB_XBP
                       5920     
                       5921             END
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    94

SYMBOL TABLE LISTING
------ ----- -------


N A M E                                    T Y P E  V A L U E     ATTRIBUTES

?_STRNCPY?BYTE. . . . . . . . . . . . .    X  ADDR  -------       EXT
?C0001. . . . . . . . . . . . . . . . .    EC ADDR  0320H     R   SEG=?PR?_?STASKCREATE?TASKS
?C0002. . . . . . . . . . . . . . . . .    EC ADDR  01E8H     R   SEG=?PR?_?STASKCREATE?TASKS
?C0003. . . . . . . . . . . . . . . . .    EC ADDR  0240H     R   SEG=?PR?_?STASKCREATE?TASKS
?C0006. . . . . . . . . . . . . . . . .    EC ADDR  026AH     R   SEG=?PR?_?STASKCREATE?TASKS
?C0007. . . . . . . . . . . . . . . . .    EC ADDR  02DFH     R   SEG=?PR?_?STASKCREATE?TASKS
?C0008. . . . . . . . . . . . . . . . .    EC ADDR  032EH     R   SEG=?PR?_?STASKCREATE?TASKS
?C0009. . . . . . . . . . . . . . . . .    EC ADDR  03B0H     R   SEG=?PR?_?STASKCREATE?TASKS
?C0010. . . . . . . . . . . . . . . . .    EC ADDR  0380H     R   SEG=?PR?_?STASKCREATE?TASKS
?C0013. . . . . . . . . . . . . . . . .    EC ADDR  03BEH     R   SEG=?PR?_?STASKCREATE?TASKS
?C0014. . . . . . . . . . . . . . . . .    EC ADDR  00F7H     R   SEG=?PR?_?VTASKDELAYUNTIL?TASKS
?C0016. . . . . . . . . . . . . . . . .    EC ADDR  015BH     R   SEG=?PR?_?VTASKDELAYUNTIL?TASKS
?C0018. . . . . . . . . . . . . . . . .    EC ADDR  0150H     R   SEG=?PR?_?VTASKDELAYUNTIL?TASKS
?C0019. . . . . . . . . . . . . . . . .    EC ADDR  024BH     R   SEG=?PR?_?VTASKDELAYUNTIL?TASKS
?C0020. . . . . . . . . . . . . . . . .    EC ADDR  0220H     R   SEG=?PR?_?VTASKDELAYUNTIL?TASKS
?C0023. . . . . . . . . . . . . . . . .    EC ADDR  0268H     R   SEG=?PR?_?VTASKDELAYUNTIL?TASKS
?C0024. . . . . . . . . . . . . . . . .    EC ADDR  0144H     R   SEG=?PR?_?VTASKDELAY?TASKS
?C0025. . . . . . . . . . . . . . . . .    EC ADDR  010BH     R   SEG=?PR?_?VTASKDELAY?TASKS
?C0026. . . . . . . . . . . . . . . . .    EC ADDR  0136H     R   SEG=?PR?_?VTASKDELAY?TASKS
?C0028. . . . . . . . . . . . . . . . .    EC ADDR  0153H     R   SEG=?PR?_?VTASKDELAY?TASKS
?C0029. . . . . . . . . . . . . . . . .    EC ADDR  003FH     R   SEG=?PR?_?VTASKSUSPEND?TASKS
?C0030. . . . . . . . . . . . . . . . .    EC ADDR  004FH     R   SEG=?PR?_?VTASKSUSPEND?TASKS
?C0031. . . . . . . . . . . . . . . . .    EC ADDR  00B3H     R   SEG=?PR?_?VTASKSUSPEND?TASKS
?C0033. . . . . . . . . . . . . . . . .    EC ADDR  00FEH     R   SEG=?PR?_?VTASKSUSPEND?TASKS
?C0035. . . . . . . . . . . . . . . . .    EC ADDR  008FH     R   SEG=?PR?_?VTASKRESUME?TASKS
?C0036. . . . . . . . . . . . . . . . .    EC ADDR  0091H     R   SEG=?PR?_?VTASKRESUME?TASKS
?C0037. . . . . . . . . . . . . . . . .    EC ADDR  00FFH     R   SEG=?PR?_?VTASKRESUME?TASKS
?C0039. . . . . . . . . . . . . . . . .    EC ADDR  014FH     R   SEG=?PR?_?VTASKRESUME?TASKS
?C0041. . . . . . . . . . . . . . . . .    EC ADDR  0051H     R   SEG=?PR?_?VTASKSTARTSCHEDULER?TASKS
?C0043. . . . . . . . . . . . . . . . .    EC ADDR  0051H     R   SEG=?PR?_?VTASKSTARTSCHEDULER?TASKS
?C0046. . . . . . . . . . . . . . . . .    EC ADDR  016BH     R   SEG=?PR?_?CTASKRESUMEALL?TASKS
?C0048. . . . . . . . . . . . . . . . .    EC ADDR  0039H     R   SEG=?PR?_?CTASKRESUMEALL?TASKS
?C0049. . . . . . . . . . . . . . . . .    EC ADDR  013BH     R   SEG=?PR?_?CTASKRESUMEALL?TASKS
?C0050. . . . . . . . . . . . . . . . .    EC ADDR  0066H     R   SEG=?PR?_?CTASKRESUMEALL?TASKS
?C0051. . . . . . . . . . . . . . . . .    EC ADDR  006CH     R   SEG=?PR?_?CTASKRESUMEALL?TASKS
?C0052. . . . . . . . . . . . . . . . .    EC ADDR  00FFH     R   SEG=?PR?_?CTASKRESUMEALL?TASKS
?C0054. . . . . . . . . . . . . . . . .    EC ADDR  0145H     R   SEG=?PR?_?CTASKRESUMEALL?TASKS
?C0055. . . . . . . . . . . . . . . . .    EC ADDR  015CH     R   SEG=?PR?_?CTASKRESUMEALL?TASKS
?C0056. . . . . . . . . . . . . . . . .    EC ADDR  0179H     R   SEG=?PR?_?CTASKRESUMEALL?TASKS
?C0057. . . . . . . . . . . . . . . . .    EC ADDR  0042H     R   SEG=?PR?_?XTASKGETTICKCOUNT?TASKS
?C0058. . . . . . . . . . . . . . . . .    EC ADDR  0036H     R   SEG=?PR?_?USTASKGETNUMBEROFTASKS?TASKS
?C0059. . . . . . . . . . . . . . . . .    EC ADDR  01FCH     R   SEG=?PR?_?VTASKINCREMENTTICK?TASKS
?C0061. . . . . . . . . . . . . . . . .    EC ADDR  009EH     R   SEG=?PR?_?VTASKINCREMENTTICK?TASKS
?C0063. . . . . . . . . . . . . . . . .    EC ADDR  00D5H     R   SEG=?PR?_?VTASKINCREMENTTICK?TASKS
?C0064. . . . . . . . . . . . . . . . .    EC ADDR  00DBH     R   SEG=?PR?_?VTASKINCREMENTTICK?TASKS
?C0065. . . . . . . . . . . . . . . . .    EC ADDR  0126H     R   SEG=?PR?_?VTASKINCREMENTTICK?TASKS
?C0066. . . . . . . . . . . . . . . . .    EC ADDR  0179H     R   SEG=?PR?_?VTASKINCREMENTTICK?TASKS
?C0067. . . . . . . . . . . . . . . . .    EC ADDR  01C0H     R   SEG=?PR?_?VTASKINCREMENTTICK?TASKS
?C0069. . . . . . . . . . . . . . . . .    EC ADDR  0203H     R   SEG=?PR?_?VTASKINCREMENTTICK?TASKS
?C0070. . . . . . . . . . . . . . . . .    EC ADDR  000AH     R   SEG=?PR?_?VTASKSWITCHCONTEXT?TASKS
?C0071. . . . . . . . . . . . . . . . .    EC ADDR  013AH     R   SEG=?PR?_?VTASKSWITCHCONTEXT?TASKS
?C0072. . . . . . . . . . . . . . . . .    EC ADDR  000AH     R   SEG=?PR?_?VTASKSWITCHCONTEXT?TASKS
?C0073. . . . . . . . . . . . . . . . .    EC ADDR  002FH     R   SEG=?PR?_?VTASKSWITCHCONTEXT?TASKS
?C0074. . . . . . . . . . . . . . . . .    EC ADDR  0108H     R   SEG=?PR?_?VTASKSWITCHCONTEXT?TASKS
?C0075. . . . . . . . . . . . . . . . .    EC ADDR  0121H     R   SEG=?PR?_?VTASKPLACEONEVENTLIST?TASKS
?C0077. . . . . . . . . . . . . . . . .    EC ADDR  014CH     R   SEG=?PR?_?VTASKPLACEONEVENTLIST?TASKS
?C0078. . . . . . . . . . . . . . . . .    EC ADDR  0053H     R   SEG=?PR?_?CTASKREMOVEFROMEVENTLIST?TASKS
?C0079. . . . . . . . . . . . . . . . .    EC ADDR  0059H     R   SEG=?PR?_?CTASKREMOVEFROMEVENTLIST?TASKS
?C0080. . . . . . . . . . . . . . . . .    EC ADDR  0126H     R   SEG=?PR?_?CTASKREMOVEFROMEVENTLIST?TASKS
?C0081. . . . . . . . . . . . . . . . .    EC ADDR  00EFH     R   SEG=?PR?_?CTASKREMOVEFROMEVENTLIST?TASKS
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    95

?C0082. . . . . . . . . . . . . . . . .    EC ADDR  0156H     R   SEG=?PR?_?CTASKREMOVEFROMEVENTLIST?TASKS
?C0083. . . . . . . . . . . . . . . . .    EC ADDR  018EH     R   SEG=?PR?_?CTASKREMOVEFROMEVENTLIST?TASKS
?C0084. . . . . . . . . . . . . . . . .    EC ADDR  018EH     R   SEG=?PR?_?CTASKREMOVEFROMEVENTLIST?TASKS
?C0086. . . . . . . . . . . . . . . . .    EC ADDR  0031H     R   SEG=?PR?_?PRVIDLETASK?TASKS
?C0090. . . . . . . . . . . . . . . . .    EC ADDR  00AAH     R   SEG=?PR?_?PRVINITIALISETCBVARIABLES?TASKS
?C0091. . . . . . . . . . . . . . . . .    EC ADDR  0117H     R   SEG=?PR?_?PRVINITIALISETCBVARIABLES?TASKS
?C0092. . . . . . . . . . . . . . . . .    EC ADDR  0130H     R   SEG=?PR?_?PRVINITIALISETCBVARIABLES?TASKS
?C0094. . . . . . . . . . . . . . . . .    EC ADDR  0013H     R   SEG=?PR?_?PRVINITIALISETASKLISTS?TASKS
?C0095. . . . . . . . . . . . . . . . .    EC ADDR  0044H     R   SEG=?PR?_?PRVINITIALISETASKLISTS?TASKS
?C0097. . . . . . . . . . . . . . . . .    EC ADDR  0112H     R   SEG=?PR?_?PRVINITIALISETASKLISTS?TASKS
?C0099. . . . . . . . . . . . . . . . .    EC ADDR  00E8H     R   SEG=?PR?_?PRVALLOCATETCBANDSTACK?TASKS
?C0100. . . . . . . . . . . . . . . . .    EC ADDR  00BBH     R   SEG=?PR?_?PRVALLOCATETCBANDSTACK?TASKS
?C0102. . . . . . . . . . . . . . . . .    EC ADDR  00F9H     R   SEG=?PR?_?PRVALLOCATETCBANDSTACK?TASKS
?C0106. . . . . . . . . . . . . . . . .    EC ADDR  01A9H     R   SEG=?PR?_?STASKCREATE?TASKS
?C0107. . . . . . . . . . . . . . . . .    EC ADDR  01B4H     R   SEG=?PR?_?STASKCREATE?TASKS
?C0113. . . . . . . . . . . . . . . . .    EC ADDR  0042H     R   SEG=?PR?_?CTASKRESUMEALL?TASKS
?C0116. . . . . . . . . . . . . . . . .    EC ADDR  00C3H     R   SEG=?PR?_?VTASKSWITCHCONTEXT?TASKS
?C0117. . . . . . . . . . . . . . . . .    EC ADDR  003EH     R   SEG=?PR?_?PRVIDLETASK?TASKS
?C0120. . . . . . . . . . . . . . . . .    EC ADDR  023FH     R   SEG=?PR?_?VTASKDELAYUNTIL?TASKS
?C0121. . . . . . . . . . . . . . . . .    EC ADDR  0150H     R   SEG=?PR?_?VTASKDELAYUNTIL?TASKS
?C0122. . . . . . . . . . . . . . . . .    EC ADDR  012AH     R   SEG=?PR?_?VTASKDELAY?TASKS
?C0123. . . . . . . . . . . . . . . . .    EC ADDR  0140H     R   SEG=?PR?_?VTASKPLACEONEVENTLIST?TASKS
?C0124. . . . . . . . . . . . . . . . .    EC ADDR  0152H     R   SEG=?PR?_?CTASKREMOVEFROMEVENTLIST?TASKS
?C?ADDXBP . . . . . . . . . . . . . . .    C  ADDR  -------       EXT
?C?CLDPTR . . . . . . . . . . . . . . .    C  ADDR  -------       EXT
?C?CSTPTR . . . . . . . . . . . . . . .    C  ADDR  -------       EXT
?C?ILDPTR . . . . . . . . . . . . . . .    C  ADDR  -------       EXT
?C?ISTPTR . . . . . . . . . . . . . . .    C  ADDR  -------       EXT
?C?LLDPTR . . . . . . . . . . . . . . .    C  ADDR  -------       EXT
?C?LSTPTR . . . . . . . . . . . . . . .    C  ADDR  -------       EXT
?C?LSTXDATA . . . . . . . . . . . . . .    C  ADDR  -------       EXT
?C?MEMSET . . . . . . . . . . . . . . .    C  ADDR  -------       EXT
?C?PLDPTR . . . . . . . . . . . . . . .    C  ADDR  -------       EXT
?C?PSTPTR . . . . . . . . . . . . . . .    C  ADDR  -------       EXT
?C?STRCPY . . . . . . . . . . . . . . .    C  ADDR  -------       EXT
?C?ULCMP. . . . . . . . . . . . . . . .    C  ADDR  -------       EXT
?C?XBPOFF . . . . . . . . . . . . . . .    C  ADDR  -------       EXT
?C?XDATAMTYPE . . . . . . . . . . . . .    N  NUMB  -------       EXT
?C?XDATASEG . . . . . . . . . . . . . .    N  NUMB  -------       EXT
?C_INITSEG. . . . . . . . . . . . . . .    C  SEG   00002FH       REL=UNIT, ALN=BYTE
?C_XBP. . . . . . . . . . . . . . . . .    D  ADDR  -------       EXT
?CO?TASKS . . . . . . . . . . . . . . .    C  SEG   000005H       REL=UNIT, ALN=BYTE
?PR?_?CTASKREMOVEFROMEVENTLIST?TASKS. .    EC SEG   000196H       REL=INSEG, ALN=BYTE
?PR?_?CTASKRESUMEALL?TASKS. . . . . . .    EC SEG   000181H       REL=INSEG, ALN=BYTE
?PR?_?PRVALLOCATETCBANDSTACK?TASKS. . .    EC SEG   000101H       REL=INSEG, ALN=BYTE
?PR?_?PRVCHECKTASKSWAITINGTERMINATION?TASKSEC SEG   000001H       REL=INSEG, ALN=BYTE
?PR?_?PRVGETCURRENTTCB_XBP?TASKS. . . .    EC SEG   00001DH       REL=INSEG, ALN=BYTE
?PR?_?PRVIDLETASK?TASKS . . . . . . . .    EC SEG   000046H       REL=INSEG, ALN=BYTE
?PR?_?PRVINITIALISETASKLISTS?TASKS. . .    EC SEG   00011AH       REL=INSEG, ALN=BYTE
?PR?_?PRVINITIALISETCBVARIABLES?TASKS .    EC SEG   000229H       REL=INSEG, ALN=BYTE
?PR?_?PRVSETCURRENTTCB_XBP?TASKS. . . .    EC SEG   000017H       REL=INSEG, ALN=BYTE
?PR?_?STASKCREATE?TASKS . . . . . . . .    EC SEG   0003C6H       REL=INSEG, ALN=BYTE
?PR?_?USTASKGETNUMBEROFTASKS?TASKS. . .    EC SEG   00003EH       REL=INSEG, ALN=BYTE
?PR?_?VTASKDELAY?TASKS. . . . . . . . .    EC SEG   00015BH       REL=INSEG, ALN=BYTE
?PR?_?VTASKDELAYUNTIL?TASKS . . . . . .    EC SEG   000270H       REL=INSEG, ALN=BYTE
?PR?_?VTASKENDSCHEDULER?TASKS . . . . .    EC SEG   00000CH       REL=INSEG, ALN=BYTE
?PR?_?VTASKINCREMENTTICK?TASKS. . . . .    EC SEG   00020BH       REL=INSEG, ALN=BYTE
?PR?_?VTASKPLACEONEVENTLIST?TASKS . . .    EC SEG   000154H       REL=INSEG, ALN=BYTE
?PR?_?VTASKRESUME?TASKS . . . . . . . .    EC SEG   000157H       REL=INSEG, ALN=BYTE
?PR?_?VTASKSTARTSCHEDULER?TASKS . . . .    EC SEG   000059H       REL=INSEG, ALN=BYTE
?PR?_?VTASKSUSPEND?TASKS. . . . . . . .    EC SEG   000106H       REL=INSEG, ALN=BYTE
?PR?_?VTASKSUSPENDALL?TASKS . . . . . .    EC SEG   000012H       REL=INSEG, ALN=BYTE
?PR?_?VTASKSWITCHCONTEXT?TASKS. . . . .    EC SEG   00013BH       REL=INSEG, ALN=BYTE
?PR?_?XTASKGETTICKCOUNT?TASKS . . . . .    EC SEG   00004AH       REL=INSEG, ALN=BYTE
?SC_0 . . . . . . . . . . . . . . . . .    C  ADDR  0000H     R   SEG=?CO?TASKS
?XD?TASKS . . . . . . . . . . . . . . .    X  SEG   000167H       REL=UNIT, ALN=BYTE
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    96

_?CTASKREMOVEFROMEVENTLIST. . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?CTASKREMOVEFROMEVENTLIST?TASKS
_?CTASKRESUMEALL. . . . . . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?CTASKRESUMEALL?TASKS
_?PRVALLOCATETCBANDSTACK. . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?PRVALLOCATETCBANDSTACK?TASKS
_?PRVCHECKTASKSWAITINGTERMINATION . . .    EC ADDR  0000H     R   SEG=?PR?_?PRVCHECKTASKSWAITINGTERMINATION?TASKS
_?PRVGETCURRENTTCB_XBP. . . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?PRVGETCURRENTTCB_XBP?TASKS
_?PRVIDLETASK . . . . . . . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?PRVIDLETASK?TASKS
_?PRVINITIALISETASKLISTS. . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?PRVINITIALISETASKLISTS?TASKS
_?PRVINITIALISETCBVARIABLES . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?PRVINITIALISETCBVARIABLES?TASKS
_?PRVSETCURRENTTCB_XBP. . . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?PRVSETCURRENTTCB_XBP?TASKS
_?PVPORTMALLOC. . . . . . . . . . . . .    C  ADDR  -------       EXT
_?PXPORTINITIALISESTACK . . . . . . . .    C  ADDR  -------       EXT
_?SPORTSTARTSCHEDULER . . . . . . . . .    C  ADDR  -------       EXT
_?STASKCREATE . . . . . . . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?STASKCREATE?TASKS
_?USTASKGETNUMBEROFTASKS. . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?USTASKGETNUMBEROFTASKS?TASKS
_?VLISTINITIALISE . . . . . . . . . . .    C  ADDR  -------       EXT
_?VLISTINITIALISEITEM . . . . . . . . .    C  ADDR  -------       EXT
_?VLISTINSERT . . . . . . . . . . . . .    C  ADDR  -------       EXT
_?VLISTINSERTEND. . . . . . . . . . . .    C  ADDR  -------       EXT
_?VLISTREMOVE . . . . . . . . . . . . .    C  ADDR  -------       EXT
_?VPORTENDSCHEDULER . . . . . . . . . .    C  ADDR  -------       EXT
_?VPORTFREE . . . . . . . . . . . . . .    C  ADDR  -------       EXT
_?VPORTYIELD. . . . . . . . . . . . . .    C  ADDR  -------       EXT
_?VTASKDELAY. . . . . . . . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?VTASKDELAY?TASKS
_?VTASKDELAYUNTIL . . . . . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?VTASKDELAYUNTIL?TASKS
_?VTASKENDSCHEDULER . . . . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?VTASKENDSCHEDULER?TASKS
_?VTASKINCREMENTTICK. . . . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?VTASKINCREMENTTICK?TASKS
_?VTASKPLACEONEVENTLIST . . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?VTASKPLACEONEVENTLIST?TASKS
_?VTASKRESUME . . . . . . . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?VTASKRESUME?TASKS
_?VTASKSTARTSCHEDULER . . . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?VTASKSTARTSCHEDULER?TASKS
_?VTASKSUSPEND. . . . . . . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?VTASKSUSPEND?TASKS
_?VTASKSUSPENDALL . . . . . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?VTASKSUSPENDALL?TASKS
_?VTASKSWITCHCONTEXT. . . . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?VTASKSWITCHCONTEXT?TASKS
_?XTASKGETTICKCOUNT . . . . . . . . . .    EC ADDR  0000H     R   SEG=?PR?_?XTASKGETTICKCOUNT?TASKS
_STRLEN . . . . . . . . . . . . . . . .    C  ADDR  -------       EXT
_STRNCPY. . . . . . . . . . . . . . . .    C  ADDR  -------       EXT
AC. . . . . . . . . . . . . . . . . . .    B  ADDR  00D0H.6   A   
ACC . . . . . . . . . . . . . . . . . .    D  ADDR  00E0H     A   
ACON. . . . . . . . . . . . . . . . . .    D  ADDR  009DH     A   
AR1 . . . . . . . . . . . . . . . . . .    D  ADDR  0001H     A   
AR2 . . . . . . . . . . . . . . . . . .    D  ADDR  0002H     A   
AR3 . . . . . . . . . . . . . . . . . .    D  ADDR  0003H     A   
ARCON . . . . . . . . . . . . . . . . .    D  ADDR  00FFH     A   
B . . . . . . . . . . . . . . . . . . .    D  ADDR  00F0H     A   
C_XBP . . . . . . . . . . . . . . . . .    D  ADDR  -------       EXT
CANCIR. . . . . . . . . . . . . . . . .    D  ADDR  00DEH     A   
CANDR . . . . . . . . . . . . . . . . .    D  ADDR  00DFH     A   
CCAPH0. . . . . . . . . . . . . . . . .    D  ADDR  00B9H     A   
CCAPH1. . . . . . . . . . . . . . . . .    D  ADDR  00BAH     A   
CCAPH2. . . . . . . . . . . . . . . . .    D  ADDR  00BBH     A   
CCAPH3. . . . . . . . . . . . . . . . .    D  ADDR  00BCH     A   
CCAPH4. . . . . . . . . . . . . . . . .    D  ADDR  00BDH     A   
CCAPL0. . . . . . . . . . . . . . . . .    D  ADDR  00B1H     A   
CCAPL1. . . . . . . . . . . . . . . . .    D  ADDR  00B2H     A   
CCAPL2. . . . . . . . . . . . . . . . .    D  ADDR  00B3H     A   
CCAPL3. . . . . . . . . . . . . . . . .    D  ADDR  00B4H     A   
CCAPL4. . . . . . . . . . . . . . . . .    D  ADDR  00B5H     A   
CCAPM0. . . . . . . . . . . . . . . . .    D  ADDR  00D1H     A   
CCAPM1. . . . . . . . . . . . . . . . .    D  ADDR  00D2H     A   
CCAPM2. . . . . . . . . . . . . . . . .    D  ADDR  00D3H     A   
CCAPM3. . . . . . . . . . . . . . . . .    D  ADDR  00D4H     A   
CCAPM4. . . . . . . . . . . . . . . . .    D  ADDR  00D5H     A   
CCON. . . . . . . . . . . . . . . . . .    D  ADDR  00C3H     A   
CH. . . . . . . . . . . . . . . . . . .    D  ADDR  00C5H     A   
CKCON . . . . . . . . . . . . . . . . .    D  ADDR  008EH     A   
CL. . . . . . . . . . . . . . . . . . .    D  ADDR  00C4H     A   
CMOD. . . . . . . . . . . . . . . . . .    D  ADDR  00C2H     A   
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    97

CPRL2 . . . . . . . . . . . . . . . . .    B  ADDR  00C8H.0   A   
CSCHEDULERRUNNING . . . . . . . . . . .    X  ADDR  0165H     R   SEG=?XD?TASKS
CSREPR. . . . . . . . . . . . . . . . .    D  ADDR  008FH     A   
CT2 . . . . . . . . . . . . . . . . . .    B  ADDR  00C8H.1   A   
CY. . . . . . . . . . . . . . . . . . .    B  ADDR  00D0H.7   A   
DBAR. . . . . . . . . . . . . . . . . .    D  ADDR  009AH     A   
DCIR. . . . . . . . . . . . . . . . . .    D  ADDR  009BH     A   
DDR . . . . . . . . . . . . . . . . . .    D  ADDR  009CH     A   
DMAHR . . . . . . . . . . . . . . . . .    D  ADDR  00ADH     A   
DMALR . . . . . . . . . . . . . . . . .    D  ADDR  00ABH     A   
DMAMR . . . . . . . . . . . . . . . . .    D  ADDR  00ACH     A   
DPH . . . . . . . . . . . . . . . . . .    D  ADDR  0083H     A   
DPH0. . . . . . . . . . . . . . . . . .    D  ADDR  0083H     A   
DPH1. . . . . . . . . . . . . . . . . .    D  ADDR  0085H     A   
DPL . . . . . . . . . . . . . . . . . .    D  ADDR  0082H     A   
DPL0. . . . . . . . . . . . . . . . . .    D  ADDR  0082H     A   
DPL1. . . . . . . . . . . . . . . . . .    D  ADDR  0084H     A   
DPS . . . . . . . . . . . . . . . . . .    D  ADDR  0086H     A   
DPX . . . . . . . . . . . . . . . . . .    D  ADDR  0093H     A   
DPX0. . . . . . . . . . . . . . . . . .    D  ADDR  0093H     A   
DPX1. . . . . . . . . . . . . . . . . .    D  ADDR  0095H     A   
EA. . . . . . . . . . . . . . . . . . .    B  ADDR  00A8H.7   A   
EIE . . . . . . . . . . . . . . . . . .    D  ADDR  00E8H     A   
EIF . . . . . . . . . . . . . . . . . .    D  ADDR  0091H     A   
EINT2 . . . . . . . . . . . . . . . . .    B  ADDR  00E8H.0   A   
EINT3 . . . . . . . . . . . . . . . . .    B  ADDR  00E8H.1   A   
EINT4 . . . . . . . . . . . . . . . . .    B  ADDR  00E8H.2   A   
EINT5 . . . . . . . . . . . . . . . . .    B  ADDR  00E8H.3   A   
EINT6 . . . . . . . . . . . . . . . . .    B  ADDR  00E8H.4   A   
EIP . . . . . . . . . . . . . . . . . .    D  ADDR  00F8H     A   
EPCR. . . . . . . . . . . . . . . . . .    D  ADDR  00BEH     A   
EPDR. . . . . . . . . . . . . . . . . .    D  ADDR  00BFH     A   
ES0 . . . . . . . . . . . . . . . . . .    B  ADDR  00A8H.4   A   
ES1 . . . . . . . . . . . . . . . . . .    B  ADDR  00A8H.6   A   
ET0 . . . . . . . . . . . . . . . . . .    B  ADDR  00A8H.1   A   
ET1 . . . . . . . . . . . . . . . . . .    B  ADDR  00A8H.3   A   
ET2 . . . . . . . . . . . . . . . . . .    B  ADDR  00A8H.5   A   
EWDI. . . . . . . . . . . . . . . . . .    B  ADDR  00E8H.5   A   
EWT . . . . . . . . . . . . . . . . . .    B  ADDR  00D8H.1   A   
EX0 . . . . . . . . . . . . . . . . . .    B  ADDR  00A8H.0   A   
EX1 . . . . . . . . . . . . . . . . . .    B  ADDR  00A8H.2   A   
EXEN2 . . . . . . . . . . . . . . . . .    B  ADDR  00C8H.3   A   
EXF2. . . . . . . . . . . . . . . . . .    B  ADDR  00C8H.6   A   
F0. . . . . . . . . . . . . . . . . . .    B  ADDR  00D0H.5   A   
F1. . . . . . . . . . . . . . . . . . .    B  ADDR  00D0H.1   A   
I2CCIR. . . . . . . . . . . . . . . . .    D  ADDR  0096H     A   
I2CDR . . . . . . . . . . . . . . . . .    D  ADDR  0097H     A   
IE. . . . . . . . . . . . . . . . . . .    D  ADDR  00A8H     A   
IE0 . . . . . . . . . . . . . . . . . .    B  ADDR  0088H.1   A   
IE1 . . . . . . . . . . . . . . . . . .    B  ADDR  0088H.3   A   
INT0. . . . . . . . . . . . . . . . . .    B  ADDR  00B0H.2   A   
INT1. . . . . . . . . . . . . . . . . .    B  ADDR  00B0H.3   A   
IP. . . . . . . . . . . . . . . . . . .    D  ADDR  00B8H     A   
IT0 . . . . . . . . . . . . . . . . . .    B  ADDR  0088H.0   A   
IT1 . . . . . . . . . . . . . . . . . .    B  ADDR  0088H.2   A   
LCR . . . . . . . . . . . . . . . . . .    D  ADDR  00A2H     A   
LDAHR . . . . . . . . . . . . . . . . .    D  ADDR  00A5H     A   
LDALR . . . . . . . . . . . . . . . . .    D  ADDR  00A4H     A   
LDCSR . . . . . . . . . . . . . . . . .    D  ADDR  00A6H     A   
LDHR. . . . . . . . . . . . . . . . . .    D  ADDR  00AAH     A   
LDLR. . . . . . . . . . . . . . . . . .    D  ADDR  00A9H     A   
LMSR. . . . . . . . . . . . . . . . . .    D  ADDR  00A1H     A   
LSAIER. . . . . . . . . . . . . . . . .    D  ADDR  00A1H     A   
LSCR. . . . . . . . . . . . . . . . . .    D  ADDR  00A2H     A   
LSR . . . . . . . . . . . . . . . . . .    D  ADDR  00A3H     A   
LSSR. . . . . . . . . . . . . . . . . .    D  ADDR  00A3H     A   
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    98

MCIR. . . . . . . . . . . . . . . . . .    D  ADDR  00B6H     A   
MD0 . . . . . . . . . . . . . . . . . .    D  ADDR  00F9H     A   
MD1 . . . . . . . . . . . . . . . . . .    D  ADDR  00FAH     A   
MD2 . . . . . . . . . . . . . . . . . .    D  ADDR  00FBH     A   
MD3 . . . . . . . . . . . . . . . . . .    D  ADDR  00FCH     A   
MD4 . . . . . . . . . . . . . . . . . .    D  ADDR  00FDH     A   
MD5 . . . . . . . . . . . . . . . . . .    D  ADDR  00FEH     A   
MDR . . . . . . . . . . . . . . . . . .    D  ADDR  00B7H     A   
MXAX. . . . . . . . . . . . . . . . . .    D  ADDR  00EAH     A   
OV. . . . . . . . . . . . . . . . . . .    B  ADDR  00D0H.2   A   
OWCIR . . . . . . . . . . . . . . . . .    D  ADDR  00D6H     A   
OWDR. . . . . . . . . . . . . . . . . .    D  ADDR  00D7H     A   
P . . . . . . . . . . . . . . . . . . .    B  ADDR  00D0H.0   A   
P0. . . . . . . . . . . . . . . . . . .    D  ADDR  0080H     A   
P0_0. . . . . . . . . . . . . . . . . .    B  ADDR  0080H.0   A   
P0_1. . . . . . . . . . . . . . . . . .    B  ADDR  0080H.1   A   
P0_2. . . . . . . . . . . . . . . . . .    B  ADDR  0080H.2   A   
P0_3. . . . . . . . . . . . . . . . . .    B  ADDR  0080H.3   A   
P0_4. . . . . . . . . . . . . . . . . .    B  ADDR  0080H.4   A   
P0_5. . . . . . . . . . . . . . . . . .    B  ADDR  0080H.5   A   
P0_6. . . . . . . . . . . . . . . . . .    B  ADDR  0080H.6   A   
P0_7. . . . . . . . . . . . . . . . . .    B  ADDR  0080H.7   A   
P1. . . . . . . . . . . . . . . . . . .    D  ADDR  0090H     A   
P1_0. . . . . . . . . . . . . . . . . .    B  ADDR  0090H.0   A   
P1_1. . . . . . . . . . . . . . . . . .    B  ADDR  0090H.1   A   
P1_2. . . . . . . . . . . . . . . . . .    B  ADDR  0090H.2   A   
P1_3. . . . . . . . . . . . . . . . . .    B  ADDR  0090H.3   A   
P1_4. . . . . . . . . . . . . . . . . .    B  ADDR  0090H.4   A   
P1_5. . . . . . . . . . . . . . . . . .    B  ADDR  0090H.5   A   
P1_6. . . . . . . . . . . . . . . . . .    B  ADDR  0090H.6   A   
P1_7. . . . . . . . . . . . . . . . . .    B  ADDR  0090H.7   A   
P2. . . . . . . . . . . . . . . . . . .    D  ADDR  00A0H     A   
P2_0. . . . . . . . . . . . . . . . . .    B  ADDR  00A0H.0   A   
P2_1. . . . . . . . . . . . . . . . . .    B  ADDR  00A0H.1   A   
P2_2. . . . . . . . . . . . . . . . . .    B  ADDR  00A0H.2   A   
P2_3. . . . . . . . . . . . . . . . . .    B  ADDR  00A0H.3   A   
P2_4. . . . . . . . . . . . . . . . . .    B  ADDR  00A0H.4   A   
P2_5. . . . . . . . . . . . . . . . . .    B  ADDR  00A0H.5   A   
P2_6. . . . . . . . . . . . . . . . . .    B  ADDR  00A0H.6   A   
P2_7. . . . . . . . . . . . . . . . . .    B  ADDR  00A0H.7   A   
P3. . . . . . . . . . . . . . . . . . .    D  ADDR  00B0H     A   
P3_0. . . . . . . . . . . . . . . . . .    B  ADDR  00B0H.0   A   
P3_1. . . . . . . . . . . . . . . . . .    B  ADDR  00B0H.1   A   
P3_2. . . . . . . . . . . . . . . . . .    B  ADDR  00B0H.2   A   
P3_3. . . . . . . . . . . . . . . . . .    B  ADDR  00B0H.3   A   
P3_4. . . . . . . . . . . . . . . . . .    B  ADDR  00B0H.4   A   
P3_5. . . . . . . . . . . . . . . . . .    B  ADDR  00B0H.5   A   
P3_6. . . . . . . . . . . . . . . . . .    B  ADDR  00B0H.6   A   
P3_7. . . . . . . . . . . . . . . . . .    B  ADDR  00B0H.7   A   
PCON. . . . . . . . . . . . . . . . . .    D  ADDR  0087H     A   
PINT2 . . . . . . . . . . . . . . . . .    B  ADDR  00F8H.0   A   
PINT3 . . . . . . . . . . . . . . . . .    B  ADDR  00F8H.1   A   
PINT4 . . . . . . . . . . . . . . . . .    B  ADDR  00F8H.2   A   
PINT5 . . . . . . . . . . . . . . . . .    B  ADDR  00F8H.3   A   
PINT6 . . . . . . . . . . . . . . . . .    B  ADDR  00F8H.4   A   
PISSR1. . . . . . . . . . . . . . . . .    D  ADDR  009EH     A   
PISSR2. . . . . . . . . . . . . . . . .    D  ADDR  009FH     A   
PS0 . . . . . . . . . . . . . . . . . .    B  ADDR  00B8H.4   A   
PS1 . . . . . . . . . . . . . . . . . .    B  ADDR  00B8H.6   A   
PSW . . . . . . . . . . . . . . . . . .    D  ADDR  00D0H     A   
PT0 . . . . . . . . . . . . . . . . . .    B  ADDR  00B8H.1   A   
PT1 . . . . . . . . . . . . . . . . . .    B  ADDR  00B8H.3   A   
PT2 . . . . . . . . . . . . . . . . . .    B  ADDR  00B8H.5   A   
PWDI. . . . . . . . . . . . . . . . . .    B  ADDR  00F8H.5   A   
PX0 . . . . . . . . . . . . . . . . . .    B  ADDR  00B8H.0   A   
PX1 . . . . . . . . . . . . . . . . . .    B  ADDR  00B8H.2   A   
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE    99

PXCURRENTTCB. . . . . . . . . . . . . .    X  ADDR  012AH     R   SEG=?XD?TASKS
PXDELAYEDTASKLIST . . . . . . . . . . .    X  ADDR  014AH     R   SEG=?XD?TASKS
PXOVERFLOWDELAYEDTASKLIST . . . . . . .    X  ADDR  012EH     R   SEG=?XD?TASKS
PXREADYTASKSLISTS . . . . . . . . . . .    X  ADDR  0001H     R   SEG=?XD?TASKS
RB08. . . . . . . . . . . . . . . . . .    B  ADDR  0098H.2   A   
RB18. . . . . . . . . . . . . . . . . .    B  ADDR  00C0H.2   A   
RCLK. . . . . . . . . . . . . . . . . .    B  ADDR  00C8H.5   A   
RD. . . . . . . . . . . . . . . . . . .    B  ADDR  00B0H.7   A   
REN0. . . . . . . . . . . . . . . . . .    B  ADDR  0098H.4   A   
REN1. . . . . . . . . . . . . . . . . .    B  ADDR  00C0H.4   A   
RI0 . . . . . . . . . . . . . . . . . .    B  ADDR  0098H.0   A   
RI1 . . . . . . . . . . . . . . . . . .    B  ADDR  00C0H.0   A   
RLDH. . . . . . . . . . . . . . . . . .    D  ADDR  00CBH     A   
RLDL. . . . . . . . . . . . . . . . . .    D  ADDR  00CAH     A   
RS0 . . . . . . . . . . . . . . . . . .    B  ADDR  00D0H.3   A   
RS1 . . . . . . . . . . . . . . . . . .    B  ADDR  00D0H.4   A   
RWT . . . . . . . . . . . . . . . . . .    B  ADDR  00D8H.0   A   
RXD . . . . . . . . . . . . . . . . . .    B  ADDR  00B0H.0   A   
SBUF0 . . . . . . . . . . . . . . . . .    D  ADDR  0099H     A   
SBUF1 . . . . . . . . . . . . . . . . .    D  ADDR  00C1H     A   
SCON0 . . . . . . . . . . . . . . . . .    D  ADDR  0098H     A   
SCON1 . . . . . . . . . . . . . . . . .    D  ADDR  00C0H     A   
SDSTSR. . . . . . . . . . . . . . . . .    D  ADDR  0094H     A   
SM00. . . . . . . . . . . . . . . . . .    B  ADDR  0098H.7   A   
SM01. . . . . . . . . . . . . . . . . .    B  ADDR  0098H.6   A   
SM02. . . . . . . . . . . . . . . . . .    B  ADDR  0098H.5   A   
SM10. . . . . . . . . . . . . . . . . .    B  ADDR  00C0H.7   A   
SM11. . . . . . . . . . . . . . . . . .    B  ADDR  00C0H.6   A   
SM12. . . . . . . . . . . . . . . . . .    B  ADDR  00C0H.5   A   
SP. . . . . . . . . . . . . . . . . . .    D  ADDR  0081H     A   
SPICIR. . . . . . . . . . . . . . . . .    D  ADDR  00CEH     A   
SPIDR . . . . . . . . . . . . . . . . .    D  ADDR  00CFH     A   
STACK_START . . . . . . . . . . . . . .    I  ADDR  -------       EXT
STATUS. . . . . . . . . . . . . . . . .    D  ADDR  00E9H     A   
SUSINGPREEMPTION. . . . . . . . . . . .    X  ADDR  0128H     R   SEG=?XD?TASKS
T0. . . . . . . . . . . . . . . . . . .    B  ADDR  00B0H.4   A   
T1. . . . . . . . . . . . . . . . . . .    B  ADDR  00B0H.5   A   
T2CON . . . . . . . . . . . . . . . . .    D  ADDR  00C8H     A   
T2IF. . . . . . . . . . . . . . . . . .    D  ADDR  00C9H     A   
TA. . . . . . . . . . . . . . . . . . .    D  ADDR  00EBH     A   
TASKS . . . . . . . . . . . . . . . . .    -- ----  -------       
TB08. . . . . . . . . . . . . . . . . .    B  ADDR  0098H.3   A   
TB18. . . . . . . . . . . . . . . . . .    B  ADDR  00C0H.3   A   
TCIR. . . . . . . . . . . . . . . . . .    D  ADDR  00AEH     A   
TCLK. . . . . . . . . . . . . . . . . .    B  ADDR  00C8H.4   A   
TCON. . . . . . . . . . . . . . . . . .    D  ADDR  0088H     A   
TDR . . . . . . . . . . . . . . . . . .    D  ADDR  00AFH     A   
TF0 . . . . . . . . . . . . . . . . . .    B  ADDR  0088H.5   A   
TF1 . . . . . . . . . . . . . . . . . .    B  ADDR  0088H.7   A   
TF2 . . . . . . . . . . . . . . . . . .    B  ADDR  00C8H.7   A   
TH0 . . . . . . . . . . . . . . . . . .    D  ADDR  008CH     A   
TH1 . . . . . . . . . . . . . . . . . .    D  ADDR  008DH     A   
TH2 . . . . . . . . . . . . . . . . . .    D  ADDR  00CDH     A   
TI0 . . . . . . . . . . . . . . . . . .    B  ADDR  0098H.1   A   
TI1 . . . . . . . . . . . . . . . . . .    B  ADDR  00C0H.1   A   
TL0 . . . . . . . . . . . . . . . . . .    D  ADDR  008AH     A   
TL1 . . . . . . . . . . . . . . . . . .    D  ADDR  008BH     A   
TL2 . . . . . . . . . . . . . . . . . .    D  ADDR  00CCH     A   
TMOD. . . . . . . . . . . . . . . . . .    D  ADDR  0089H     A   
TR0 . . . . . . . . . . . . . . . . . .    B  ADDR  0088H.4   A   
TR1 . . . . . . . . . . . . . . . . . .    B  ADDR  0088H.6   A   
TR2 . . . . . . . . . . . . . . . . . .    B  ADDR  00C8H.2   A   
TXD . . . . . . . . . . . . . . . . . .    B  ADDR  00B0H.1   A   
UCMISSEDTICKS . . . . . . . . . . . . .    X  ADDR  0131H     R   SEG=?XD?TASKS
UCSCHEDULERSUSPENDED. . . . . . . . . .    X  ADDR  012DH     R   SEG=?XD?TASKS
UCTASKNUMBER. . . . . . . . . . . . . .    X  ADDR  0000H     R   SEG=?XD?TASKS
AX51 MACRO ASSEMBLER  TASKS                                                                 03/13/13 09:32:27 PAGE   100

UCTOPREADYPRIORITY. . . . . . . . . . .    X  ADDR  0166H     R   SEG=?XD?TASKS
UCTOPUSEDPRIORITY . . . . . . . . . . .    X  ADDR  00F3H     R   SEG=?XD?TASKS
UR2_DLH . . . . . . . . . . . . . . . .    D  ADDR  00E2H     A   
UR2_DLL . . . . . . . . . . . . . . . .    D  ADDR  00E1H     A   
UR2_FCR . . . . . . . . . . . . . . . .    D  ADDR  00E3H     A   
UR2_IER . . . . . . . . . . . . . . . .    D  ADDR  00E2H     A   
UR2_IIR . . . . . . . . . . . . . . . .    D  ADDR  00E3H     A   
UR2_LCR . . . . . . . . . . . . . . . .    D  ADDR  00E4H     A   
UR2_LSR . . . . . . . . . . . . . . . .    D  ADDR  00E6H     A   
UR2_MCR . . . . . . . . . . . . . . . .    D  ADDR  00E5H     A   
UR2_MSR . . . . . . . . . . . . . . . .    D  ADDR  00E7H     A   
UR2_RBR . . . . . . . . . . . . . . . .    D  ADDR  00E1H     A   
UR2_THR . . . . . . . . . . . . . . . .    D  ADDR  00E1H     A   
USCURRENTNUMBEROFTASKS. . . . . . . . .    X  ADDR  00F1H     R   SEG=?XD?TASKS
WDCON . . . . . . . . . . . . . . . . .    D  ADDR  00D8H     A   
WDIF. . . . . . . . . . . . . . . . . .    B  ADDR  00D8H.3   A   
WR. . . . . . . . . . . . . . . . . . .    B  ADDR  00B0H.6   A   
WTRF. . . . . . . . . . . . . . . . . .    B  ADDR  00D8H.2   A   
WTST. . . . . . . . . . . . . . . . . .    D  ADDR  0092H     A   
XDELAYEDTASKLIST1 . . . . . . . . . . .    X  ADDR  00F8H     R   SEG=?XD?TASKS
XDELAYEDTASKLIST2 . . . . . . . . . . .    X  ADDR  0110H     R   SEG=?XD?TASKS
XMRHR . . . . . . . . . . . . . . . . .    D  ADDR  00A7H     A   
XMRLR . . . . . . . . . . . . . . . . .    D  ADDR  00A6H     A   
XMWHR . . . . . . . . . . . . . . . . .    D  ADDR  00A5H     A   
XMWLR . . . . . . . . . . . . . . . . .    D  ADDR  00A4H     A   
XPENDINGREADYLIST . . . . . . . . . . .    X  ADDR  0132H     R   SEG=?XD?TASKS
XSUSPENDEDTASKLIST. . . . . . . . . . .    X  ADDR  014DH     R   SEG=?XD?TASKS
XTICKCOUNT. . . . . . . . . . . . . . .    X  ADDR  00F4H     R   SEG=?XD?TASKS


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S).
