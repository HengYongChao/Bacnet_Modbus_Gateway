C51 COMPILER V9.06   LCD                                                                   05/28/2013 10:15:34 PAGE 1   


C51 COMPILER V9.06, COMPILATION OF MODULE LCD
OBJECT MODULE PLACED IN .\LCD.obj
COMPILER INVOKED BY: E:\Keil_4_9.06\C51\BIN\C51.EXE ..\src\LCD\LCD.c LARGE OMF2 ROM(D16M) BROWSE INTVECTOR(0X6020) INCDI
                    -R(..\SRC\cpu\;..\SRC\ethernet\;..\SRC\swdma\;..\SRC\mstimer\;..\SRC\uart\;..\SRC\main\;..\SRC\tcpip\;..\SRC\hsur\;..\SRC
                    -\debug\;..\SRC\dhcp\;..\SRC\dns\;..\SRC\adapter\;..\SRC\pppoe\;..\SRC\management;..\SRC\i2c\;..\SRC\flash\;..\SRC\buffer
                    -\;..\SRC\onewire\;..\SRC\http\;..\SRC\web\;..\SRC\AX110xx_SNTP_v100;..\Src\FreeRTOSSource\portable\Keil\AX11000\;..\Src\
                    -FreeRTOSSource\include\;..\Src\schedule\;..\src\bacnet;..\src\include;..\src\LCD;..\src\version;..\src\modbusTCP;..\src\
                    -gs2e;..\src\adpter1;..\src\scan;..\src\gsm;..\src\dyndns) DEFINE(KEIL_AX11000) VARBANKING DEBUG PRINT(.\LCD.lst) OBJECT(
                    -.\LCD.obj)

line level    source

   1          #include "reg80390.h"
   2          #include "../LCD/lcd.h"
   3          #include  <intrins.h> 
   4          #include "system.h"
   5          #include <string.h>
   6          #include <ctype.h>  
   7          
   8          
   9          unsigned char const code aby_Char_Table[10] = {'0','1','2','3','4','5','6','7','8','9'};
  10          
  11          /*(0) !(1) "(2) #(3) $(4) %(5) &(6) '(7) ((8) )(9) *(10) +(11) ,(12) -(13) .(14) /(15)
  12           0(16) 1(17) 2(18) 3(19) 4(20) 5(21) 6(22) 7(23) 8(24) 9(25) :(26) ;(27) <(28) =(29) >(30) ?(31)
  13           @(32) A(33) B(34) C(35) D(36) E(37) F(38) G(39) H(40) I(41) J(42) K(43) L(44) M(45) N(46) O(47)
  14           P(48) Q(49) R(50) S(51) T(52) U(53) V(54) W(55) X(56) Y(57) Z(58) [(59) \(60) ](61) ^(62) _(63)
  15           `(64) a(65) b(66) c(67) d(68) e(69) f(70) g(71) h(72) i(73) j(74) k(75) l(76) m(77) n(78) o(79)
  16           p(80) q(81) r(82) s(83) t(84) u(85) v(86) w(87) x(88) y(89) z(90) {(91) |(92) }(93) ~(94) |(95)*/
  17          
  18          
  19          
  20          unsigned char const code nAsciiDot[96][2][6] =  {
  21          
  22          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*" ",0*/
  23          
  24          {0x00,0x00,0xF8,0x00,0x00,0x00,0x00,0x00,0x33,0x00,0x00,0x00},/*"!",1*/
  25          
  26          {0x00,0x08,0x06,0x08,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*""",2*/
  27          
  28          {0x40,0x40,0xF8,0x40,0xF8,0x40,0x04,0x3F,0x05,0x3F,0x05,0x04},/*"#",3*/
  29          
  30          {0x70,0x88,0xFC,0x08,0x30,0x00,0x18,0x20,0xFF,0x21,0x1E,0x00},/*"$",4*/
  31          
  32          {0xF0,0x98,0x60,0xE0,0x38,0x00,0x00,0x31,0x0E,0x1F,0x33,0x0C},/*"%",5*/
  33          
  34          {0x00,0xF0,0x88,0x70,0x00,0x00,0x1E,0x21,0x26,0x19,0x27,0x20},/*"&",6*/
  35          
  36          {0x10,0x0E,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"'",7*/
  37          
  38          {0x00,0x00,0x00,0xF0,0x0C,0x02,0x00,0x00,0x00,0x0F,0x30,0x40},/*"(",8*/
  39          
  40          {0x00,0x06,0x18,0xE0,0x00,0x00,0x00,0x60,0x18,0x07,0x00,0x00},/*")",9*/
  41          
  42          {0x40,0x80,0xF0,0x80,0x40,0x00,0x02,0x01,0x0F,0x01,0x02,0x00},/*"*",10*/
  43          
  44          {0x00,0x00,0xF0,0x00,0x00,0x00,0x01,0x01,0x1F,0x01,0x01,0x00},/*"+",11*/
  45          
  46          {0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x70,0x00,0x00,0x00,0x00},/*",",12*/
  47          
  48          {0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x00},/*"-",13*/
  49          
C51 COMPILER V9.06   LCD                                                                   05/28/2013 10:15:34 PAGE 2   

  50          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x30,0x00,0x00,0x00,0x00},/*".",14*/
  51          
  52          {0x00,0x00,0x80,0x70,0x0C,0x00,0x60,0x1C,0x03,0x00,0x00,0x00},/*"/",15*/
  53          
  54          {0xF0,0x08,0x08,0x18,0xE0,0x00,0x1F,0x20,0x20,0x30,0x0F,0x00},/*"0",16*/
  55          
  56          {0x00,0x10,0xF8,0x00,0x00,0x00,0x00,0x20,0x3F,0x20,0x00,0x00},/*"1",17*/
  57          
  58          {0x70,0x08,0x08,0x08,0xF0,0x00,0x30,0x2C,0x22,0x21,0x30,0x00},/*"2",18*/
  59          
  60          {0x30,0x08,0x88,0x88,0x70,0x00,0x18,0x20,0x20,0x31,0x1E,0x00},/*"3",19*/
  61          
  62          {0x00,0x80,0x60,0xF0,0x00,0x00,0x06,0x05,0x24,0x3F,0x24,0x04},/*"4",20*/
  63          
  64          {0xF8,0x08,0x88,0x88,0x08,0x00,0x19,0x21,0x20,0x31,0x1F,0x00},/*"5",21*/
  65          
  66          {0xE0,0x18,0x88,0x98,0x00,0x00,0x0F,0x31,0x20,0x20,0x1F,0x00},/*"6",22*/
  67          
  68          {0x38,0x08,0x08,0xE8,0x18,0x00,0x00,0x00,0x3F,0x00,0x00,0x00},/*"7",23*/
  69          
  70          {0x70,0x88,0x08,0x88,0x70,0x00,0x1E,0x21,0x21,0x21,0x1E,0x00},/*"8",24*/
  71          
  72          {0xF0,0x08,0x08,0x18,0xE0,0x00,0x01,0x32,0x22,0x31,0x0F,0x00},/*"9",25*/
  73          
  74          {0x00,0x00,0xC0,0x00,0x00,0x00,0x00,0x00,0x30,0x00,0x00,0x00},/*":",26*/
  75          
  76          {0x00,0x00,0x80,0x00,0x00,0x00,0x00,0x00,0xE0,0x00,0x00,0x00},/*";",27*/
  77          
  78          {0x00,0x00,0x80,0x60,0x10,0x08,0x00,0x01,0x02,0x0C,0x10,0x20},/*"<",28*/
  79          
  80          {0x40,0x40,0x40,0x40,0x40,0x00,0x04,0x04,0x04,0x04,0x04,0x00},/*"=",29*/
  81          
  82          {0x00,0x08,0x30,0x40,0x80,0x00,0x00,0x20,0x18,0x04,0x02,0x01},/*">",30*/
  83          
  84          {0x70,0x08,0x08,0x88,0x70,0x00,0x00,0x00,0x37,0x01,0x00,0x00},/*"?",31*/
  85          
  86          {0xF0,0x10,0x88,0x78,0xF0,0x00,0x1F,0x20,0x27,0x34,0x0F,0x00},/*"@",32*/
  87          
  88          {0x00,0x80,0x78,0xE0,0x00,0x00,0x20,0x3F,0x02,0x03,0x3E,0x20},/*"A",33*/
  89          
  90          {0x08,0xF8,0x88,0x88,0x70,0x00,0x20,0x3F,0x20,0x20,0x1F,0x00},/*"B",34*/
  91          
  92          {0xF0,0x10,0x08,0x08,0x18,0x00,0x1F,0x20,0x20,0x20,0x10,0x00},/*"C",35*/
  93          
  94          {0x08,0xF8,0x08,0x10,0xE0,0x00,0x20,0x3F,0x20,0x10,0x0F,0x00},/*"D",36*/
  95          
  96          {0x08,0xF8,0x88,0xE8,0x18,0x00,0x20,0x3F,0x20,0x23,0x30,0x00},/*"E",37*/
  97          
  98          {0x08,0xF8,0x88,0xE8,0x18,0x00,0x20,0x3F,0x20,0x03,0x00,0x00},/*"F",38*/
  99          
 100          {0xE0,0x10,0x08,0x08,0x18,0x00,0x0F,0x10,0x20,0x22,0x1E,0x02},/*"G",39*/
 101          
 102          {0x08,0xF8,0x00,0x00,0xF8,0x08,0x20,0x3F,0x01,0x01,0x3F,0x20},/*"H",40*/
 103          
 104          {0x08,0x08,0xF8,0x08,0x08,0x00,0x20,0x20,0x3F,0x20,0x20,0x00},/*"I",41*/
 105          
 106          {0x00,0x08,0x08,0xF8,0x08,0x08,0xC0,0x80,0x80,0x7F,0x00,0x00},/*"J",42*/
 107          
 108          {0x08,0xF8,0x88,0x60,0x18,0x08,0x20,0x3F,0x20,0x07,0x3C,0x20},/*"K",43*/
 109          
 110          {0x08,0xF8,0x08,0x00,0x00,0x00,0x20,0x3F,0x20,0x20,0x20,0x30},/*"L",44*/
 111          
C51 COMPILER V9.06   LCD                                                                   05/28/2013 10:15:34 PAGE 3   

 112          {0xF8,0xF8,0x00,0xF8,0xF8,0x00,0x3F,0x00,0x3F,0x00,0x3F,0x00},/*"M",45*/
 113          
 114          {0x08,0xF8,0xE0,0x08,0xF8,0x08,0x20,0x3F,0x21,0x06,0x3F,0x00},/*"N",46*/
 115          
 116          {0xF0,0x08,0x08,0x18,0xE0,0x00,0x1F,0x20,0x20,0x30,0x0F,0x00},/*"O",47*/
 117          
 118          {0x08,0xF8,0x08,0x08,0xF0,0x00,0x20,0x3F,0x21,0x01,0x00,0x00},/*"P",48*/
 119          
 120          {0xF0,0x08,0x08,0x18,0xE0,0x00,0x0F,0x34,0x2C,0x70,0x7F,0x00},/*"Q",49*/
 121          
 122          {0x08,0xF8,0x88,0x88,0x70,0x00,0x20,0x3F,0x20,0x03,0x3C,0x20},/*"R",50*/
 123          
 124          {0x70,0x88,0x08,0x08,0x18,0x00,0x30,0x20,0x21,0x22,0x1C,0x00},/*"S",51*/
 125          
 126          {0x18,0x08,0xF8,0x08,0x18,0x00,0x00,0x20,0x3F,0x20,0x00,0x00},/*"T",52*/
 127          
 128          {0x08,0xF8,0x00,0x00,0xF8,0x08,0x00,0x1F,0x20,0x20,0x1F,0x00},/*"U",53*/
 129          
 130          {0x08,0xF8,0x00,0x80,0xF8,0x08,0x00,0x03,0x3C,0x0F,0x00,0x00},/*"V",54*/
 131          
 132          {0x78,0x84,0xF8,0xC0,0x78,0x00,0x00,0x3F,0x00,0x3F,0x00,0x00},/*"W",55*/
 133          
 134          {0x08,0x78,0x80,0x78,0x08,0x00,0x20,0x3C,0x03,0x3C,0x20,0x00},/*"X",56*/
 135          
 136          {0x08,0xF8,0x80,0x78,0x08,0x00,0x00,0x20,0x3F,0x20,0x00,0x00},/*"Y",57*/
 137          
 138          {0x18,0x08,0x88,0x78,0x08,0x00,0x20,0x3C,0x23,0x20,0x30,0x00},/*"Z",58*/
 139          
 140          {0x00,0x00,0xFE,0x02,0x02,0x00,0x00,0x00,0x7F,0x40,0x40,0x00},/*"[",59*/
 141          
 142          {0x00,0x38,0xC0,0x00,0x00,0x00,0x00,0x00,0x01,0x1E,0x60,0x00},/*"\",60*/
 143          
 144          {0x00,0x02,0x02,0xFE,0x00,0x00,0x00,0x40,0x40,0x7F,0x00,0x00},/*"]",61*/
 145          
 146          {0x00,0x04,0x02,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"^",62*/
 147          
 148          {0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x80},/*"_",63*/
 149          
 150          {0x00,0x02,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"`",64*/
 151          
 152          {0x00,0x00,0x80,0x80,0x80,0x00,0x00,0x3D,0x26,0x22,0x3F,0x20},/*"a",65*/
 153          
 154          {0x08,0xF8,0x00,0x80,0x00,0x00,0x00,0x1F,0x21,0x20,0x1F,0x00},/*"b",66*/
 155          
 156          {0x00,0x00,0x80,0x80,0x80,0x00,0x00,0x1F,0x21,0x20,0x21,0x00},/*"c",67*/
 157          
 158          {0x00,0x00,0x80,0x88,0xF8,0x00,0x00,0x1F,0x20,0x20,0x3F,0x20},/*"d",68*/
 159          
 160          {0x00,0x00,0x80,0x80,0x00,0x00,0x00,0x1F,0x22,0x22,0x23,0x00},/*"e",69*/
 161          
 162          {0x00,0x80,0xF0,0x88,0x88,0x18,0x00,0x20,0x3F,0x20,0x20,0x00},/*"f",70*/
 163          
 164          {0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x6B,0x94,0x94,0x93,0x60},/*"g",71*/
 165          
 166          {0x08,0xF8,0x00,0x80,0x80,0x00,0x20,0x3F,0x21,0x00,0x3F,0x20},/*"h",72*/
 167          
 168          {0x00,0x80,0x98,0x00,0x00,0x00,0x00,0x20,0x3F,0x20,0x00,0x00},/*"i",73*/
 169          
 170          {0x00,0x00,0x80,0x98,0x00,0x00,0xC0,0x80,0x80,0x7F,0x00,0x00},/*"j",74*/
 171          
 172          {0x08,0xF8,0x00,0x80,0x80,0x80,0x20,0x3F,0x24,0x06,0x39,0x20},/*"k",75*/
 173          
C51 COMPILER V9.06   LCD                                                                   05/28/2013 10:15:34 PAGE 4   

 174          {0x08,0x08,0xF8,0x00,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00},/*"l",76*/
 175          
 176          {0x80,0x80,0x80,0x80,0x00,0x00,0x3F,0x00,0x3F,0x00,0x3F,0x00},/*"m",77*/
 177          
 178          {0x80,0x80,0x00,0x80,0x80,0x00,0x20,0x3F,0x21,0x00,0x3F,0x20},/*"n",78*/
 179          
 180          {0x00,0x00,0x80,0x80,0x00,0x00,0x00,0x1F,0x20,0x20,0x1F,0x00},/*"o",79*/
 181          
 182          {0x80,0x80,0x80,0x80,0x00,0x00,0x80,0xFF,0xA0,0x20,0x1F,0x00},/*"p",80*/
 183          
 184          {0x00,0x00,0x80,0x80,0x80,0x00,0x00,0x1F,0x20,0xA0,0xFF,0x80},/*"q",81*/
 185          
 186          {0x80,0x80,0x00,0x80,0x80,0x00,0x20,0x3F,0x21,0x00,0x01,0x00},/*"r",82*/
 187          
 188          {0x00,0x00,0x80,0x80,0x80,0x00,0x00,0x23,0x24,0x24,0x39,0x00},/*"s",83*/
 189          
 190          {0x00,0x80,0xE0,0x80,0x00,0x00,0x00,0x00,0x1F,0x20,0x20,0x00},/*"t",84*/
 191          
 192          {0x80,0x80,0x00,0x80,0x80,0x00,0x00,0x3F,0x20,0x20,0x3F,0x20},/*"u",85*/
 193          
 194          {0x80,0x80,0x00,0x00,0x80,0x80,0x00,0x07,0x38,0x1C,0x03,0x00},/*"v",86*/
 195          
 196          {0x80,0x40,0x80,0x00,0x80,0x00,0x03,0x3C,0x03,0x3E,0x03,0x00},/*"w",87*/
 197          
 198          {0x80,0x80,0x00,0x80,0x80,0x00,0x20,0x33,0x0E,0x3B,0x20,0x00},/*"x",88*/
 199          
 200          {0x80,0x80,0x00,0x00,0x80,0x80,0x80,0x87,0x78,0x0C,0x03,0x00},/*"y",89*/
 201          
 202          {0x00,0x80,0x80,0x80,0x80,0x00,0x00,0x30,0x2C,0x23,0x30,0x00},/*"z",90*/
 203          
 204          {0x00,0x00,0x80,0x7E,0x02,0x00,0x00,0x00,0x00,0x3F,0x40,0x00},/*"{",91*/
 205          
 206          //{0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x00,0x00,0xFF,0x00,0x00},/*"|",92*/
 207          {0x1C,0x22,0x1C,0xC0,0x40,0x40,0x00,0x00,0x00,0x3F,0x02,0x02},/*"未命名文件",DEG AND F*/
 208          
 209          //{0x00,0x02,0x7E,0x80,0x00,0x00,0x00,0x40,0x3F,0x00,0x00,0x00},/*"}",93*/
 210          {0xF8,0xF0,0xE0,0xC0,0x80,0x00,0x0F,0x07,0x03,0x01,0x00,0x00},/*"未命名文件",0 */
 211          
 212          //{0x06,0x01,0x02,0x04,0x04,0x03,0x00,0x00,0x00,0x00,0x00,0x00},/*"~",94*/ 
 213          {0x1C,0x22,0x1C,0x80,0x40,0x40,0x00,0x00,0x00,0x1F,0x20,0x20},/*"未命名文件",DEG AND C */
 214          
 215          {0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x00,0x00,0xFF,0x00,0x00},/*"|",95*/
 216          
 217          
 218          
 219          };
 220          
 221          
 222          
 223          
 224          sbit CS = P1^4;
 225          sbit RESET = P1^6;
 226          sbit A0 = P1^5;
 227          sbit CLK = P1^3;
 228          sbit DATA = P1^2;
 229          
 230          sbit backlight = P1^7;
 231          
 232          
 233          
 234          
 235          
C51 COMPILER V9.06   LCD                                                                   05/28/2013 10:15:34 PAGE 5   

 236          void Lcd_Write_Byte(char num) //from high to low
 237          {
 238   1              char data i;
 239   1              CS = 0;//Lcd_Set(CS_LOW);
 240   1              _nop_();
 241   1              A0 = 1;//Lcd_Set(A0_HIGH);
 242   1              _nop_();        
 243   1              for(i = 0;i < 8;i++)
 244   1              {
 245   2                      if(num & 0x80)  DATA = 1;//     Lcd_Set(DATA_HIGH);
 246   2              else            DATA = 0;       //Lcd_Set(DATA_LOW);
 247   2                      
 248   2                      _nop_();        
 249   2              CLK = 0;//Lcd_Set(CLK_LOW);
 250   2                      _nop_();
 251   2                      CLK = 1;//Lcd_Set(CLK_HIGH);
 252   2                      _nop_();
 253   2      
 254   2              num <<= 1;      
 255   2              }
 256   1              _nop_();
 257   1              
 258   1              CS = 1;//Lcd_Set(CS_HIGH);//
 259   1              DATA = 1;
 260   1              _nop_();
 261   1      }
 262          
 263          
 264          void Lcd_Write_Command(char command) //from high to low
 265          {
 266   1              char data i;
 267   1              CS = 0;//Lcd_Set(CS_LOW);//
 268   1              _nop_();
 269   1              A0 = 0;//Lcd_Set(A0_LOW);//
 270   1              _nop_();        
 271   1              for(i = 0;i < 8;i++)
 272   1              {
 273   2                      if(command & 0x80)      DATA = 1;//Lcd_Set(DATA_HIGH);
 274   2                      else                    DATA = 0;//Lcd_Set(DATA_LOW);//
 275   2                              
 276   2                      _nop_();
 277   2              CLK = 0;//Lcd_Set(CLK_LOW);//
 278   2                      _nop_();
 279   2      
 280   2                      CLK = 1;//Lcd_Set(CLK_HIGH);//
 281   2                      _nop_();
 282   2      
 283   2              command <<= 1;
 284   2              }
 285   1              _nop_();
 286   1              CS = 1;//Lcd_Set(CS_HIGH);//    
 287   1              DATA = 1;
 288   1              _nop_();
 289   1      }
 290          
 291          
 292          void Lcd_Write_Char(char row,char line,char num,char mode) // row: 0 - 4 , line: 0 - 21
 293          {
 294   1              char data loop; 
 295   1              char data index = num - ' ';
 296   1                      
 297   1              Lcd_Set_X_Addr((line + 1) * 6);
C51 COMPILER V9.06   LCD                                                                   05/28/2013 10:15:34 PAGE 6   

 298   1              Lcd_Set_Y_Addr(row * 2);
 299   1              for(loop = 0;loop < 6;loop++) 
 300   1                      if(mode == 1)   Lcd_Write_Byte(nAsciiDot[index][0][loop]);
 301   1                      else  Lcd_Write_Byte(~nAsciiDot[index][0][loop]);
 302   1              Lcd_Set_X_Addr((line + 1) * 6);
 303   1              Lcd_Set_Y_Addr(row * 2+1);
 304   1              for(loop = 0;loop < 6;loop++) 
 305   1                      if(mode == 1)   Lcd_Write_Byte(nAsciiDot[index][1][loop]);
 306   1                      else Lcd_Write_Byte(~nAsciiDot[index][1][loop]);
 307   1      
 308   1      }
 309          
 310          
 311          void Lcd_Set_Fuction(char mode)
 312          {
 313   1              char data fuction;
 314   1              fuction = 0x38 + mode;//0x20 + mode;
 315   1              Lcd_Write_Command(fuction);
 316   1      }
 317          
 318          void Lcd_Set_Y_Addr(char page)// 0 1 0 0        page 0 - 9
 319          {
 320   1              char data addr;
 321   1              Lcd_Set_Fuction(0);
 322   1              addr = 0x40 + page;
 323   1              Lcd_Write_Command(addr);
 324   1      }
 325          
 326          void Lcd_Set_X_Addr(char line)// 1 1 1 0/1        page 0 - 129
 327          {
 328   1              char data addr;
 329   1              char data line_low;
 330   1              char data line_high;
 331   1              Lcd_Set_Fuction(0);
 332   1              line_low = line & 0x0f;
 333   1              line = line >> 4;
 334   1              line_high = line; 
 335   1              addr = 0xe0 + line_low; //low
 336   1              Lcd_Write_Command(addr);
 337   1              addr = 0xf0 + line_high; //high
 338   1              Lcd_Write_Command(addr);
 339   1      }
 340          
 341          
 342          void lcdreset(void)        /* reset lcd before grogramming */
 343          {
 344   1              RESET = 0;
 345   1      }
 346          
 347          void Display_reboot(void)
 348          {
 349   1      
 350   1              Lcd_Show_String(2,5,"Reboot...",1,9);
 351   1      }
 352          
 353          
 354          
 355          
 356          void Lcd_Initial(void)
 357          {
 358   1              RESET = 0;
 359   1              delay_us(100);
C51 COMPILER V9.06   LCD                                                                   05/28/2013 10:15:34 PAGE 7   

 360   1              RESET = 1;
 361   1              delay_us(10);
 362   1      
 363   1              
 364   1              Lcd_Set_Fuction(1); // 0x21     
 365   1              delay_us(10);
 366   1              Lcd_Write_Command(CMD_SET_BIAS);delay_us(10);   
 367   1              Lcd_Write_Command(CMD_SET_V0);  delay_us(10);
 368   1              Lcd_Write_Command(CMD_DISPLAY_CONFIG);delay_us(10);
 369   1              
 370   1              Lcd_Set_Fuction(0); // 0x20
 371   1              delay_us(10);
 372   1              Lcd_Write_Command(CMD_SET_V0Range_HIGH);    
 373   1              Lcd_Write_Command(CMD_DISPLAT_NORMAL);
 374   1      //      Lcd_Write_Command(CMD_DISPLAY_INVERSE);
 375   1              Lcd_Set_X_Addr(0);  //0xf0 0xe0
 376   1              Lcd_Set_Y_Addr(0);  //0x40
 377   1              
 378   1      
 379   1              delay_us(10);
 380   1              Lcd_All_Off();
 381   1      
 382   1              backlight = 0;
 383   1              
 384   1      }
 385          
 386          
 387          
 388          void Lcd_Show_String(char pos_x,char pos_y,char* str,unsigned char mode,unsigned char length) // pos_x: 0 
             -- 4 , pos_y: 0 - 15
 389          {
 390   1              char data loop = 0;
 391   1              char data by_x,by_y;
 392   1              unsigned char temp = 0;
 393   1              char tempstr[21];
 394   1      
 395   1              for(loop = 0;loop < 21;loop++)   tempstr[21] = ' ';
 396   1      
 397   1              by_x = pos_x;
 398   1              by_y = pos_y;
 399   1                      
 400   1              for(loop = 0;loop < strlen(str);loop++)
 401   1              {
 402   2                      if(mode & 0x80) tempstr[loop] = (char)toupper(str[loop]);
 403   2                      else tempstr[loop] = str[loop];
 404   2              }
 405   1              tempstr[loop] = '\0';
 406   1      
 407   1              if(length & 0x80) 
 408   1              {
 409   2                      for(loop = 0;loop < length - 0x80;loop++)
 410   2                      {
 411   3                              if(temp == 0)
 412   3                              {
 413   4                                      if(*(tempstr + loop) != '\0')   Lcd_Write_Char(by_x,by_y,*(tempstr + loop),mode & 0x7f);
 414   4                                      else  {temp = loop; Lcd_Write_Char(by_x,by_y,' ',mode & 0x7f);}
 415   4                              }
 416   3                              else
 417   3                              {
 418   4                                      Lcd_Write_Char(by_x,by_y,' ',mode & 0x7f);
 419   4                              }
 420   3                              by_y++;         
C51 COMPILER V9.06   LCD                                                                   05/28/2013 10:15:34 PAGE 8   

 421   3                      }
 422   2              
 423   2              }
 424   1              else
 425   1              {
 426   2                      loop = 0;
 427   2                      while(*(tempstr + loop) != '\0')
 428   2                      {               
 429   3                              /*Lcd_Write_Char(by_x,by_y,*(str + loop),mode); 
 430   3                              by_y++;
 431   3                              if(by_y >= 21)
 432   3                              {
 433   3                                      by_y = 0;
 434   3                                      by_x ++;
 435   3                                      if(by_x >= 5)   by_x = 0;
 436   3                              }*/
 437   3                              if(by_y < 21) 
 438   3                              {
 439   4                                      Lcd_Write_Char(by_x,by_y,*(tempstr + loop),mode & 0x7f);        
 440   4                                      by_y++;
 441   4                              }
 442   3                              loop ++;                
 443   3                      }
 444   2              }       
 445   1      }
 446          
 447          
 448          
 449          void Lcd_Show_Data(char pos_x,char pos_y,unsigned int number,char dot,char mode) //,char div, bool signed)
 450          {
 451   1              char data loop = 0;
 452   1              char data num[5];
 453   1              char data length;
 454   1              char data by_x,by_y;
 455   1      
 456   1              by_x = pos_x;
 457   1              by_y = pos_y;   
 458   1      
 459   1              //number = number / div;
 460   1      
 461   1              if(number >= 1000)      length = 4;
 462   1              else if(number >= 100)  length = 3;
 463   1              else if(number >= 10)   length = 2;
 464   1              else length = 1;
 465   1      
 466   1              if((length > 1) && (dot != 0)) 
 467   1              {
 468   2                      length ++;      
 469   2                      num[dot] = '.';
 470   2                      num[4] = number / 1000;         number = number % 1000;
 471   2                      switch(dot)
 472   2                      {
 473   3                              case 3:
 474   3                                              num[2] = number / 100;          number = number % 100;
 475   3                                              num[1] = number / 10;           number = number % 10;
 476   3                                              num[0] = number;
 477   3                                              break;
 478   3                              case 2:
 479   3                                              num[3] = number / 100;          number = number % 100;
 480   3                                              num[1] = number / 10;           number = number % 10;
 481   3                                              num[0] = number;
 482   3                                              break;
C51 COMPILER V9.06   LCD                                                                   05/28/2013 10:15:34 PAGE 9   

 483   3                              case 1:
 484   3                                              num[3] = number / 100;          number = number % 100;
 485   3                                              num[2] = number / 10;           number = number % 10;
 486   3                                              num[0] = number;
 487   3                                              break;
 488   3                      }
 489   2      
 490   2              }
 491   1      
 492   1              else
 493   1              {
 494   2                      num[3] = number / 1000;         number = number % 1000;
 495   2                      num[2] = number / 100;          number = number % 100;
 496   2                      num[1] = number / 10;           number = number % 10;
 497   2                      num[0] = number;
 498   2      
 499   2              }       
 500   1      
 501   1      
 502   1              for(loop = length - 1;loop >= 0;loop--)
 503   1              {
 504   2                      if(num[loop] == '.')    Lcd_Write_Char(by_x,by_y,'.',mode);
 505   2                      else
 506   2                      Lcd_Write_Char(by_x,by_y,aby_Char_Table[num[loop]],mode);
 507   2                      by_y ++;
 508   2                      if(by_y >= 21)
 509   2                      {
 510   3                              by_y = 0;
 511   3                              by_x ++;
 512   3                              if(by_x >= 5)   by_x = 0;
 513   3                      }
 514   2              }
 515   1              for(loop = length;loop < length + 4;loop++)
 516   1              {
 517   2                      Lcd_Write_Char(by_x,by_y,' ',mode);
 518   2                      by_y ++;
 519   2              }
 520   1      }
 521          
 522          
 523          void Lcd_All_Off(void)
 524          {
 525   1              unsigned int data i;
 526   1              
 527   1              for(i = 0;i < 130*80;i++)       
 528   1              {
 529   2                      Lcd_Write_Byte(0x00);
 530   2              }
 531   1      }
 532          
 533          
 534          
 535          
 536          void Lcd_show_for_32bit(char pos_x,char pos_y,unsigned long number,char mode) //,char div, bool signed)
 537          {
 538   1              char data loop = 0;
 539   1              char data num[11];
 540   1              char data length;
 541   1              char data by_x,by_y;
 542   1      
 543   1              by_x = pos_x;
 544   1              by_y = pos_y;   
C51 COMPILER V9.06   LCD                                                                   05/28/2013 10:15:34 PAGE 10  

 545   1      
 546   1              //number = number / div;
 547   1      
 548   1              if         (number >= 1000000000)       length = 10;
 549   1              else if(number >= 100000000)    length = 9;
 550   1              else if(number >= 10000000)             length = 8;
 551   1              else if(number >= 1000000)              length = 7;
 552   1              else if(number >= 100000)               length = 6;
 553   1              else if(number >= 10000)                length = 5;
 554   1              else if(number >= 1000)                 length = 4;
 555   1              else if(number >= 100)                  length = 3;
 556   1              else if(number >= 10)                   length = 2;
 557   1              else                                                    length = 1;
 558   1      
 559   1      //      num[10] = number/ 10000000000;          number = number % 10000000000;
 560   1              num[9] = number / 1000000000;           number = number % 1000000000;
 561   1              num[8] = number / 100000000;            number = number % 100000000;
 562   1              num[7] = number / 10000000;             number = number % 10000000;
 563   1              num[6] = number / 1000000;                      number = number % 1000000;
 564   1              num[5] = number / 100000;                       number = number % 100000;                                       
 565   1              num[4] = number / 10000;                        number = number % 10000;
 566   1              num[3] = number / 1000;                         number = number % 1000;
 567   1              num[2] = number / 100;                          number = number % 100;
 568   1              num[1] = number / 10;                           number = number % 10;
 569   1              num[0] = number;
 570   1      
 571   1      
 572   1      
 573   1              for(loop = length - 1;loop >= 0;loop--)
 574   1              {
 575   2                      if(num[loop] == '.')    Lcd_Write_Char(by_x,by_y,'.',mode);
 576   2                      else
 577   2                      Lcd_Write_Char(by_x,by_y,aby_Char_Table[num[loop]],mode);
 578   2                      by_y ++;
 579   2                      if(by_y >= 21)
 580   2                      {
 581   3                              by_y = 0;
 582   3                              by_x ++;
 583   3                              if(by_x >= 5)   by_x = 0;
 584   3                      }
 585   2              }
 586   1              for(loop = length;loop < length + 4;loop++)
 587   1              {
 588   2                      Lcd_Write_Char(by_x,by_y,' ',mode);
 589   2                      by_y ++;
 590   2              }
 591   1      }
 592          
 593          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   2651    ----
   CONSTANT SIZE    =   1172    ----
   XDATA SIZE       =   ----      46
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      38
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
C51 COMPILER V9.06   LCD                                                                   05/28/2013 10:15:34 PAGE 11  

   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
